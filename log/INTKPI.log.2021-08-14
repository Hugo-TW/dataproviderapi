2021-08-09 13:29:53,728 -[line:96] - INFO: INTKPI __init__
2021-08-09 13:29:53,729 -[line:96] - INFO: INTKPI getData Start
2021-08-09 13:35:43,536 -[line:96] - INFO: INTKPI __init__
2021-08-09 13:35:43,536 -[line:96] - INFO: INTKPI getData Start
2021-08-09 13:35:43,537 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-09 13:35:43,571 -[line:99] - ERROR: File:[D:\Project\source\dataproviderapi\GetINTKPI.py] , Line:41 , in getData : [AttributeError] 'dict' object has no attribute 'KPITYPE'
2021-08-09 13:35:49,887 -[line:96] - INFO: INTKPI __init__
2021-08-09 13:35:49,888 -[line:96] - INFO: INTKPI getData Start
2021-08-09 13:35:49,888 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-09 13:35:49,892 -[line:99] - ERROR: File:[D:\Project\source\dataproviderapi\GetINTKPI.py] , Line:41 , in getData : [AttributeError] 'dict' object has no attribute 'KPITYPE'
2021-08-09 13:36:24,944 -[line:96] - INFO: INTKPI __init__
2021-08-09 13:36:24,945 -[line:96] - INFO: INTKPI getData Start
2021-08-09 13:36:24,945 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-09 13:36:24,947 -[line:99] - ERROR: File:[D:\Project\source\dataproviderapi\GetINTKPI.py] , Line:41 , in getData : [AttributeError] 'dict' object has no attribute 'KPITYPE'
2021-08-09 13:39:49,760 -[line:96] - INFO: INTKPI __init__
2021-08-09 13:39:49,760 -[line:96] - INFO: INTKPI getData Start
2021-08-09 13:39:49,760 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-09 13:39:49,761 -[line:99] - ERROR: File:[D:\Project\source\dataproviderapi\GetINTKPI.py] , Line:41 , in getData : [AttributeError] 'dict' object has no attribute 'KPITYPE'
2021-08-09 13:40:31,217 -[line:96] - INFO: INTKPI __init__
2021-08-09 13:40:31,217 -[line:96] - INFO: INTKPI getData Start
2021-08-09 13:40:31,218 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-09 13:41:45,395 -[line:96] - INFO: INTKPI __init__
2021-08-09 13:41:45,396 -[line:96] - INFO: INTKPI getData Start
2021-08-09 13:41:45,396 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-09 13:42:34,956 -[line:96] - INFO: INTKPI __init__
2021-08-09 13:42:34,957 -[line:96] - INFO: INTKPI getData Start
2021-08-09 13:42:34,958 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-09 13:45:41,894 -[line:96] - INFO: INTKPI __init__
2021-08-09 13:45:41,894 -[line:96] - INFO: INTKPI getData Start
2021-08-09 13:45:41,894 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-09 13:47:02,970 -[line:96] - INFO: INTKPI __init__
2021-08-09 13:47:02,972 -[line:96] - INFO: INTKPI getData Start
2021-08-09 13:47:02,972 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-09 13:47:26,467 -[line:96] - INFO: INTKPI __init__
2021-08-09 13:47:26,468 -[line:96] - INFO: INTKPI getData Start
2021-08-09 13:47:26,468 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-09 13:47:48,675 -[line:96] - INFO: INTKPI __init__
2021-08-09 13:47:48,676 -[line:96] - INFO: INTKPI getData Start
2021-08-09 13:47:48,676 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-09 13:48:01,862 -[line:96] - INFO: INTKPI __init__
2021-08-09 13:48:01,864 -[line:96] - INFO: INTKPI getData Start
2021-08-09 13:48:01,864 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-09 13:48:48,162 -[line:96] - INFO: INTKPI __init__
2021-08-09 13:48:48,163 -[line:96] - INFO: INTKPI getData Start
2021-08-09 13:48:48,163 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-09 13:51:25,039 -[line:96] - INFO: INTKPI __init__
2021-08-09 13:51:25,039 -[line:96] - INFO: INTKPI getData Start
2021-08-09 13:51:25,039 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-09 14:03:27,949 -[line:96] - INFO: INTKPI __init__
2021-08-09 14:03:27,949 -[line:96] - INFO: INTKPI getData Start
2021-08-09 14:03:27,950 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-09 14:03:27,951 -[line:99] - ERROR: File:[D:\Project\source\dataproviderapi\GetINTKPI.py] , Line:57 , in getData : [NameError] name 'getKeyExpirTime' is not defined
2021-08-09 14:04:16,437 -[line:96] - INFO: INTKPI __init__
2021-08-09 14:04:16,438 -[line:96] - INFO: INTKPI getData Start
2021-08-09 14:04:16,438 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-09 14:04:16,440 -[line:99] - ERROR: File:[D:\Project\source\dataproviderapi\GetINTKPI.py] , Line:57 , in getData : [NameError] name 'getKeyExpirTime' is not defined
2021-08-09 14:04:25,006 -[line:96] - INFO: INTKPI __init__
2021-08-09 14:04:25,007 -[line:96] - INFO: INTKPI getData Start
2021-08-09 14:04:25,007 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-09 14:04:25,008 -[line:99] - ERROR: File:[D:\Project\source\dataproviderapi\GetINTKPI.py] , Line:57 , in getData : [NameError] name 'getKeyExpirTime' is not defined
2021-08-09 14:29:11,105 -[line:96] - INFO: INTKPI __init__
2021-08-09 14:29:11,132 -[line:96] - INFO: INTKPI getData Start
2021-08-09 14:29:11,132 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-09 14:29:11,134 -[line:99] - ERROR: File:[D:\Project\source\dataproviderapi\BaseType.py] , Line:349 , in getKeyExpirTime : [AttributeError] 'INTKPI' object has no attribute '_BaseType__master1'
2021-08-09 14:29:11,135 -[line:99] - ERROR: File:[D:\Project\source\dataproviderapi\GetINTKPI.py] , Line:57 , in getData : [TypeError] unsupported type for timedelta seconds component: NoneType
2021-08-09 14:33:09,867 -[line:96] - INFO: INTKPI __init__
2021-08-09 14:33:09,867 -[line:96] - INFO: INTKPI getData Start
2021-08-09 14:33:09,867 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-09 14:33:09,869 -[line:99] - ERROR: File:[D:\Project\source\dataproviderapi\GetINTKPI.py] , Line:50 , in getData : [KeyError] CONDITION
2021-08-09 14:33:39,903 -[line:96] - INFO: INTKPI __init__
2021-08-09 14:33:39,903 -[line:96] - INFO: INTKPI getData Start
2021-08-09 14:33:39,903 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-09 14:33:39,905 -[line:99] - ERROR: File:[D:\Project\source\dataproviderapi\GetINTKPI.py] , Line:50 , in getData : [KeyError] CONDITION
2021-08-09 14:34:04,958 -[line:96] - INFO: INTKPI __init__
2021-08-09 14:34:04,958 -[line:96] - INFO: INTKPI getData Start
2021-08-09 14:34:04,959 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-09 14:34:04,960 -[line:99] - ERROR: File:[D:\Project\source\dataproviderapi\BaseType.py] , Line:349 , in getKeyExpirTime : [AttributeError] 'INTKPI' object has no attribute '_BaseType__master1'
2021-08-09 14:34:04,961 -[line:99] - ERROR: File:[D:\Project\source\dataproviderapi\BaseType.py] , Line:349 , in getKeyExpirTime : [AttributeError] 'INTKPI' object has no attribute '_BaseType__master1'
2021-08-09 14:34:04,962 -[line:99] - ERROR: File:[D:\Project\source\dataproviderapi\GetINTKPI.py] , Line:57 , in getData : [TypeError] unsupported type for timedelta seconds component: NoneType
2021-08-09 14:41:39,707 -[line:96] - INFO: INTKPI __init__
2021-08-09 14:41:39,708 -[line:96] - INFO: INTKPI getData Start
2021-08-09 14:41:39,708 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-09 14:41:39,709 -[line:99] - ERROR: File:[D:\Project\source\dataproviderapi\BaseType.py] , Line:349 , in getKeyExpirTime : [AttributeError] 'INTKPI' object has no attribute '_BaseType__master1'
2021-08-09 14:41:39,710 -[line:99] - ERROR: File:[D:\Project\source\dataproviderapi\BaseType.py] , Line:349 , in getKeyExpirTime : [AttributeError] 'INTKPI' object has no attribute '_BaseType__master1'
2021-08-09 14:41:39,711 -[line:99] - ERROR: File:[D:\Project\source\dataproviderapi\GetINTKPI.py] , Line:57 , in getData : [TypeError] unsupported type for timedelta seconds component: NoneType
2021-08-09 14:47:05,410 -[line:96] - INFO: INTKPI __init__
2021-08-09 14:47:05,410 -[line:96] - INFO: INTKPI getData Start
2021-08-09 14:47:05,411 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-09 14:47:05,412 -[line:99] - ERROR: File:[D:\Project\source\dataproviderapi\BaseType.py] , Line:349 , in getKeyExpirTime : [AttributeError] 'INTKPI' object has no attribute '_BaseType__master1'
2021-08-09 14:47:05,413 -[line:99] - ERROR: File:[D:\Project\source\dataproviderapi\GetINTKPI.py] , Line:57 , in getData : [TypeError] unsupported type for timedelta seconds component: NoneType
2021-08-09 14:48:51,255 -[line:96] - INFO: INTKPI __init__
2021-08-09 14:48:51,256 -[line:96] - INFO: INTKPI getData Start
2021-08-09 14:48:51,256 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-09 14:49:31,030 -[line:96] - INFO: INTKPI __init__
2021-08-09 14:49:31,031 -[line:96] - INFO: INTKPI getData Start
2021-08-09 14:49:31,031 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-09 14:49:31,032 -[line:99] - ERROR: File:[D:\Project\source\dataproviderapi\BaseType.py] , Line:349 , in getKeyExpirTime : [AttributeError] 'INTKPI' object has no attribute '_BaseType__master1'
2021-08-09 14:50:23,100 -[line:96] - INFO: INTKPI __init__
2021-08-09 14:50:23,101 -[line:96] - INFO: INTKPI getData Start
2021-08-09 14:50:23,101 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-09 14:50:23,103 -[line:99] - ERROR: File:[D:\Project\source\dataproviderapi\BaseType.py] , Line:253 , in searchRedisKeys : [AttributeError] 'INTKPI' object has no attribute '_BaseType__master1'
2021-08-09 14:50:23,104 -[line:99] - ERROR: File:[D:\Project\source\dataproviderapi\BaseType.py] , Line:349 , in getKeyExpirTime : [AttributeError] 'INTKPI' object has no attribute '_BaseType__master1'
2021-08-09 14:50:56,121 -[line:96] - INFO: INTKPI __init__
2021-08-09 14:50:56,122 -[line:96] - INFO: INTKPI getData Start
2021-08-09 14:50:56,122 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-09 14:50:56,123 -[line:99] - ERROR: File:[D:\Project\source\dataproviderapi\BaseType.py] , Line:253 , in searchRedisKeys : [AttributeError] 'INTKPI' object has no attribute '_BaseType__master1'
2021-08-09 14:50:56,124 -[line:99] - ERROR: File:[D:\Project\source\dataproviderapi\BaseType.py] , Line:349 , in getKeyExpirTime : [AttributeError] 'INTKPI' object has no attribute '_BaseType__master1'
2021-08-09 14:52:56,763 -[line:96] - INFO: INTKPI __init__
2021-08-09 14:52:56,764 -[line:96] - INFO: INTKPI getData Start
2021-08-09 14:52:56,765 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-09 14:52:56,767 -[line:99] - ERROR: File:[D:\Project\source\dataproviderapi\BaseType.py] , Line:253 , in searchRedisKeys : [AttributeError] 'INTKPI' object has no attribute '_BaseType__master1'
2021-08-09 14:52:56,768 -[line:99] - ERROR: File:[D:\Project\source\dataproviderapi\BaseType.py] , Line:349 , in getKeyExpirTime : [AttributeError] 'INTKPI' object has no attribute '_BaseType__master1'
2021-08-09 14:53:30,464 -[line:96] - INFO: INTKPI __init__
2021-08-09 14:53:30,465 -[line:96] - INFO: INTKPI getData Start
2021-08-09 14:53:30,466 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-09 14:53:30,468 -[line:99] - ERROR: File:[D:\Project\source\dataproviderapi\BaseType.py] , Line:253 , in searchRedisKeys : [AttributeError] 'INTKPI' object has no attribute '_BaseType__master1'
2021-08-09 14:53:30,468 -[line:99] - ERROR: File:[D:\Project\source\dataproviderapi\BaseType.py] , Line:349 , in getKeyExpirTime : [AttributeError] 'INTKPI' object has no attribute '_BaseType__master1'
2021-08-09 14:55:35,548 -[line:96] - INFO: INTKPI __init__
2021-08-09 14:55:35,548 -[line:96] - INFO: INTKPI getData Start
2021-08-09 14:55:35,549 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-09 14:55:35,550 -[line:99] - ERROR: File:[D:\Project\source\dataproviderapi\BaseType.py] , Line:253 , in searchRedisKeys : [AttributeError] 'INTKPI' object has no attribute '_BaseType__master1'
2021-08-09 14:55:35,552 -[line:99] - ERROR: File:[D:\Project\source\dataproviderapi\GetINTKPI.py] , Line:55 , in getData : [TypeError] string indices must be integers
2021-08-09 15:02:25,234 -[line:96] - INFO: INTKPI __init__
2021-08-09 15:02:25,235 -[line:96] - INFO: INTKPI getData Start
2021-08-09 15:02:25,235 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-09 15:02:25,236 -[line:99] - ERROR: File:[D:\Project\source\dataproviderapi\BaseType.py] , Line:253 , in searchRedisKeys : [AttributeError] 'INTKPI' object has no attribute '_BaseType__master1'
2021-08-09 15:02:25,236 -[line:99] - ERROR: File:[D:\Project\source\dataproviderapi\GetINTKPI.py] , Line:55 , in getData : [TypeError] string indices must be integers
2021-08-09 15:04:02,351 -[line:96] - INFO: INTKPI __init__
2021-08-09 15:04:02,351 -[line:96] - INFO: INTKPI getData Start
2021-08-09 15:04:02,352 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-09 15:04:02,353 -[line:99] - ERROR: File:[D:\Project\source\dataproviderapi\BaseType.py] , Line:253 , in searchRedisKeys : [AttributeError] 'INTKPI' object has no attribute '_BaseType__master1'
2021-08-09 15:04:02,354 -[line:99] - ERROR: File:[D:\Project\source\dataproviderapi\GetINTKPI.py] , Line:55 , in getData : [TypeError] string indices must be integers
2021-08-09 15:04:31,813 -[line:96] - INFO: INTKPI __init__
2021-08-09 15:04:31,813 -[line:96] - INFO: INTKPI getData Start
2021-08-09 15:04:31,814 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-09 15:05:20,833 -[line:96] - INFO: INTKPI __init__
2021-08-09 15:05:20,834 -[line:96] - INFO: INTKPI getData Start
2021-08-09 15:05:20,834 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-09 15:05:20,835 -[line:99] - ERROR: File:[D:\Project\source\dataproviderapi\BaseType.py] , Line:253 , in searchRedisKeys : [AttributeError] 'INTKPI' object has no attribute '_BaseType__master1'
2021-08-09 15:05:20,836 -[line:99] - ERROR: File:[D:\Project\source\dataproviderapi\BaseType.py] , Line:349 , in getKeyExpirTime : [AttributeError] 'INTKPI' object has no attribute '_BaseType__master1'
2021-08-09 15:05:59,471 -[line:96] - INFO: INTKPI __init__
2021-08-09 15:05:59,471 -[line:96] - INFO: INTKPI getData Start
2021-08-09 15:05:59,471 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-09 15:05:59,473 -[line:99] - ERROR: File:[D:\Project\source\dataproviderapi\BaseType.py] , Line:349 , in getKeyExpirTime : [AttributeError] 'INTKPI' object has no attribute '_BaseType__master1'
2021-08-09 15:06:25,252 -[line:96] - INFO: INTKPI __init__
2021-08-09 15:06:25,252 -[line:96] - INFO: INTKPI getData Start
2021-08-09 15:06:25,253 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-09 15:06:25,254 -[line:99] - ERROR: File:[D:\Project\source\dataproviderapi\BaseType.py] , Line:349 , in getKeyExpirTime : [AttributeError] 'INTKPI' object has no attribute '_BaseType__master1'
2021-08-09 15:06:27,706 -[line:96] - INFO: INTKPI __init__
2021-08-09 15:06:27,706 -[line:96] - INFO: INTKPI getData Start
2021-08-09 15:06:27,706 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-09 15:06:27,707 -[line:99] - ERROR: File:[D:\Project\source\dataproviderapi\BaseType.py] , Line:349 , in getKeyExpirTime : [AttributeError] 'INTKPI' object has no attribute '_BaseType__master1'
2021-08-09 15:13:16,489 -[line:96] - INFO: INTKPI __init__
2021-08-09 15:13:16,490 -[line:96] - INFO: INTKPI getData Start
2021-08-09 15:13:16,490 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-09 15:16:14,218 -[line:96] - INFO: INTKPI __init__
2021-08-09 15:16:14,218 -[line:96] - INFO: INTKPI getData Start
2021-08-09 15:16:14,219 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-10 09:09:29,487 -[line:96] - INFO: INTKPI __init__
2021-08-10 09:09:29,488 -[line:96] - INFO: INTKPI getData Start
2021-08-10 09:09:29,488 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-10 09:09:29,496 -[line:99] - ERROR: File:[D:\Project\source\dataproviderapi\GetINTKPI.py] , Line:176 , in _getTagetObject : [AttributeError] 'str' object has no attribute 'key'
2021-08-10 09:58:47,504 -[line:96] - INFO: INTKPI __init__
2021-08-10 09:58:47,505 -[line:96] - INFO: INTKPI getData Start
2021-08-10 09:58:47,506 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-10 09:58:47,513 -[line:99] - ERROR: File:[D:\Project\source\dataproviderapi\GetINTKPI.py] , Line:187 , in _getMongoData : [KeyError] FPY
2021-08-10 10:00:14,376 -[line:96] - INFO: INTKPI __init__
2021-08-10 10:00:14,377 -[line:96] - INFO: INTKPI getData Start
2021-08-10 10:00:14,377 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-10 10:00:14,384 -[line:99] - ERROR: File:[D:\Project\source\dataproviderapi\GetINTKPI.py] , Line:96 , in getData : [KeyError] FPY
2021-08-10 10:00:27,355 -[line:96] - INFO: INTKPI __init__
2021-08-10 10:00:27,358 -[line:96] - INFO: INTKPI getData Start
2021-08-10 10:00:27,359 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-10 10:00:27,367 -[line:99] - ERROR: File:[D:\Project\source\dataproviderapi\GetINTKPI.py] , Line:96 , in getData : [KeyError] FPY
2021-08-10 10:01:10,049 -[line:96] - INFO: INTKPI __init__
2021-08-10 10:01:10,049 -[line:96] - INFO: INTKPI getData Start
2021-08-10 10:01:10,050 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-10 10:01:35,541 -[line:96] - INFO: INTKPI __init__
2021-08-10 10:01:35,541 -[line:96] - INFO: INTKPI getData Start
2021-08-10 10:01:35,541 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-10 10:01:35,549 -[line:99] - ERROR: File:[D:\Project\source\dataproviderapi\GetINTKPI.py] , Line:97 , in getData : [KeyError] FPY
2021-08-10 10:01:51,112 -[line:96] - INFO: INTKPI __init__
2021-08-10 10:01:51,112 -[line:96] - INFO: INTKPI getData Start
2021-08-10 10:01:51,113 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-10 10:02:50,865 -[line:96] - INFO: INTKPI __init__
2021-08-10 10:02:50,866 -[line:96] - INFO: INTKPI getData Start
2021-08-10 10:02:50,866 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-10 10:02:50,873 -[line:99] - ERROR: File:[D:\Project\source\dataproviderapi\GetINTKPI.py] , Line:189 , in _getMongoData : [KeyError] numerator
2021-08-10 10:09:18,247 -[line:96] - INFO: INTKPI __init__
2021-08-10 10:09:18,247 -[line:96] - INFO: INTKPI getData Start
2021-08-10 10:09:18,248 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-10 10:09:18,254 -[line:96] - INFO: deftAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$match': {'MAIN_WC': 1300}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'PCBI', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 10:09:18,257 -[line:99] - ERROR: File:[D:\Project\source\dataproviderapi\GetINTKPI.py] , Line:329 , in _getFPYData : [AttributeError] 'dict' object has no attribute 'fromt'
2021-08-10 10:47:20,269 -[line:96] - INFO: INTKPI __init__
2021-08-10 10:47:20,279 -[line:96] - INFO: INTKPI getData Start
2021-08-10 10:47:20,279 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-10 10:47:20,313 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': 1300}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'PCBI', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 10:47:20,315 -[line:96] - INFO: deftAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'DEFT_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'DEFT_QTY': '$DEFT_QTY'}}, {'$match': {'MAIN_WC': {'$gt': 1050, '$lt': 1310}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'DeftSUMQty': {'$sum': {'$toInt': '$DEFT_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'PCBI', 'DeftSUMQty': '$DeftSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 10:48:38,121 -[line:96] - INFO: INTKPI __init__
2021-08-10 10:48:38,121 -[line:96] - INFO: INTKPI getData Start
2021-08-10 10:48:38,122 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-10 10:48:38,128 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': 1300}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'PCBI', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 10:48:38,129 -[line:96] - INFO: deftAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'DEFT_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'DEFT_QTY': '$DEFT_QTY'}}, {'$match': {'MAIN_WC': {'$gt': 1050, '$lt': 1310}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'DeftSUMQty': {'$sum': {'$toInt': '$DEFT_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'PCBI', 'DeftSUMQty': '$DeftSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 10:48:38,889 -[line:99] - ERROR: File:[C:\Users\hsinyuan.lin\AppData\Local\Programs\Python\Python36\lib\json\encoder.py] , Line:180 , in default : [TypeError] Object of type 'CommandCursor' is not JSON serializable
2021-08-10 10:49:31,805 -[line:96] - INFO: INTKPI __init__
2021-08-10 10:49:31,805 -[line:96] - INFO: INTKPI getData Start
2021-08-10 10:49:31,806 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-10 10:49:31,812 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': 1300}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'PCBI', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 10:49:31,813 -[line:96] - INFO: deftAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'DEFT_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'DEFT_QTY': '$DEFT_QTY'}}, {'$match': {'MAIN_WC': {'$gt': 1050, '$lt': 1310}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'DeftSUMQty': {'$sum': {'$toInt': '$DEFT_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'PCBI', 'DeftSUMQty': '$DeftSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 10:49:32,342 -[line:99] - ERROR: File:[C:\Users\hsinyuan.lin\AppData\Local\Programs\Python\Python36\lib\json\encoder.py] , Line:180 , in default : [TypeError] Object of type 'CommandCursor' is not JSON serializable
2021-08-10 10:58:21,254 -[line:96] - INFO: INTKPI __init__
2021-08-10 10:58:21,254 -[line:96] - INFO: INTKPI getData Start
2021-08-10 10:58:21,255 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-10 10:58:21,261 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [[1300, 1301]]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'PCBI', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 10:58:21,262 -[line:96] - INFO: deftAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'DEFT_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'DEFT_QTY': '$DEFT_QTY'}}, {'$match': {'MAIN_WC': {'$gt': 1050, '$lt': 1310}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'DeftSUMQty': {'$sum': {'$toInt': '$DEFT_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'PCBI', 'DeftSUMQty': '$DeftSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 10:58:21,819 -[line:99] - ERROR: File:[C:\Users\hsinyuan.lin\AppData\Local\Programs\Python\Python36\lib\json\encoder.py] , Line:180 , in default : [TypeError] Object of type 'CommandCursor' is not JSON serializable
2021-08-10 10:59:22,989 -[line:96] - INFO: INTKPI __init__
2021-08-10 10:59:23,002 -[line:96] - INFO: INTKPI getData Start
2021-08-10 10:59:23,003 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-10 10:59:23,011 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': ['1300,1301']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'PCBI', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 10:59:23,012 -[line:96] - INFO: deftAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'DEFT_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'DEFT_QTY': '$DEFT_QTY'}}, {'$match': {'MAIN_WC': {'$gt': 1050, '$lt': 1310}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'DeftSUMQty': {'$sum': {'$toInt': '$DEFT_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'PCBI', 'DeftSUMQty': '$DeftSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 10:59:23,555 -[line:99] - ERROR: File:[C:\Users\hsinyuan.lin\AppData\Local\Programs\Python\Python36\lib\json\encoder.py] , Line:180 , in default : [TypeError] Object of type 'CommandCursor' is not JSON serializable
2021-08-10 11:01:36,621 -[line:96] - INFO: INTKPI __init__
2021-08-10 11:01:36,621 -[line:96] - INFO: INTKPI getData Start
2021-08-10 11:01:36,622 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-10 11:01:36,629 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1300, 1301]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'PCBI', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 11:01:36,649 -[line:96] - INFO: deftAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'DEFT_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'DEFT_QTY': '$DEFT_QTY'}}, {'$match': {'MAIN_WC': {'$gt': 1050, '$lt': 1310}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'DeftSUMQty': {'$sum': {'$toInt': '$DEFT_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'PCBI', 'DeftSUMQty': '$DeftSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 11:01:37,193 -[line:99] - ERROR: File:[C:\Users\hsinyuan.lin\AppData\Local\Programs\Python\Python36\lib\json\encoder.py] , Line:180 , in default : [TypeError] Object of type 'CommandCursor' is not JSON serializable
2021-08-10 11:05:16,617 -[line:96] - INFO: INTKPI __init__
2021-08-10 11:05:16,617 -[line:96] - INFO: INTKPI getData Start
2021-08-10 11:05:16,618 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-10 11:05:16,626 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1300, 1301]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'PCBI', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 11:05:16,627 -[line:96] - INFO: deftAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'DEFT_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'DEFT_QTY': '$DEFT_QTY'}}, {'$match': {'MAIN_WC': {'$gt': 1050, '$lt': 1310}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'DeftSUMQty': {'$sum': {'$toInt': '$DEFT_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'PCBI', 'DeftSUMQty': '$DeftSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 11:05:17,198 -[line:99] - ERROR: File:[D:\Project\source\dataproviderapi\GetINTKPI.py] , Line:97 , in getData : [KeyError] oData
2021-08-10 11:05:47,003 -[line:96] - INFO: INTKPI __init__
2021-08-10 11:05:47,003 -[line:96] - INFO: INTKPI getData Start
2021-08-10 11:05:47,003 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-10 11:05:47,010 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1300, 1301]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'PCBI', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 11:05:47,011 -[line:96] - INFO: deftAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'DEFT_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'DEFT_QTY': '$DEFT_QTY'}}, {'$match': {'MAIN_WC': {'$gt': 1050, '$lt': 1310}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'DeftSUMQty': {'$sum': {'$toInt': '$DEFT_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'PCBI', 'DeftSUMQty': '$DeftSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 11:10:37,809 -[line:96] - INFO: INTKPI __init__
2021-08-10 11:10:37,809 -[line:96] - INFO: INTKPI getData Start
2021-08-10 11:10:37,809 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-10 11:10:37,816 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1300, 1301]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'PCBI', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 11:10:37,817 -[line:96] - INFO: deftAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'DEFT_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'DEFT_QTY': '$DEFT_QTY'}}, {'$match': {'MAIN_WC': {'$gt': 1050, '$lt': 1310}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'DeftSUMQty': {'$sum': {'$toInt': '$DEFT_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'PCBI', 'DeftSUMQty': '$DeftSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 11:11:14,072 -[line:96] - INFO: INTKPI __init__
2021-08-10 11:11:14,072 -[line:96] - INFO: INTKPI getData Start
2021-08-10 11:11:14,073 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-10 11:11:14,079 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1300, 1301]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'PCBI', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 11:11:14,081 -[line:96] - INFO: deftAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'DEFT_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'DEFT_QTY': '$DEFT_QTY'}}, {'$match': {'MAIN_WC': {'$gt': 1050, '$lt': 1310}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'DeftSUMQty': {'$sum': {'$toInt': '$DEFT_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'PCBI', 'DeftSUMQty': '$DeftSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 11:11:29,730 -[line:96] - INFO: INTKPI __init__
2021-08-10 11:11:29,730 -[line:96] - INFO: INTKPI getData Start
2021-08-10 11:11:29,730 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-10 11:11:29,736 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1300, 1301]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'PCBI', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 11:11:29,738 -[line:96] - INFO: deftAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'DEFT_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'DEFT_QTY': '$DEFT_QTY'}}, {'$match': {'MAIN_WC': {'$gt': 1050, '$lt': 1310}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'DeftSUMQty': {'$sum': {'$toInt': '$DEFT_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'PCBI', 'DeftSUMQty': '$DeftSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 11:12:04,044 -[line:96] - INFO: INTKPI __init__
2021-08-10 11:12:04,044 -[line:96] - INFO: INTKPI getData Start
2021-08-10 11:12:04,045 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-10 11:12:04,051 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1300, 1301]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'PCBI', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 11:12:04,052 -[line:96] - INFO: deftAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'DEFT_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'DEFT_QTY': '$DEFT_QTY'}}, {'$match': {'MAIN_WC': {'$gt': 1050, '$lt': 1310}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'DeftSUMQty': {'$sum': {'$toInt': '$DEFT_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'PCBI', 'DeftSUMQty': '$DeftSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 11:12:04,597 -[line:99] - ERROR: File:[C:\Users\hsinyuan.lin\AppData\Local\Programs\Python\Python36\lib\json\encoder.py] , Line:180 , in default : [TypeError] Object of type 'CommandCursor' is not JSON serializable
2021-08-10 11:12:36,996 -[line:96] - INFO: INTKPI __init__
2021-08-10 11:12:36,996 -[line:96] - INFO: INTKPI getData Start
2021-08-10 11:12:36,997 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-10 11:12:37,008 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1353, 1355]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'LAM', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 11:12:37,009 -[line:96] - INFO: deftAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'DEFT_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'DEFT_QTY': '$DEFT_QTY'}}, {'$match': {'MAIN_WC': {'$gt': 1340, '$lt': 1399}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'DeftSUMQty': {'$sum': {'$toInt': '$DEFT_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'LAM', 'DeftSUMQty': '$DeftSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 14:00:51,870 -[line:96] - INFO: INTKPI __init__
2021-08-10 14:00:52,025 -[line:96] - INFO: INTKPI getData Start
2021-08-10 14:00:52,025 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-10 14:00:52,056 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1300, 1301]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'PCBI', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 14:00:52,074 -[line:96] - INFO: deftAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'DEFT_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'DEFT_QTY': '$DEFT_QTY'}}, {'$match': {'MAIN_WC': {'$gt': 1050, '$lt': 1310}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'DeftSUMQty': {'$sum': {'$toInt': '$DEFT_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'PCBI', 'DeftSUMQty': '$DeftSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 14:00:52,930 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1355]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'LAM', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 14:00:52,960 -[line:96] - INFO: deftAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'DEFT_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'DEFT_QTY': '$DEFT_QTY'}}, {'$match': {'MAIN_WC': {'$gt': 1340, '$lt': 1399}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'DeftSUMQty': {'$sum': {'$toInt': '$DEFT_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'LAM', 'DeftSUMQty': '$DeftSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 14:00:53,474 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1420]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'AAFC', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 14:00:53,476 -[line:96] - INFO: deftAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'DEFT_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'DEFT_QTY': '$DEFT_QTY'}}, {'$match': {'MAIN_WC': {'$gt': 1400, '$lt': 1499}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'DeftSUMQty': {'$sum': {'$toInt': '$DEFT_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'AAFC', 'DeftSUMQty': '$DeftSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 14:00:53,998 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1600]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'CKEN', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 14:00:54,000 -[line:96] - INFO: deftAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'DEFT_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'DEFT_QTY': '$DEFT_QTY'}}, {'$match': {'MAIN_WC': {'$gt': 1500, '$lt': 1699}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'DeftSUMQty': {'$sum': {'$toInt': '$DEFT_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'CKEN', 'DeftSUMQty': '$DeftSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 14:00:54,566 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1600]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'DKEN', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 14:00:54,568 -[line:96] - INFO: deftAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'DEFT_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'DEFT_QTY': '$DEFT_QTY'}}, {'$match': {'MAIN_WC': {'$gt': 1700, '$lt': 1799}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'DeftSUMQty': {'$sum': {'$toInt': '$DEFT_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'DKEN', 'DeftSUMQty': '$DeftSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 14:00:55,158 -[line:99] - ERROR: File:[D:\Project\source\dataproviderapi\GetINTKPI.py] , Line:105 , in getData : [UnboundLocalError] local variable 'oData' referenced before assignment
2021-08-10 14:02:19,158 -[line:96] - INFO: INTKPI __init__
2021-08-10 14:02:19,158 -[line:96] - INFO: INTKPI getData Start
2021-08-10 14:02:19,159 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-10 14:02:19,165 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1300, 1301]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'PCBI', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 14:02:19,167 -[line:96] - INFO: deftAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'DEFT_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'DEFT_QTY': '$DEFT_QTY'}}, {'$match': {'MAIN_WC': {'$gt': 1050, '$lt': 1310}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'DeftSUMQty': {'$sum': {'$toInt': '$DEFT_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'PCBI', 'DeftSUMQty': '$DeftSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 14:02:19,694 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1355]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'LAM', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 14:02:19,697 -[line:96] - INFO: deftAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'DEFT_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'DEFT_QTY': '$DEFT_QTY'}}, {'$match': {'MAIN_WC': {'$gt': 1340, '$lt': 1399}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'DeftSUMQty': {'$sum': {'$toInt': '$DEFT_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'LAM', 'DeftSUMQty': '$DeftSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 14:02:20,292 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1420]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'AAFC', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 14:02:20,294 -[line:96] - INFO: deftAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'DEFT_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'DEFT_QTY': '$DEFT_QTY'}}, {'$match': {'MAIN_WC': {'$gt': 1400, '$lt': 1499}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'DeftSUMQty': {'$sum': {'$toInt': '$DEFT_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'AAFC', 'DeftSUMQty': '$DeftSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 14:02:20,806 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1600]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'CKEN', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 14:02:20,807 -[line:96] - INFO: deftAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'DEFT_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'DEFT_QTY': '$DEFT_QTY'}}, {'$match': {'MAIN_WC': {'$gt': 1500, '$lt': 1699}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'DeftSUMQty': {'$sum': {'$toInt': '$DEFT_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'CKEN', 'DeftSUMQty': '$DeftSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 14:02:21,320 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1600]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'DKEN', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 14:02:21,322 -[line:96] - INFO: deftAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'DEFT_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'DEFT_QTY': '$DEFT_QTY'}}, {'$match': {'MAIN_WC': {'$gt': 1700, '$lt': 1799}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'DeftSUMQty': {'$sum': {'$toInt': '$DEFT_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'DKEN', 'DeftSUMQty': '$DeftSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 14:04:32,591 -[line:96] - INFO: INTKPI __init__
2021-08-10 14:04:32,592 -[line:96] - INFO: INTKPI getData Start
2021-08-10 14:04:32,592 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-10 14:04:32,598 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1300, 1301]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'PCBI', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 14:04:32,609 -[line:96] - INFO: deftAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'DEFT_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'DEFT_QTY': '$DEFT_QTY'}}, {'$match': {'MAIN_WC': {'$gt': 1050, '$lt': 1310}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'DeftSUMQty': {'$sum': {'$toInt': '$DEFT_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'PCBI', 'DeftSUMQty': '$DeftSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 14:04:33,123 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1355]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'LAM', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 14:04:33,124 -[line:96] - INFO: deftAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'DEFT_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'DEFT_QTY': '$DEFT_QTY'}}, {'$match': {'MAIN_WC': {'$gt': 1340, '$lt': 1399}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'DeftSUMQty': {'$sum': {'$toInt': '$DEFT_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'LAM', 'DeftSUMQty': '$DeftSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 14:04:33,666 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1420]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'AAFC', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 14:04:33,668 -[line:96] - INFO: deftAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'DEFT_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'DEFT_QTY': '$DEFT_QTY'}}, {'$match': {'MAIN_WC': {'$gt': 1400, '$lt': 1499}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'DeftSUMQty': {'$sum': {'$toInt': '$DEFT_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'AAFC', 'DeftSUMQty': '$DeftSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 14:04:34,223 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1600]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'CKEN', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 14:04:34,224 -[line:96] - INFO: deftAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'DEFT_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'DEFT_QTY': '$DEFT_QTY'}}, {'$match': {'MAIN_WC': {'$gt': 1500, '$lt': 1699}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'DeftSUMQty': {'$sum': {'$toInt': '$DEFT_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'CKEN', 'DeftSUMQty': '$DeftSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 14:04:34,730 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1600]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'DKEN', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 14:04:34,731 -[line:96] - INFO: deftAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'DEFT_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'DEFT_QTY': '$DEFT_QTY'}}, {'$match': {'MAIN_WC': {'$gt': 1700, '$lt': 1799}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'DeftSUMQty': {'$sum': {'$toInt': '$DEFT_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'DKEN', 'DeftSUMQty': '$DeftSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 14:07:08,376 -[line:96] - INFO: INTKPI __init__
2021-08-10 14:07:08,376 -[line:96] - INFO: INTKPI getData Start
2021-08-10 14:07:08,376 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-10 14:07:08,387 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1300, 1301]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'PCBI', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 14:07:08,389 -[line:96] - INFO: deftAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'DEFT_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'DEFT_QTY': '$DEFT_QTY'}}, {'$match': {'MAIN_WC': {'$gt': 1050, '$lt': 1310}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'DeftSUMQty': {'$sum': {'$toInt': '$DEFT_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'PCBI', 'DeftSUMQty': '$DeftSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 14:07:08,928 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1355]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'LAM', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 14:07:08,930 -[line:96] - INFO: deftAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'DEFT_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'DEFT_QTY': '$DEFT_QTY'}}, {'$match': {'MAIN_WC': {'$gt': 1340, '$lt': 1399}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'DeftSUMQty': {'$sum': {'$toInt': '$DEFT_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'LAM', 'DeftSUMQty': '$DeftSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 14:07:09,451 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1420]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'AAFC', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 14:07:09,453 -[line:96] - INFO: deftAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'DEFT_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'DEFT_QTY': '$DEFT_QTY'}}, {'$match': {'MAIN_WC': {'$gt': 1400, '$lt': 1499}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'DeftSUMQty': {'$sum': {'$toInt': '$DEFT_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'AAFC', 'DeftSUMQty': '$DeftSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 14:07:09,961 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1600]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'CKEN', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 14:07:09,963 -[line:96] - INFO: deftAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'DEFT_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'DEFT_QTY': '$DEFT_QTY'}}, {'$match': {'MAIN_WC': {'$gt': 1500, '$lt': 1699}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'DeftSUMQty': {'$sum': {'$toInt': '$DEFT_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'CKEN', 'DeftSUMQty': '$DeftSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 14:07:10,492 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1600]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'DKEN', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 14:07:10,493 -[line:96] - INFO: deftAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'DEFT_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'DEFT_QTY': '$DEFT_QTY'}}, {'$match': {'MAIN_WC': {'$gt': 1700, '$lt': 1799}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'DeftSUMQty': {'$sum': {'$toInt': '$DEFT_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'DKEN', 'DeftSUMQty': '$DeftSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 14:07:11,056 -[line:96] - INFO: d:2HE080IA1010S / p:2HE080IA1010S
2021-08-10 14:07:11,064 -[line:96] - INFO: d:GHD140ZB0000S / p:2HE080IA1010S
2021-08-10 14:07:11,065 -[line:96] - INFO: d:GP062CCAC100S / p:2HE080IA1010S
2021-08-10 14:07:11,150 -[line:96] - INFO: d:GP070BAGM050S / p:2HE080IA1010S
2021-08-10 14:07:11,152 -[line:96] - INFO: d:GP080DZD00B0S / p:2HE080IA1010S
2021-08-10 14:07:11,153 -[line:96] - INFO: d:GP130ZFA0010S / p:2HE080IA1010S
2021-08-10 14:07:11,153 -[line:96] - INFO: d:GZD070SA4030S / p:2HE080IA1010S
2021-08-10 14:07:11,155 -[line:96] - INFO: d:GZD080JAB010S / p:2HE080IA1010S
2021-08-10 14:07:11,156 -[line:96] - INFO: d:GZJ055IAB010S / p:2HE080IA1010S
2021-08-10 14:08:07,919 -[line:96] - INFO: INTKPI __init__
2021-08-10 14:08:07,919 -[line:96] - INFO: INTKPI getData Start
2021-08-10 14:08:07,919 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-10 14:08:07,927 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1300, 1301]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'PCBI', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 14:08:07,928 -[line:96] - INFO: deftAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'DEFT_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'DEFT_QTY': '$DEFT_QTY'}}, {'$match': {'MAIN_WC': {'$gt': 1050, '$lt': 1310}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'DeftSUMQty': {'$sum': {'$toInt': '$DEFT_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'PCBI', 'DeftSUMQty': '$DeftSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 14:08:08,527 -[line:96] - INFO: d:2HE080IA1010S / p:2HE080IA1010S
2021-08-10 14:08:08,531 -[line:96] - INFO: d:GHD140ZB0000S / p:2HE080IA1010S
2021-08-10 14:08:08,532 -[line:96] - INFO: d:GP062CCAC100S / p:2HE080IA1010S
2021-08-10 14:08:08,532 -[line:96] - INFO: d:GP070BAGM050S / p:2HE080IA1010S
2021-08-10 14:08:08,532 -[line:96] - INFO: d:GP080DZD00B0S / p:2HE080IA1010S
2021-08-10 14:08:08,532 -[line:96] - INFO: d:GP130ZFA0010S / p:2HE080IA1010S
2021-08-10 14:08:08,533 -[line:96] - INFO: d:GZD070SA4030S / p:2HE080IA1010S
2021-08-10 14:08:08,533 -[line:96] - INFO: d:GZD080JAB010S / p:2HE080IA1010S
2021-08-10 14:08:08,533 -[line:96] - INFO: d:GZJ055IAB010S / p:2HE080IA1010S
2021-08-10 14:11:28,902 -[line:96] - INFO: INTKPI __init__
2021-08-10 14:11:28,902 -[line:96] - INFO: INTKPI getData Start
2021-08-10 14:11:28,902 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-10 14:11:28,909 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1300, 1301]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'PCBI', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 14:11:28,911 -[line:96] - INFO: deftAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'DEFT_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'DEFT_QTY': '$DEFT_QTY'}}, {'$match': {'MAIN_WC': {'$gt': 1050, '$lt': 1310}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'DeftSUMQty': {'$sum': {'$toInt': '$DEFT_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'PCBI', 'DeftSUMQty': '$DeftSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 14:11:29,467 -[line:96] - INFO: p:2HE080IA1010S
2021-08-10 14:11:29,467 -[line:96] - INFO: d:2HE080IA1010S / p:2HE080IA1010S
2021-08-10 14:11:29,471 -[line:96] - INFO: d:GHD140ZB0000S / p:2HE080IA1010S
2021-08-10 14:11:29,471 -[line:96] - INFO: d:GP062CCAC100S / p:2HE080IA1010S
2021-08-10 14:11:29,472 -[line:96] - INFO: d:GP070BAGM050S / p:2HE080IA1010S
2021-08-10 14:11:29,472 -[line:96] - INFO: d:GP080DZD00B0S / p:2HE080IA1010S
2021-08-10 14:11:29,472 -[line:96] - INFO: d:GP130ZFA0010S / p:2HE080IA1010S
2021-08-10 14:11:29,472 -[line:96] - INFO: d:GZD070SA4030S / p:2HE080IA1010S
2021-08-10 14:11:29,473 -[line:96] - INFO: d:GZD080JAB010S / p:2HE080IA1010S
2021-08-10 14:11:29,473 -[line:96] - INFO: d:GZJ055IAB010S / p:2HE080IA1010S
2021-08-10 14:11:29,473 -[line:96] - INFO: p:GHD140ZB0000S
2021-08-10 14:11:29,473 -[line:96] - INFO: p:GP062CCAC100S
2021-08-10 14:11:29,474 -[line:96] - INFO: p:GP062CCAY010S
2021-08-10 14:11:29,474 -[line:96] - INFO: p:GP070BAGM050S
2021-08-10 14:11:29,474 -[line:96] - INFO: p:GP080DZD00B0S
2021-08-10 14:11:29,475 -[line:96] - INFO: p:GP130ZFA0010S
2021-08-10 14:11:29,475 -[line:96] - INFO: p:GZD070SA4030S
2021-08-10 14:11:29,475 -[line:96] - INFO: p:GZD080JAB010S
2021-08-10 14:13:37,531 -[line:96] - INFO: INTKPI __init__
2021-08-10 14:13:37,531 -[line:96] - INFO: INTKPI getData Start
2021-08-10 14:13:37,531 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-10 14:13:37,538 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1300, 1301]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'PCBI', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 14:13:37,540 -[line:96] - INFO: deftAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'DEFT_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'DEFT_QTY': '$DEFT_QTY'}}, {'$match': {'MAIN_WC': {'$gt': 1050, '$lt': 1310}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'DeftSUMQty': {'$sum': {'$toInt': '$DEFT_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'PCBI', 'DeftSUMQty': '$DeftSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 14:13:38,070 -[line:96] - INFO: p:2HE080IA1010S
2021-08-10 14:13:38,071 -[line:96] - INFO: d:2HE080IA1010S / p:2HE080IA1010S
2021-08-10 14:13:38,076 -[line:96] - INFO: d:GHD140ZB0000S / p:2HE080IA1010S
2021-08-10 14:13:38,076 -[line:96] - INFO: d:GP062CCAC100S / p:2HE080IA1010S
2021-08-10 14:13:38,076 -[line:96] - INFO: d:GP070BAGM050S / p:2HE080IA1010S
2021-08-10 14:13:38,077 -[line:96] - INFO: d:GP080DZD00B0S / p:2HE080IA1010S
2021-08-10 14:13:38,077 -[line:96] - INFO: d:GP130ZFA0010S / p:2HE080IA1010S
2021-08-10 14:13:38,077 -[line:96] - INFO: d:GZD070SA4030S / p:2HE080IA1010S
2021-08-10 14:13:38,077 -[line:96] - INFO: d:GZD080JAB010S / p:2HE080IA1010S
2021-08-10 14:13:38,078 -[line:96] - INFO: d:GZJ055IAB010S / p:2HE080IA1010S
2021-08-10 14:13:38,078 -[line:96] - INFO: p:GHD140ZB0000S
2021-08-10 14:13:38,078 -[line:96] - INFO: d:2HE080IA1010S / p:GHD140ZB0000S
2021-08-10 14:13:38,078 -[line:96] - INFO: d:GHD140ZB0000S / p:GHD140ZB0000S
2021-08-10 14:13:38,078 -[line:96] - INFO: d:GP062CCAC100S / p:GHD140ZB0000S
2021-08-10 14:13:38,079 -[line:96] - INFO: d:GP070BAGM050S / p:GHD140ZB0000S
2021-08-10 14:13:38,079 -[line:96] - INFO: d:GP080DZD00B0S / p:GHD140ZB0000S
2021-08-10 14:13:38,079 -[line:96] - INFO: d:GP130ZFA0010S / p:GHD140ZB0000S
2021-08-10 14:13:38,080 -[line:96] - INFO: d:GZD070SA4030S / p:GHD140ZB0000S
2021-08-10 14:13:38,080 -[line:96] - INFO: d:GZD080JAB010S / p:GHD140ZB0000S
2021-08-10 14:13:38,080 -[line:96] - INFO: d:GZJ055IAB010S / p:GHD140ZB0000S
2021-08-10 14:13:38,080 -[line:96] - INFO: p:GP062CCAC100S
2021-08-10 14:13:38,081 -[line:96] - INFO: d:2HE080IA1010S / p:GP062CCAC100S
2021-08-10 14:13:38,081 -[line:96] - INFO: d:GHD140ZB0000S / p:GP062CCAC100S
2021-08-10 14:13:38,081 -[line:96] - INFO: d:GP062CCAC100S / p:GP062CCAC100S
2021-08-10 14:13:38,081 -[line:96] - INFO: d:GP070BAGM050S / p:GP062CCAC100S
2021-08-10 14:13:38,082 -[line:96] - INFO: d:GP080DZD00B0S / p:GP062CCAC100S
2021-08-10 14:13:38,082 -[line:96] - INFO: d:GP130ZFA0010S / p:GP062CCAC100S
2021-08-10 14:13:38,082 -[line:96] - INFO: d:GZD070SA4030S / p:GP062CCAC100S
2021-08-10 14:13:38,082 -[line:96] - INFO: d:GZD080JAB010S / p:GP062CCAC100S
2021-08-10 14:13:38,083 -[line:96] - INFO: d:GZJ055IAB010S / p:GP062CCAC100S
2021-08-10 14:13:38,083 -[line:96] - INFO: p:GP062CCAY010S
2021-08-10 14:13:38,083 -[line:96] - INFO: d:2HE080IA1010S / p:GP062CCAY010S
2021-08-10 14:13:38,083 -[line:96] - INFO: d:GHD140ZB0000S / p:GP062CCAY010S
2021-08-10 14:13:38,084 -[line:96] - INFO: d:GP062CCAC100S / p:GP062CCAY010S
2021-08-10 14:13:38,084 -[line:96] - INFO: d:GP070BAGM050S / p:GP062CCAY010S
2021-08-10 14:13:38,084 -[line:96] - INFO: d:GP080DZD00B0S / p:GP062CCAY010S
2021-08-10 14:13:38,084 -[line:96] - INFO: d:GP130ZFA0010S / p:GP062CCAY010S
2021-08-10 14:13:38,084 -[line:96] - INFO: d:GZD070SA4030S / p:GP062CCAY010S
2021-08-10 14:13:38,085 -[line:96] - INFO: d:GZD080JAB010S / p:GP062CCAY010S
2021-08-10 14:13:38,085 -[line:96] - INFO: d:GZJ055IAB010S / p:GP062CCAY010S
2021-08-10 14:13:38,085 -[line:96] - INFO: p:GP070BAGM050S
2021-08-10 14:13:38,085 -[line:96] - INFO: d:2HE080IA1010S / p:GP070BAGM050S
2021-08-10 14:13:38,086 -[line:96] - INFO: d:GHD140ZB0000S / p:GP070BAGM050S
2021-08-10 14:13:38,086 -[line:96] - INFO: d:GP062CCAC100S / p:GP070BAGM050S
2021-08-10 14:13:38,086 -[line:96] - INFO: d:GP070BAGM050S / p:GP070BAGM050S
2021-08-10 14:13:38,086 -[line:96] - INFO: d:GP080DZD00B0S / p:GP070BAGM050S
2021-08-10 14:13:38,087 -[line:96] - INFO: d:GP130ZFA0010S / p:GP070BAGM050S
2021-08-10 14:13:38,087 -[line:96] - INFO: d:GZD070SA4030S / p:GP070BAGM050S
2021-08-10 14:13:38,087 -[line:96] - INFO: d:GZD080JAB010S / p:GP070BAGM050S
2021-08-10 14:13:38,087 -[line:96] - INFO: d:GZJ055IAB010S / p:GP070BAGM050S
2021-08-10 14:13:38,142 -[line:96] - INFO: p:GP080DZD00B0S
2021-08-10 14:13:38,142 -[line:96] - INFO: d:2HE080IA1010S / p:GP080DZD00B0S
2021-08-10 14:13:38,143 -[line:96] - INFO: d:GHD140ZB0000S / p:GP080DZD00B0S
2021-08-10 14:13:38,143 -[line:96] - INFO: d:GP062CCAC100S / p:GP080DZD00B0S
2021-08-10 14:13:38,143 -[line:96] - INFO: d:GP070BAGM050S / p:GP080DZD00B0S
2021-08-10 14:13:38,144 -[line:96] - INFO: d:GP080DZD00B0S / p:GP080DZD00B0S
2021-08-10 14:13:38,144 -[line:96] - INFO: d:GP130ZFA0010S / p:GP080DZD00B0S
2021-08-10 14:13:38,145 -[line:96] - INFO: d:GZD070SA4030S / p:GP080DZD00B0S
2021-08-10 14:13:38,145 -[line:96] - INFO: d:GZD080JAB010S / p:GP080DZD00B0S
2021-08-10 14:13:38,145 -[line:96] - INFO: d:GZJ055IAB010S / p:GP080DZD00B0S
2021-08-10 14:13:38,146 -[line:96] - INFO: p:GP130ZFA0010S
2021-08-10 14:13:38,146 -[line:96] - INFO: d:2HE080IA1010S / p:GP130ZFA0010S
2021-08-10 14:13:38,146 -[line:96] - INFO: d:GHD140ZB0000S / p:GP130ZFA0010S
2021-08-10 14:13:38,147 -[line:96] - INFO: d:GP062CCAC100S / p:GP130ZFA0010S
2021-08-10 14:13:38,147 -[line:96] - INFO: d:GP070BAGM050S / p:GP130ZFA0010S
2021-08-10 14:13:38,147 -[line:96] - INFO: d:GP080DZD00B0S / p:GP130ZFA0010S
2021-08-10 14:13:38,148 -[line:96] - INFO: d:GP130ZFA0010S / p:GP130ZFA0010S
2021-08-10 14:13:38,148 -[line:96] - INFO: d:GZD070SA4030S / p:GP130ZFA0010S
2021-08-10 14:13:38,149 -[line:96] - INFO: d:GZD080JAB010S / p:GP130ZFA0010S
2021-08-10 14:13:38,149 -[line:96] - INFO: d:GZJ055IAB010S / p:GP130ZFA0010S
2021-08-10 14:13:38,149 -[line:96] - INFO: p:GZD070SA4030S
2021-08-10 14:13:38,150 -[line:96] - INFO: d:2HE080IA1010S / p:GZD070SA4030S
2021-08-10 14:13:38,150 -[line:96] - INFO: d:GHD140ZB0000S / p:GZD070SA4030S
2021-08-10 14:13:38,150 -[line:96] - INFO: d:GP062CCAC100S / p:GZD070SA4030S
2021-08-10 14:13:38,151 -[line:96] - INFO: d:GP070BAGM050S / p:GZD070SA4030S
2021-08-10 14:13:38,151 -[line:96] - INFO: d:GP080DZD00B0S / p:GZD070SA4030S
2021-08-10 14:13:38,151 -[line:96] - INFO: d:GP130ZFA0010S / p:GZD070SA4030S
2021-08-10 14:13:38,151 -[line:96] - INFO: d:GZD070SA4030S / p:GZD070SA4030S
2021-08-10 14:13:38,152 -[line:96] - INFO: d:GZD080JAB010S / p:GZD070SA4030S
2021-08-10 14:13:38,152 -[line:96] - INFO: d:GZJ055IAB010S / p:GZD070SA4030S
2021-08-10 14:13:38,152 -[line:96] - INFO: p:GZD080JAB010S
2021-08-10 14:13:38,152 -[line:96] - INFO: d:2HE080IA1010S / p:GZD080JAB010S
2021-08-10 14:13:38,153 -[line:96] - INFO: d:GHD140ZB0000S / p:GZD080JAB010S
2021-08-10 14:13:38,153 -[line:96] - INFO: d:GP062CCAC100S / p:GZD080JAB010S
2021-08-10 14:13:38,153 -[line:96] - INFO: d:GP070BAGM050S / p:GZD080JAB010S
2021-08-10 14:13:38,153 -[line:96] - INFO: d:GP080DZD00B0S / p:GZD080JAB010S
2021-08-10 14:13:38,154 -[line:96] - INFO: d:GP130ZFA0010S / p:GZD080JAB010S
2021-08-10 14:13:38,155 -[line:96] - INFO: d:GZD070SA4030S / p:GZD080JAB010S
2021-08-10 14:13:38,155 -[line:96] - INFO: d:GZD080JAB010S / p:GZD080JAB010S
2021-08-10 14:13:38,155 -[line:96] - INFO: d:GZJ055IAB010S / p:GZD080JAB010S
2021-08-10 14:14:35,247 -[line:96] - INFO: INTKPI __init__
2021-08-10 14:14:35,247 -[line:96] - INFO: INTKPI getData Start
2021-08-10 14:14:35,248 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-10 14:14:35,255 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1300, 1301]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'PCBI', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 14:14:35,255 -[line:96] - INFO: deftAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'DEFT_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'DEFT_QTY': '$DEFT_QTY'}}, {'$match': {'MAIN_WC': {'$gt': 1050, '$lt': 1310}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'DeftSUMQty': {'$sum': {'$toInt': '$DEFT_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'PCBI', 'DeftSUMQty': '$DeftSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 14:14:35,778 -[line:96] - INFO: p:2HE080IA1010S
2021-08-10 14:14:35,778 -[line:96] - INFO: d:2HE080IA1010S / p:2HE080IA1010S
2021-08-10 14:14:35,782 -[line:96] - INFO: p:GHD140ZB0000S
2021-08-10 14:14:35,782 -[line:96] - INFO: d:2HE080IA1010S / p:GHD140ZB0000S
2021-08-10 14:14:35,783 -[line:96] - INFO: d:GHD140ZB0000S / p:GHD140ZB0000S
2021-08-10 14:14:35,783 -[line:96] - INFO: p:GP062CCAC100S
2021-08-10 14:14:35,783 -[line:96] - INFO: d:2HE080IA1010S / p:GP062CCAC100S
2021-08-10 14:14:35,784 -[line:96] - INFO: d:GHD140ZB0000S / p:GP062CCAC100S
2021-08-10 14:14:35,784 -[line:96] - INFO: d:GP062CCAC100S / p:GP062CCAC100S
2021-08-10 14:14:35,784 -[line:96] - INFO: p:GP062CCAY010S
2021-08-10 14:14:35,784 -[line:96] - INFO: d:2HE080IA1010S / p:GP062CCAY010S
2021-08-10 14:14:35,785 -[line:96] - INFO: d:GHD140ZB0000S / p:GP062CCAY010S
2021-08-10 14:14:35,785 -[line:96] - INFO: d:GP062CCAC100S / p:GP062CCAY010S
2021-08-10 14:14:35,785 -[line:96] - INFO: d:GP070BAGM050S / p:GP062CCAY010S
2021-08-10 14:14:35,785 -[line:96] - INFO: d:GP080DZD00B0S / p:GP062CCAY010S
2021-08-10 14:14:35,786 -[line:96] - INFO: d:GP130ZFA0010S / p:GP062CCAY010S
2021-08-10 14:14:35,786 -[line:96] - INFO: d:GZD070SA4030S / p:GP062CCAY010S
2021-08-10 14:14:35,786 -[line:96] - INFO: d:GZD080JAB010S / p:GP062CCAY010S
2021-08-10 14:14:35,786 -[line:96] - INFO: d:GZJ055IAB010S / p:GP062CCAY010S
2021-08-10 14:14:35,787 -[line:96] - INFO: p:GP070BAGM050S
2021-08-10 14:14:35,787 -[line:96] - INFO: d:2HE080IA1010S / p:GP070BAGM050S
2021-08-10 14:14:35,787 -[line:96] - INFO: d:GHD140ZB0000S / p:GP070BAGM050S
2021-08-10 14:14:35,787 -[line:96] - INFO: d:GP062CCAC100S / p:GP070BAGM050S
2021-08-10 14:14:35,788 -[line:96] - INFO: d:GP070BAGM050S / p:GP070BAGM050S
2021-08-10 14:14:35,788 -[line:96] - INFO: p:GP080DZD00B0S
2021-08-10 14:14:35,789 -[line:96] - INFO: d:2HE080IA1010S / p:GP080DZD00B0S
2021-08-10 14:14:35,789 -[line:96] - INFO: d:GHD140ZB0000S / p:GP080DZD00B0S
2021-08-10 14:14:35,789 -[line:96] - INFO: d:GP062CCAC100S / p:GP080DZD00B0S
2021-08-10 14:14:35,789 -[line:96] - INFO: d:GP070BAGM050S / p:GP080DZD00B0S
2021-08-10 14:14:35,790 -[line:96] - INFO: d:GP080DZD00B0S / p:GP080DZD00B0S
2021-08-10 14:14:35,790 -[line:96] - INFO: p:GP130ZFA0010S
2021-08-10 14:14:35,790 -[line:96] - INFO: d:2HE080IA1010S / p:GP130ZFA0010S
2021-08-10 14:14:35,790 -[line:96] - INFO: d:GHD140ZB0000S / p:GP130ZFA0010S
2021-08-10 14:14:35,791 -[line:96] - INFO: d:GP062CCAC100S / p:GP130ZFA0010S
2021-08-10 14:14:35,791 -[line:96] - INFO: d:GP070BAGM050S / p:GP130ZFA0010S
2021-08-10 14:14:35,791 -[line:96] - INFO: d:GP080DZD00B0S / p:GP130ZFA0010S
2021-08-10 14:14:35,791 -[line:96] - INFO: d:GP130ZFA0010S / p:GP130ZFA0010S
2021-08-10 14:14:35,792 -[line:96] - INFO: p:GZD070SA4030S
2021-08-10 14:14:35,792 -[line:96] - INFO: d:2HE080IA1010S / p:GZD070SA4030S
2021-08-10 14:14:35,792 -[line:96] - INFO: d:GHD140ZB0000S / p:GZD070SA4030S
2021-08-10 14:14:35,792 -[line:96] - INFO: d:GP062CCAC100S / p:GZD070SA4030S
2021-08-10 14:14:35,793 -[line:96] - INFO: d:GP070BAGM050S / p:GZD070SA4030S
2021-08-10 14:14:35,793 -[line:96] - INFO: d:GP080DZD00B0S / p:GZD070SA4030S
2021-08-10 14:14:35,793 -[line:96] - INFO: d:GP130ZFA0010S / p:GZD070SA4030S
2021-08-10 14:14:35,794 -[line:96] - INFO: d:GZD070SA4030S / p:GZD070SA4030S
2021-08-10 14:14:35,794 -[line:96] - INFO: p:GZD080JAB010S
2021-08-10 14:14:35,794 -[line:96] - INFO: d:2HE080IA1010S / p:GZD080JAB010S
2021-08-10 14:14:35,794 -[line:96] - INFO: d:GHD140ZB0000S / p:GZD080JAB010S
2021-08-10 14:14:35,795 -[line:96] - INFO: d:GP062CCAC100S / p:GZD080JAB010S
2021-08-10 14:14:35,795 -[line:96] - INFO: d:GP070BAGM050S / p:GZD080JAB010S
2021-08-10 14:14:35,795 -[line:96] - INFO: d:GP080DZD00B0S / p:GZD080JAB010S
2021-08-10 14:14:35,795 -[line:96] - INFO: d:GP130ZFA0010S / p:GZD080JAB010S
2021-08-10 14:14:35,796 -[line:96] - INFO: d:GZD070SA4030S / p:GZD080JAB010S
2021-08-10 14:14:35,796 -[line:96] - INFO: d:GZD080JAB010S / p:GZD080JAB010S
2021-08-10 14:25:52,379 -[line:96] - INFO: INTKPI __init__
2021-08-10 14:25:52,380 -[line:96] - INFO: INTKPI getData Start
2021-08-10 14:25:52,380 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-10 14:25:52,386 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1300, 1301]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'PCBI', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 14:25:52,388 -[line:96] - INFO: deftAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'DEFT_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'DEFT_QTY': '$DEFT_QTY'}}, {'$match': {'MAIN_WC': {'$gt': 1050, '$lt': 1310}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'DeftSUMQty': {'$sum': {'$toInt': '$DEFT_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'PCBI', 'DeftSUMQty': '$DeftSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 14:25:52,914 -[line:96] - INFO: p:2HE080IA1010S
2021-08-10 14:25:52,914 -[line:96] - INFO: d:2HE080IA1010S / p:2HE080IA1010S
2021-08-10 14:25:52,918 -[line:99] - ERROR: File:[D:\Project\source\dataproviderapi\GetINTKPI.py] , Line:122 , in getData : [TypeError] 'filter' object is not subscriptable
2021-08-10 14:26:39,895 -[line:96] - INFO: INTKPI __init__
2021-08-10 14:26:39,895 -[line:96] - INFO: INTKPI getData Start
2021-08-10 14:26:39,895 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-10 14:26:39,902 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1300, 1301]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'PCBI', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 14:26:39,903 -[line:96] - INFO: deftAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'DEFT_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'DEFT_QTY': '$DEFT_QTY'}}, {'$match': {'MAIN_WC': {'$gt': 1050, '$lt': 1310}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'DeftSUMQty': {'$sum': {'$toInt': '$DEFT_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'PCBI', 'DeftSUMQty': '$DeftSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 14:26:40,423 -[line:96] - INFO: p:2HE080IA1010S
2021-08-10 14:26:40,424 -[line:96] - INFO: d:2HE080IA1010S / p:2HE080IA1010S
2021-08-10 14:26:40,429 -[line:99] - ERROR: File:[D:\Project\source\dataproviderapi\GetINTKPI.py] , Line:122 , in getData : [AttributeError] 'filter' object has no attribute 'DeftSUMQty'
2021-08-10 14:27:48,788 -[line:96] - INFO: INTKPI __init__
2021-08-10 14:27:48,788 -[line:96] - INFO: INTKPI getData Start
2021-08-10 14:27:48,788 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-10 14:27:48,794 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1300, 1301]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'PCBI', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 14:27:48,796 -[line:96] - INFO: deftAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'DEFT_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'DEFT_QTY': '$DEFT_QTY'}}, {'$match': {'MAIN_WC': {'$gt': 1050, '$lt': 1310}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'DeftSUMQty': {'$sum': {'$toInt': '$DEFT_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'PCBI', 'DeftSUMQty': '$DeftSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 14:27:49,313 -[line:96] - INFO: p:2HE080IA1010S
2021-08-10 14:27:49,314 -[line:99] - ERROR: File:[D:\Project\source\dataproviderapi\GetINTKPI.py] , Line:110 , in getData : [TypeError] 'filter' object is not subscriptable
2021-08-10 14:28:34,536 -[line:96] - INFO: INTKPI __init__
2021-08-10 14:28:34,537 -[line:96] - INFO: INTKPI getData Start
2021-08-10 14:28:34,537 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-10 14:28:34,544 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1300, 1301]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'PCBI', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 14:28:34,545 -[line:96] - INFO: deftAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'DEFT_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'DEFT_QTY': '$DEFT_QTY'}}, {'$match': {'MAIN_WC': {'$gt': 1050, '$lt': 1310}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'DeftSUMQty': {'$sum': {'$toInt': '$DEFT_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'PCBI', 'DeftSUMQty': '$DeftSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 14:28:35,056 -[line:96] - INFO: p:2HE080IA1010S
2021-08-10 14:28:35,057 -[line:96] - INFO: d:<filter object at 0x0000022B28E24A58>
2021-08-10 14:28:35,061 -[line:99] - ERROR: File:[D:\Project\source\dataproviderapi\GetINTKPI.py] , Line:119 , in getData : [NameError] name 'getData' is not defined
2021-08-10 14:30:22,397 -[line:96] - INFO: INTKPI __init__
2021-08-10 14:30:22,397 -[line:96] - INFO: INTKPI getData Start
2021-08-10 14:30:22,398 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-10 14:30:22,404 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1300, 1301]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'PCBI', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 14:30:22,406 -[line:96] - INFO: deftAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'DEFT_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'DEFT_QTY': '$DEFT_QTY'}}, {'$match': {'MAIN_WC': {'$gt': 1050, '$lt': 1310}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'DeftSUMQty': {'$sum': {'$toInt': '$DEFT_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'PCBI', 'DeftSUMQty': '$DeftSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 14:30:22,937 -[line:96] - INFO: p:2HE080IA1010S
2021-08-10 14:30:22,939 -[line:99] - ERROR: File:[D:\Project\source\dataproviderapi\GetINTKPI.py] , Line:109 , in <lambda> : [AttributeError] 'dict' object has no attribute 'PROD_NBR'
2021-08-10 14:31:57,314 -[line:96] - INFO: INTKPI __init__
2021-08-10 14:31:57,316 -[line:96] - INFO: INTKPI getData Start
2021-08-10 14:31:57,316 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-10 14:31:57,323 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1300, 1301]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'PCBI', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 14:31:57,324 -[line:96] - INFO: deftAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'DEFT_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'DEFT_QTY': '$DEFT_QTY'}}, {'$match': {'MAIN_WC': {'$gt': 1050, '$lt': 1310}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'DeftSUMQty': {'$sum': {'$toInt': '$DEFT_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'PCBI', 'DeftSUMQty': '$DeftSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 14:31:57,854 -[line:96] - INFO: p:2HE080IA1010S
2021-08-10 14:31:57,854 -[line:96] - INFO: d:[{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'PROD_NBR': '2HE080IA1010S', 'ACCT_DATE': '20210801', 'APPLICATION': 'TABLET', 'OPER': 'PCBI', 'DeftSUMQty': 6}]
2021-08-10 14:31:57,858 -[line:99] - ERROR: File:[D:\Project\source\dataproviderapi\GetINTKPI.py] , Line:119 , in getData : [TypeError] list indices must be integers or slices, not str
2021-08-10 14:34:06,530 -[line:96] - INFO: INTKPI __init__
2021-08-10 14:34:06,530 -[line:96] - INFO: INTKPI getData Start
2021-08-10 14:34:06,531 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-10 14:34:06,536 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1300, 1301]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'PCBI', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 14:34:06,538 -[line:96] - INFO: deftAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'DEFT_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'DEFT_QTY': '$DEFT_QTY'}}, {'$match': {'MAIN_WC': {'$gt': 1050, '$lt': 1310}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'DeftSUMQty': {'$sum': {'$toInt': '$DEFT_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'PCBI', 'DeftSUMQty': '$DeftSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 14:34:07,091 -[line:96] - INFO: p:2HE080IA1010S
2021-08-10 14:34:07,091 -[line:96] - INFO: d:[{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'PROD_NBR': '2HE080IA1010S', 'ACCT_DATE': '20210801', 'APPLICATION': 'TABLET', 'OPER': 'PCBI', 'DeftSUMQty': 6}]
2021-08-10 14:34:07,096 -[line:96] - INFO: p:GHD140ZB0000S
2021-08-10 14:34:07,096 -[line:96] - INFO: d:[{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'PROD_NBR': 'GHD140ZB0000S', 'ACCT_DATE': '20210801', 'APPLICATION': 'TABLET', 'OPER': 'PCBI', 'DeftSUMQty': 1}]
2021-08-10 14:34:07,097 -[line:96] - INFO: p:GP062CCAC100S
2021-08-10 14:34:07,097 -[line:96] - INFO: d:[{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'PROD_NBR': 'GP062CCAC100S', 'ACCT_DATE': '20210801', 'APPLICATION': 'CE', 'OPER': 'PCBI', 'DeftSUMQty': 119}]
2021-08-10 14:34:07,097 -[line:96] - INFO: p:GP062CCAY010S
2021-08-10 14:34:07,098 -[line:96] - INFO: d:[]
2021-08-10 14:34:07,098 -[line:99] - ERROR: File:[D:\Project\source\dataproviderapi\GetINTKPI.py] , Line:119 , in getData : [IndexError] list index out of range
2021-08-10 14:36:51,714 -[line:96] - INFO: INTKPI __init__
2021-08-10 14:36:51,714 -[line:96] - INFO: INTKPI getData Start
2021-08-10 14:36:51,714 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-10 14:36:51,721 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1300, 1301]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'PCBI', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 14:36:51,723 -[line:96] - INFO: deftAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'DEFT_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'DEFT_QTY': '$DEFT_QTY'}}, {'$match': {'MAIN_WC': {'$gt': 1050, '$lt': 1310}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'DeftSUMQty': {'$sum': {'$toInt': '$DEFT_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'PCBI', 'DeftSUMQty': '$DeftSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 14:36:52,281 -[line:96] - INFO: p:2HE080IA1010S
2021-08-10 14:36:52,282 -[line:96] - INFO: <filter object at 0x000002061B5D2DD8>
2021-08-10 14:36:52,282 -[line:96] - INFO: d:[{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'PROD_NBR': '2HE080IA1010S', 'ACCT_DATE': '20210801', 'APPLICATION': 'TABLET', 'OPER': 'PCBI', 'DeftSUMQty': 6}]
2021-08-10 14:36:52,287 -[line:96] - INFO: p:GHD140ZB0000S
2021-08-10 14:36:52,288 -[line:96] - INFO: <filter object at 0x000002061B5D2B38>
2021-08-10 14:36:52,288 -[line:96] - INFO: d:[{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'PROD_NBR': 'GHD140ZB0000S', 'ACCT_DATE': '20210801', 'APPLICATION': 'TABLET', 'OPER': 'PCBI', 'DeftSUMQty': 1}]
2021-08-10 14:36:52,289 -[line:96] - INFO: p:GP062CCAC100S
2021-08-10 14:36:52,289 -[line:96] - INFO: <filter object at 0x000002061B5D2DD8>
2021-08-10 14:36:52,289 -[line:96] - INFO: d:[{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'PROD_NBR': 'GP062CCAC100S', 'ACCT_DATE': '20210801', 'APPLICATION': 'CE', 'OPER': 'PCBI', 'DeftSUMQty': 119}]
2021-08-10 14:36:52,290 -[line:96] - INFO: p:GP062CCAY010S
2021-08-10 14:36:52,290 -[line:96] - INFO: <filter object at 0x000002061B5D2DD8>
2021-08-10 14:36:52,290 -[line:96] - INFO: d:[]
2021-08-10 14:36:52,291 -[line:99] - ERROR: File:[D:\Project\source\dataproviderapi\GetINTKPI.py] , Line:120 , in getData : [IndexError] list index out of range
2021-08-10 14:38:29,475 -[line:96] - INFO: INTKPI __init__
2021-08-10 14:38:29,476 -[line:96] - INFO: INTKPI getData Start
2021-08-10 14:38:29,476 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-10 14:38:29,482 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1300, 1301]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'PCBI', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 14:38:29,483 -[line:96] - INFO: deftAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'DEFT_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'DEFT_QTY': '$DEFT_QTY'}}, {'$match': {'MAIN_WC': {'$gt': 1050, '$lt': 1310}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'DeftSUMQty': {'$sum': {'$toInt': '$DEFT_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'PCBI', 'DeftSUMQty': '$DeftSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 14:38:30,018 -[line:96] - INFO: p:2HE080IA1010S
2021-08-10 14:38:30,018 -[line:96] - INFO: d:[{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'PROD_NBR': '2HE080IA1010S', 'ACCT_DATE': '20210801', 'APPLICATION': 'TABLET', 'OPER': 'PCBI', 'DeftSUMQty': 6}]
2021-08-10 14:38:30,019 -[line:96] - INFO: p:GHD140ZB0000S
2021-08-10 14:38:30,019 -[line:96] - INFO: d:[{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'PROD_NBR': 'GHD140ZB0000S', 'ACCT_DATE': '20210801', 'APPLICATION': 'TABLET', 'OPER': 'PCBI', 'DeftSUMQty': 1}]
2021-08-10 14:38:30,019 -[line:96] - INFO: p:GP062CCAC100S
2021-08-10 14:38:30,020 -[line:96] - INFO: d:[{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'PROD_NBR': 'GP062CCAC100S', 'ACCT_DATE': '20210801', 'APPLICATION': 'CE', 'OPER': 'PCBI', 'DeftSUMQty': 119}]
2021-08-10 14:38:30,020 -[line:96] - INFO: p:GP062CCAY010S
2021-08-10 14:38:30,020 -[line:96] - INFO: d:[]
2021-08-10 14:38:30,025 -[line:99] - ERROR: File:[D:\Project\source\dataproviderapi\GetINTKPI.py] , Line:120 , in getData : [IndexError] list index out of range
2021-08-10 14:39:33,783 -[line:96] - INFO: INTKPI __init__
2021-08-10 14:39:33,784 -[line:96] - INFO: INTKPI getData Start
2021-08-10 14:39:33,784 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-10 14:39:33,790 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1300, 1301]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'PCBI', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 14:39:33,792 -[line:96] - INFO: deftAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'DEFT_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'DEFT_QTY': '$DEFT_QTY'}}, {'$match': {'MAIN_WC': {'$gt': 1050, '$lt': 1310}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'DeftSUMQty': {'$sum': {'$toInt': '$DEFT_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'PCBI', 'DeftSUMQty': '$DeftSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 14:39:34,324 -[line:96] - INFO: p:2HE080IA1010S
2021-08-10 14:39:34,324 -[line:96] - INFO: d:[{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'PROD_NBR': '2HE080IA1010S', 'ACCT_DATE': '20210801', 'APPLICATION': 'TABLET', 'OPER': 'PCBI', 'DeftSUMQty': 6}]
2021-08-10 14:39:34,328 -[line:96] - INFO: p:GHD140ZB0000S
2021-08-10 14:39:34,329 -[line:96] - INFO: d:[{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'PROD_NBR': 'GHD140ZB0000S', 'ACCT_DATE': '20210801', 'APPLICATION': 'TABLET', 'OPER': 'PCBI', 'DeftSUMQty': 1}]
2021-08-10 14:39:34,329 -[line:96] - INFO: p:GP062CCAC100S
2021-08-10 14:39:34,329 -[line:96] - INFO: d:[{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'PROD_NBR': 'GP062CCAC100S', 'ACCT_DATE': '20210801', 'APPLICATION': 'CE', 'OPER': 'PCBI', 'DeftSUMQty': 119}]
2021-08-10 14:39:34,330 -[line:96] - INFO: p:GP062CCAY010S
2021-08-10 14:39:34,330 -[line:96] - INFO: d:[]
2021-08-10 14:39:34,330 -[line:96] - INFO: p:GP070BAGM050S
2021-08-10 14:39:34,331 -[line:96] - INFO: d:[{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'PROD_NBR': 'GP070BAGM050S', 'ACCT_DATE': '20210801', 'APPLICATION': 'CE', 'OPER': 'PCBI', 'DeftSUMQty': 14}]
2021-08-10 14:39:34,331 -[line:96] - INFO: p:GP080DZD00B0S
2021-08-10 14:39:34,332 -[line:96] - INFO: d:[{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'PROD_NBR': 'GP080DZD00B0S', 'ACCT_DATE': '20210801', 'APPLICATION': 'TABLET', 'OPER': 'PCBI', 'DeftSUMQty': 59}]
2021-08-10 14:39:34,332 -[line:96] - INFO: p:GP130ZFA0010S
2021-08-10 14:39:34,332 -[line:96] - INFO: d:[{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'PROD_NBR': 'GP130ZFA0010S', 'ACCT_DATE': '20210801', 'APPLICATION': 'TABLET', 'OPER': 'PCBI', 'DeftSUMQty': 17}]
2021-08-10 14:39:34,333 -[line:96] - INFO: p:GZD070SA4030S
2021-08-10 14:39:34,333 -[line:96] - INFO: d:[{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'PROD_NBR': 'GZD070SA4030S', 'ACCT_DATE': '20210801', 'APPLICATION': 'CE', 'OPER': 'PCBI', 'DeftSUMQty': 5}]
2021-08-10 14:39:34,333 -[line:96] - INFO: p:GZD080JAB010S
2021-08-10 14:39:34,334 -[line:96] - INFO: d:[{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'PROD_NBR': 'GZD080JAB010S', 'ACCT_DATE': '20210801', 'APPLICATION': 'CE', 'OPER': 'PCBI', 'DeftSUMQty': 20}]
2021-08-10 14:48:23,294 -[line:96] - INFO: INTKPI __init__
2021-08-10 14:48:23,295 -[line:96] - INFO: INTKPI getData Start
2021-08-10 14:48:23,295 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-10 14:48:23,302 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1300, 1301]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'PCBI', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 14:48:23,303 -[line:96] - INFO: deftAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'DEFT_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'DEFT_QTY': '$DEFT_QTY'}}, {'$match': {'MAIN_WC': {'$gt': 1050, '$lt': 1310}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'DeftSUMQty': {'$sum': {'$toInt': '$DEFT_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'PCBI', 'DeftSUMQty': '$DeftSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 14:49:08,641 -[line:96] - INFO: INTKPI __init__
2021-08-10 14:49:08,641 -[line:96] - INFO: INTKPI getData Start
2021-08-10 14:49:08,642 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-10 14:49:08,648 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1300, 1301]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'PCBI', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 14:49:08,649 -[line:96] - INFO: deftAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'DEFT_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'DEFT_QTY': '$DEFT_QTY'}}, {'$match': {'MAIN_WC': {'$gt': 1050, '$lt': 1310}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'DeftSUMQty': {'$sum': {'$toInt': '$DEFT_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'PCBI', 'DeftSUMQty': '$DeftSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 14:52:39,955 -[line:96] - INFO: INTKPI __init__
2021-08-10 14:52:39,955 -[line:96] - INFO: INTKPI getData Start
2021-08-10 14:52:39,956 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-10 14:52:39,961 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1300, 1301]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'PCBI', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 14:52:39,963 -[line:96] - INFO: deftAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'DEFT_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'DEFT_QTY': '$DEFT_QTY'}}, {'$match': {'MAIN_WC': {'$gt': 1050, '$lt': 1310}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'DeftSUMQty': {'$sum': {'$toInt': '$DEFT_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'PCBI', 'DeftSUMQty': '$DeftSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 14:52:40,518 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1355]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'LAM', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 14:52:40,519 -[line:96] - INFO: deftAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'DEFT_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'DEFT_QTY': '$DEFT_QTY'}}, {'$match': {'MAIN_WC': {'$gt': 1340, '$lt': 1399}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'DeftSUMQty': {'$sum': {'$toInt': '$DEFT_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'LAM', 'DeftSUMQty': '$DeftSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 14:52:41,034 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1420]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'AAFC', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 14:52:41,035 -[line:96] - INFO: deftAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'DEFT_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'DEFT_QTY': '$DEFT_QTY'}}, {'$match': {'MAIN_WC': {'$gt': 1400, '$lt': 1499}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'DeftSUMQty': {'$sum': {'$toInt': '$DEFT_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'AAFC', 'DeftSUMQty': '$DeftSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 14:52:41,579 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1600]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'CKEN', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 14:52:41,580 -[line:96] - INFO: deftAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'DEFT_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'DEFT_QTY': '$DEFT_QTY'}}, {'$match': {'MAIN_WC': {'$gt': 1500, '$lt': 1699}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'DeftSUMQty': {'$sum': {'$toInt': '$DEFT_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'CKEN', 'DeftSUMQty': '$DeftSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 14:52:42,122 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1600]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'DKEN', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 14:52:42,124 -[line:96] - INFO: deftAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'DEFT_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'DEFT_QTY': '$DEFT_QTY'}}, {'$match': {'MAIN_WC': {'$gt': 1700, '$lt': 1799}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'DeftSUMQty': {'$sum': {'$toInt': '$DEFT_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'DKEN', 'DeftSUMQty': '$DeftSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 14:57:43,023 -[line:96] - INFO: INTKPI __init__
2021-08-10 14:57:43,024 -[line:96] - INFO: INTKPI getData Start
2021-08-10 14:57:43,024 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-10 14:57:43,031 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1300, 1301]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'PCBI', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 14:57:43,032 -[line:96] - INFO: deftAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'DEFT_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'DEFT_QTY': '$DEFT_QTY'}}, {'$match': {'MAIN_WC': {'$gt': 1050, '$lt': 1310}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'DeftSUMQty': {'$sum': {'$toInt': '$DEFT_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'PCBI', 'DeftSUMQty': '$DeftSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 14:57:43,561 -[line:99] - ERROR: File:[D:\Project\source\dataproviderapi\GetINTKPI.py] , Line:426 , in _calFPYDataSum : [IndexError] list index out of range
2021-08-10 14:58:06,579 -[line:96] - INFO: INTKPI __init__
2021-08-10 14:58:06,579 -[line:96] - INFO: INTKPI getData Start
2021-08-10 14:58:06,580 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-10 14:58:06,586 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1300, 1301]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'PCBI', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 14:58:06,588 -[line:96] - INFO: deftAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'DEFT_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'DEFT_QTY': '$DEFT_QTY'}}, {'$match': {'MAIN_WC': {'$gt': 1050, '$lt': 1310}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'DeftSUMQty': {'$sum': {'$toInt': '$DEFT_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'PCBI', 'DeftSUMQty': '$DeftSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 14:58:07,128 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1355]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'LAM', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 14:58:07,129 -[line:96] - INFO: deftAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'DEFT_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'DEFT_QTY': '$DEFT_QTY'}}, {'$match': {'MAIN_WC': {'$gt': 1340, '$lt': 1399}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'DeftSUMQty': {'$sum': {'$toInt': '$DEFT_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'LAM', 'DeftSUMQty': '$DeftSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 14:58:07,634 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1420]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'AAFC', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 14:58:07,636 -[line:96] - INFO: deftAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'DEFT_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'DEFT_QTY': '$DEFT_QTY'}}, {'$match': {'MAIN_WC': {'$gt': 1400, '$lt': 1499}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'DeftSUMQty': {'$sum': {'$toInt': '$DEFT_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'AAFC', 'DeftSUMQty': '$DeftSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 14:58:08,139 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1600]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'CKEN', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 14:58:08,141 -[line:96] - INFO: deftAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'DEFT_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'DEFT_QTY': '$DEFT_QTY'}}, {'$match': {'MAIN_WC': {'$gt': 1500, '$lt': 1699}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'DeftSUMQty': {'$sum': {'$toInt': '$DEFT_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'CKEN', 'DeftSUMQty': '$DeftSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 14:58:08,654 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1600]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'DKEN', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 14:58:08,656 -[line:96] - INFO: deftAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'DEFT_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'DEFT_QTY': '$DEFT_QTY'}}, {'$match': {'MAIN_WC': {'$gt': 1700, '$lt': 1799}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'DeftSUMQty': {'$sum': {'$toInt': '$DEFT_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'DKEN', 'DeftSUMQty': '$DeftSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 15:04:15,987 -[line:96] - INFO: INTKPI __init__
2021-08-10 15:04:15,988 -[line:96] - INFO: INTKPI getData Start
2021-08-10 15:04:15,988 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-10 15:04:16,014 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1300, 1301]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'PCBI', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 15:04:16,577 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1355]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'LAM', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 15:04:17,082 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1420]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'AAFC', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 15:04:17,597 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1600]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'CKEN', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 15:04:18,106 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1600]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'DKEN', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 15:39:58,266 -[line:96] - INFO: INTKPI __init__
2021-08-10 15:39:58,327 -[line:96] - INFO: INTKPI getData Start
2021-08-10 15:39:58,328 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-10 15:39:58,381 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1300, 1301]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'PCBI', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 15:39:59,510 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1355]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'LAM', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 15:40:00,035 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1420]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'AAFC', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 15:40:00,571 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1600]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'CKEN', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 15:40:01,098 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1600]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'DKEN', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 15:45:47,405 -[line:96] - INFO: INTKPI __init__
2021-08-10 15:45:47,405 -[line:96] - INFO: INTKPI getData Start
2021-08-10 15:45:47,406 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-10 15:45:47,413 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1300, 1301]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'PCBI', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 15:45:47,951 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1355]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'LAM', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 15:45:48,473 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1420]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'AAFC', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 15:45:48,979 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1600]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'CKEN', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 15:45:49,490 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1600]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'DKEN', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 15:45:50,024 -[line:99] - ERROR: File:[D:\Project\source\dataproviderapi\GetINTKPI.py] , Line:434 , in _calFPYData : [KeyError] APPLICATION
2021-08-10 15:46:51,556 -[line:96] - INFO: INTKPI __init__
2021-08-10 15:46:51,556 -[line:96] - INFO: INTKPI getData Start
2021-08-10 15:46:51,556 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-10 15:46:51,562 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1300, 1301]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'PCBI', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 15:46:52,141 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1355]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'LAM', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 15:46:52,686 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1420]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'AAFC', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 15:46:53,198 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1600]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'CKEN', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 15:46:53,802 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1600]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'DKEN', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 15:46:54,351 -[line:99] - ERROR: File:[D:\Project\source\dataproviderapi\GetINTKPI.py] , Line:434 , in _calFPYData : [KeyError] APPLICATION
2021-08-10 15:50:29,795 -[line:96] - INFO: INTKPI __init__
2021-08-10 15:50:29,796 -[line:96] - INFO: INTKPI getData Start
2021-08-10 15:50:29,796 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-10 15:50:29,802 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1300, 1301]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'PCBI', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 15:50:30,331 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1355]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'LAM', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 15:50:30,863 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1420]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'AAFC', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 15:50:31,381 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1600]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'CKEN', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 15:50:31,933 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1600]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'DKEN', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 15:50:32,466 -[line:99] - ERROR: File:[D:\Project\source\dataproviderapi\GetINTKPI.py] , Line:434 , in _calFPYData : [KeyError] APPLICATION
2021-08-10 15:52:05,927 -[line:96] - INFO: INTKPI __init__
2021-08-10 15:52:05,928 -[line:96] - INFO: INTKPI getData Start
2021-08-10 15:52:05,928 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-10 15:52:05,982 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1300, 1301]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'PCBI', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 15:52:06,526 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1355]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'LAM', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 15:52:07,101 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1420]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'AAFC', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 15:52:07,640 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1600]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'CKEN', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 15:52:08,149 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1600]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'DKEN', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 15:52:08,673 -[line:99] - ERROR: File:[D:\Project\source\dataproviderapi\GetINTKPI.py] , Line:435 , in _calFPYData : [KeyError] APPLICATION
2021-08-10 15:53:35,829 -[line:96] - INFO: INTKPI __init__
2021-08-10 15:53:35,829 -[line:96] - INFO: INTKPI getData Start
2021-08-10 15:53:35,829 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-10 15:53:35,836 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1300, 1301]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'PCBI', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 15:53:36,383 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1355]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'LAM', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 15:53:36,933 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1420]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'AAFC', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 15:53:37,451 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1600]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'CKEN', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 15:53:38,017 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1600]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'DKEN', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 15:53:38,577 -[line:99] - ERROR: File:[D:\Project\source\dataproviderapi\GetINTKPI.py] , Line:434 , in _calFPYData : [TypeError] list indices must be integers or slices, not str
2021-08-10 16:03:07,607 -[line:96] - INFO: INTKPI __init__
2021-08-10 16:03:07,608 -[line:96] - INFO: INTKPI getData Start
2021-08-10 16:03:07,608 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-10 16:03:07,614 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1300, 1301]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'PCBI', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 16:03:08,164 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1355]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'LAM', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 16:03:08,745 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1420]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'AAFC', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 16:03:09,252 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1600]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'CKEN', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 16:03:09,844 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1600]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'DKEN', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 16:03:10,362 -[line:99] - ERROR: File:[D:\Project\source\dataproviderapi\GetINTKPI.py] , Line:435 , in _calFPYData : [KeyError] APPLICATION
2021-08-10 16:30:18,055 -[line:96] - INFO: INTKPI __init__
2021-08-10 16:30:18,056 -[line:96] - INFO: INTKPI getData Start
2021-08-10 16:30:18,056 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-10 16:30:18,063 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1300, 1301]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'PCBI', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 16:30:18,724 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1355]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'LAM', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 16:30:19,242 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1420]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'AAFC', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 16:30:19,754 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1600]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'CKEN', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 16:30:20,261 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1600]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'DKEN', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 16:30:20,782 -[line:99] - ERROR: File:[D:\Project\source\dataproviderapi\GetINTKPI.py] , Line:436 , in _calFPYData : [KeyError] APPLICATION
2021-08-10 16:32:22,233 -[line:96] - INFO: INTKPI __init__
2021-08-10 16:32:22,234 -[line:96] - INFO: INTKPI getData Start
2021-08-10 16:32:22,234 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-10 16:32:22,241 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1300, 1301]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'PCBI', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 16:32:22,791 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1355]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'LAM', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 16:32:23,308 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1420]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'AAFC', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 16:32:23,823 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1600]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'CKEN', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 16:32:24,343 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1600]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'DKEN', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 16:32:24,864 -[line:96] - INFO: {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'PROD_NBR': '2HE080IA1010S', 'ACCT_DATE': '2021-08-01', 'OPER': 'PCBI', 'PassSUMQty': 3, 'DeftSUMQty': 6, 'DEFECT_RATE': 2.0, 'FPY_RATE': -1.0}
2021-08-10 16:32:24,865 -[line:99] - ERROR: File:[D:\Project\source\dataproviderapi\GetINTKPI.py] , Line:437 , in _calFPYData : [KeyError] APPLICATION
2021-08-10 16:33:57,385 -[line:96] - INFO: INTKPI __init__
2021-08-10 16:33:57,386 -[line:96] - INFO: INTKPI getData Start
2021-08-10 16:33:57,386 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-10 16:33:57,413 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1300, 1301]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'PCBI', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 16:33:57,953 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1355]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'LAM', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 16:33:58,508 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1420]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'AAFC', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 16:33:59,022 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1600]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'CKEN', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 16:33:59,529 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1600]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'DKEN', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 16:34:00,050 -[line:96] - INFO: {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'PROD_NBR': '2HE080IA1010S', 'ACCT_DATE': '2021-08-01', 'APPLICATION': 'TABLET', 'OPER': 'PCBI', 'PassSUMQty': 3, 'DeftSUMQty': 6, 'DEFECT_RATE': 2.0, 'FPY_RATE': -1.0}
2021-08-10 16:34:00,094 -[line:96] - INFO: {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'PROD_NBR': 'GHD140ZB0000S', 'ACCT_DATE': '2021-08-01', 'APPLICATION': 'TABLET', 'OPER': 'PCBI', 'PassSUMQty': 1, 'DeftSUMQty': 1, 'DEFECT_RATE': 1.0, 'FPY_RATE': 0.0}
2021-08-10 16:34:00,095 -[line:99] - ERROR: File:[D:\Project\source\dataproviderapi\GetINTKPI.py] , Line:436 , in <lambda> : [TypeError] list indices must be integers or slices, not str
2021-08-10 16:36:50,600 -[line:96] - INFO: INTKPI __init__
2021-08-10 16:36:50,600 -[line:96] - INFO: INTKPI getData Start
2021-08-10 16:36:50,601 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-10 16:36:50,606 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1300, 1301]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'PCBI', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 16:36:51,146 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1355]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'LAM', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 16:36:51,673 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1420]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'AAFC', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 16:36:52,212 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1600]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'CKEN', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 16:36:52,727 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1600]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'DKEN', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 16:37:40,768 -[line:96] - INFO: INTKPI __init__
2021-08-10 16:37:40,768 -[line:96] - INFO: INTKPI getData Start
2021-08-10 16:37:40,770 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-10 16:37:40,779 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1300, 1301]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'PCBI', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 16:37:41,302 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1355]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'LAM', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 16:37:41,847 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1420]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'AAFC', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 16:37:42,394 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1600]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'CKEN', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 16:37:42,935 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1600]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'DKEN', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 16:37:43,452 -[line:99] - ERROR: File:[C:\Users\hsinyuan.lin\AppData\Local\Programs\Python\Python36\lib\json\encoder.py] , Line:180 , in default : [TypeError] Object of type 'set' is not JSON serializable
2021-08-10 16:37:59,896 -[line:96] - INFO: INTKPI __init__
2021-08-10 16:37:59,897 -[line:96] - INFO: INTKPI getData Start
2021-08-10 16:37:59,897 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-10 16:37:59,903 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1300, 1301]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'PCBI', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 16:38:01,369 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1355]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'LAM', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 16:38:03,110 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1420]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'AAFC', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 16:38:04,116 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1600]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'CKEN', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 16:38:04,660 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1600]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'DKEN', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 16:38:05,486 -[line:99] - ERROR: File:[C:\Users\hsinyuan.lin\AppData\Local\Programs\Python\Python36\lib\json\encoder.py] , Line:180 , in default : [TypeError] Object of type 'set' is not JSON serializable
2021-08-10 16:39:00,058 -[line:96] - INFO: INTKPI __init__
2021-08-10 16:39:00,058 -[line:96] - INFO: INTKPI getData Start
2021-08-10 16:39:00,059 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-10 16:39:00,065 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1300, 1301]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'PCBI', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 16:39:00,589 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1355]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'LAM', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 16:39:01,096 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1420]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'AAFC', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 16:39:01,612 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1600]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'CKEN', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 16:39:02,141 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1600]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'DKEN', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 16:39:02,652 -[line:96] - INFO: [{'2HE080IA1010S', 'TABLET'}, {'GHD140ZB0000S', 'TABLET'}, {'GP062CCAC100S', 'CE'}, {'GP062CCAY010S', 'CE'}, {'GP070BAGM050S', 'CE'}, {'GP080DZD00B0S', 'TABLET'}, {'GP130ZFA0010S', 'TABLET'}, {'GZD070SA4030S', 'CE'}, {'GZD080JAB010S', 'CE'}, {'GP080DZD00C0S', 'TABLET'}, {'GP104ZZD0220S', 'TABLET'}, {'GP104ZZD0240S', 'TABLET'}, {'GP130ZFZ1020S', 'TABLET'}, {'GP140ZKA0040S', 'TABLET'}, {'TABLET', 'GP140ZKA0060S'}, {'GZD070SA5010S', 'CE'}, {'CE', 'GNJ101IA0030S'}, {'GZJ101ZA3010S', 'CE'}]
2021-08-10 16:41:06,547 -[line:96] - INFO: INTKPI __init__
2021-08-10 16:41:06,547 -[line:96] - INFO: INTKPI getData Start
2021-08-10 16:41:06,548 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-10 16:41:06,554 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1300, 1301]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'PCBI', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 16:41:07,071 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1355]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'LAM', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 16:41:07,598 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1420]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'AAFC', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 16:41:08,147 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1600]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'CKEN', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 16:41:08,690 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1600]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'DKEN', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 16:41:09,202 -[line:96] - INFO: [{'2HE080IA1010S', 'TABLET'}, {'GHD140ZB0000S', 'TABLET'}, {'GP062CCAC100S', 'CE'}, {'GP062CCAY010S', 'CE'}, {'GP070BAGM050S', 'CE'}, {'GP080DZD00B0S', 'TABLET'}, {'GP130ZFA0010S', 'TABLET'}, {'GZD070SA4030S', 'CE'}, {'GZD080JAB010S', 'CE'}, {'GP080DZD00C0S', 'TABLET'}, {'GP104ZZD0220S', 'TABLET'}, {'GP104ZZD0240S', 'TABLET'}, {'GP130ZFZ1020S', 'TABLET'}, {'GP140ZKA0040S', 'TABLET'}, {'TABLET', 'GP140ZKA0060S'}, {'GZD070SA5010S', 'CE'}, {'CE', 'GNJ101IA0030S'}, {'GZJ101ZA3010S', 'CE'}]
2021-08-10 16:42:49,997 -[line:96] - INFO: INTKPI __init__
2021-08-10 16:42:49,998 -[line:96] - INFO: INTKPI getData Start
2021-08-10 16:42:49,998 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-10 16:42:50,004 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1300, 1301]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'PCBI', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 16:42:50,563 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1355]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'LAM', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 16:42:51,070 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1420]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'AAFC', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 16:42:51,583 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1600]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'CKEN', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 16:42:52,095 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1600]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'DKEN', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 16:42:52,625 -[line:96] - INFO: {'TABLET', '2HE080IA1010S'}
2021-08-10 16:42:52,625 -[line:96] - INFO: {'TABLET', 'GHD140ZB0000S'}
2021-08-10 16:42:52,625 -[line:96] - INFO: {'CE', 'GP062CCAC100S'}
2021-08-10 16:42:52,626 -[line:96] - INFO: {'GP062CCAY010S', 'CE'}
2021-08-10 16:42:52,626 -[line:96] - INFO: {'GP070BAGM050S', 'CE'}
2021-08-10 16:42:52,626 -[line:96] - INFO: {'GP080DZD00B0S', 'TABLET'}
2021-08-10 16:42:52,627 -[line:96] - INFO: {'GP130ZFA0010S', 'TABLET'}
2021-08-10 16:42:52,627 -[line:96] - INFO: {'GZD070SA4030S', 'CE'}
2021-08-10 16:42:52,627 -[line:96] - INFO: {'GZD080JAB010S', 'CE'}
2021-08-10 16:42:52,628 -[line:96] - INFO: {'TABLET', 'GP080DZD00C0S'}
2021-08-10 16:42:52,628 -[line:96] - INFO: {'GP104ZZD0220S', 'TABLET'}
2021-08-10 16:42:52,628 -[line:96] - INFO: {'GP104ZZD0240S', 'TABLET'}
2021-08-10 16:42:52,628 -[line:96] - INFO: {'GP130ZFZ1020S', 'TABLET'}
2021-08-10 16:42:52,629 -[line:96] - INFO: {'TABLET', 'GP140ZKA0040S'}
2021-08-10 16:42:52,629 -[line:96] - INFO: {'GP140ZKA0060S', 'TABLET'}
2021-08-10 16:42:52,629 -[line:96] - INFO: {'GZD070SA5010S', 'CE'}
2021-08-10 16:42:52,629 -[line:96] - INFO: {'GNJ101IA0030S', 'CE'}
2021-08-10 16:42:52,630 -[line:96] - INFO: {'GZJ101ZA3010S', 'CE'}
2021-08-10 16:45:27,567 -[line:96] - INFO: INTKPI __init__
2021-08-10 16:45:27,568 -[line:96] - INFO: INTKPI getData Start
2021-08-10 16:45:27,568 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-10 16:45:27,576 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1300, 1301]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'PCBI', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 16:45:28,129 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1355]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'LAM', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 16:45:28,661 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1420]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'AAFC', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 16:45:29,176 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1600]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'CKEN', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 16:45:29,680 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1600]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'DKEN', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 16:45:30,200 -[line:96] - INFO: [{'PROD_NBR': '2HE080IA1010S', 'APPLICATION': 'TABLET'}, {'PROD_NBR': 'GHD140ZB0000S', 'APPLICATION': 'TABLET'}, {'PROD_NBR': 'GP062CCAC100S', 'APPLICATION': 'CE'}, {'PROD_NBR': 'GP062CCAY010S', 'APPLICATION': 'CE'}, {'PROD_NBR': 'GP070BAGM050S', 'APPLICATION': 'CE'}, {'PROD_NBR': 'GP080DZD00B0S', 'APPLICATION': 'TABLET'}, {'PROD_NBR': 'GP130ZFA0010S', 'APPLICATION': 'TABLET'}, {'PROD_NBR': 'GZD070SA4030S', 'APPLICATION': 'CE'}, {'PROD_NBR': 'GZD080JAB010S', 'APPLICATION': 'CE'}, {'PROD_NBR': 'GHD140ZB0000S', 'APPLICATION': 'TABLET'}, {'PROD_NBR': 'GP080DZD00B0S', 'APPLICATION': 'TABLET'}, {'PROD_NBR': 'GZD070SA4030S', 'APPLICATION': 'CE'}, {'PROD_NBR': 'GHD140ZB0000S', 'APPLICATION': 'TABLET'}, {'PROD_NBR': 'GP062CCAC100S', 'APPLICATION': 'CE'}, {'PROD_NBR': 'GP062CCAY010S', 'APPLICATION': 'CE'}, {'PROD_NBR': 'GP070BAGM050S', 'APPLICATION': 'CE'}, {'PROD_NBR': 'GP080DZD00B0S', 'APPLICATION': 'TABLET'}, {'PROD_NBR': 'GP080DZD00C0S', 'APPLICATION': 'TABLET'}, {'PROD_NBR': 'GP104ZZD0220S', 'APPLICATION': 'TABLET'}, {'PROD_NBR': 'GP104ZZD0240S', 'APPLICATION': 'TABLET'}, {'PROD_NBR': 'GP130ZFA0010S', 'APPLICATION': 'TABLET'}, {'PROD_NBR': 'GP130ZFZ1020S', 'APPLICATION': 'TABLET'}, {'PROD_NBR': 'GP140ZKA0040S', 'APPLICATION': 'TABLET'}, {'PROD_NBR': 'GP140ZKA0060S', 'APPLICATION': 'TABLET'}, {'PROD_NBR': 'GZD070SA4030S', 'APPLICATION': 'CE'}, {'PROD_NBR': 'GZD070SA5010S', 'APPLICATION': 'CE'}, {'PROD_NBR': 'GNJ101IA0030S', 'APPLICATION': 'CE'}, {'PROD_NBR': 'GP062CCAC100S', 'APPLICATION': 'CE'}, {'PROD_NBR': 'GP062CCAY010S', 'APPLICATION': 'CE'}, {'PROD_NBR': 'GP070BAGM050S', 'APPLICATION': 'CE'}, {'PROD_NBR': 'GP080DZD00B0S', 'APPLICATION': 'TABLET'}, {'PROD_NBR': 'GP080DZD00C0S', 'APPLICATION': 'TABLET'}, {'PROD_NBR': 'GP130ZFA0010S', 'APPLICATION': 'TABLET'}, {'PROD_NBR': 'GP130ZFZ1020S', 'APPLICATION': 'TABLET'}, {'PROD_NBR': 'GP140ZKA0040S', 'APPLICATION': 'TABLET'}, {'PROD_NBR': 'GZD070SA4030S', 'APPLICATION': 'CE'}, {'PROD_NBR': 'GZD070SA5010S', 'APPLICATION': 'CE'}, {'PROD_NBR': 'GZJ101ZA3010S', 'APPLICATION': 'CE'}, {'PROD_NBR': 'GNJ101IA0030S', 'APPLICATION': 'CE'}, {'PROD_NBR': 'GP062CCAC100S', 'APPLICATION': 'CE'}, {'PROD_NBR': 'GP062CCAY010S', 'APPLICATION': 'CE'}, {'PROD_NBR': 'GP070BAGM050S', 'APPLICATION': 'CE'}, {'PROD_NBR': 'GP080DZD00B0S', 'APPLICATION': 'TABLET'}, {'PROD_NBR': 'GP080DZD00C0S', 'APPLICATION': 'TABLET'}, {'PROD_NBR': 'GP130ZFA0010S', 'APPLICATION': 'TABLET'}, {'PROD_NBR': 'GP130ZFZ1020S', 'APPLICATION': 'TABLET'}, {'PROD_NBR': 'GP140ZKA0040S', 'APPLICATION': 'TABLET'}, {'PROD_NBR': 'GZD070SA4030S', 'APPLICATION': 'CE'}, {'PROD_NBR': 'GZD070SA5010S', 'APPLICATION': 'CE'}, {'PROD_NBR': 'GZJ101ZA3010S', 'APPLICATION': 'CE'}]
2021-08-10 16:47:45,583 -[line:96] - INFO: INTKPI __init__
2021-08-10 16:47:45,583 -[line:96] - INFO: INTKPI getData Start
2021-08-10 16:47:45,584 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-10 16:47:45,589 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1300, 1301]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'PCBI', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 16:47:46,163 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1355]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'LAM', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 16:47:46,689 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1420]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'AAFC', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 16:47:47,207 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1600]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'CKEN', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 16:47:47,725 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1600]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'DKEN', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 16:51:51,793 -[line:96] - INFO: INTKPI __init__
2021-08-10 16:51:51,794 -[line:96] - INFO: INTKPI getData Start
2021-08-10 16:51:51,794 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-10 16:51:51,801 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1300, 1301]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'PCBI', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 16:51:52,365 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1355]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'LAM', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 16:51:52,879 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1420]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'AAFC', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 16:51:53,398 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1600]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'CKEN', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 16:51:53,907 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1600]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'DKEN', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 16:51:54,418 -[line:96] - INFO: {'PROD_NBR': '2HE080IA1010S', 'APPLICATION': 'TABLET'}
2021-08-10 16:51:54,419 -[line:96] - INFO: {'PROD_NBR': 'GHD140ZB0000S', 'APPLICATION': 'TABLET'}
2021-08-10 16:51:54,419 -[line:96] - INFO: {'PROD_NBR': 'GP062CCAC100S', 'APPLICATION': 'CE'}
2021-08-10 16:51:54,419 -[line:96] - INFO: {'PROD_NBR': 'GP062CCAY010S', 'APPLICATION': 'CE'}
2021-08-10 16:51:54,420 -[line:96] - INFO: {'PROD_NBR': 'GP070BAGM050S', 'APPLICATION': 'CE'}
2021-08-10 16:51:54,420 -[line:96] - INFO: {'PROD_NBR': 'GP080DZD00B0S', 'APPLICATION': 'TABLET'}
2021-08-10 16:51:54,420 -[line:96] - INFO: {'PROD_NBR': 'GP130ZFA0010S', 'APPLICATION': 'TABLET'}
2021-08-10 16:51:54,420 -[line:96] - INFO: {'PROD_NBR': 'GZD070SA4030S', 'APPLICATION': 'CE'}
2021-08-10 16:51:54,421 -[line:96] - INFO: {'PROD_NBR': 'GZD080JAB010S', 'APPLICATION': 'CE'}
2021-08-10 16:51:54,421 -[line:96] - INFO: {'PROD_NBR': 'GP080DZD00C0S', 'APPLICATION': 'TABLET'}
2021-08-10 16:51:54,421 -[line:96] - INFO: {'PROD_NBR': 'GP104ZZD0220S', 'APPLICATION': 'TABLET'}
2021-08-10 16:51:54,421 -[line:96] - INFO: {'PROD_NBR': 'GP104ZZD0240S', 'APPLICATION': 'TABLET'}
2021-08-10 16:51:54,422 -[line:96] - INFO: {'PROD_NBR': 'GP130ZFZ1020S', 'APPLICATION': 'TABLET'}
2021-08-10 16:51:54,422 -[line:96] - INFO: {'PROD_NBR': 'GP140ZKA0040S', 'APPLICATION': 'TABLET'}
2021-08-10 16:51:54,422 -[line:96] - INFO: {'PROD_NBR': 'GP140ZKA0060S', 'APPLICATION': 'TABLET'}
2021-08-10 16:51:54,422 -[line:96] - INFO: {'PROD_NBR': 'GZD070SA5010S', 'APPLICATION': 'CE'}
2021-08-10 16:51:54,423 -[line:96] - INFO: {'PROD_NBR': 'GNJ101IA0030S', 'APPLICATION': 'CE'}
2021-08-10 16:51:54,423 -[line:96] - INFO: {'PROD_NBR': 'GZJ101ZA3010S', 'APPLICATION': 'CE'}
2021-08-10 17:09:36,234 -[line:96] - INFO: INTKPI __init__
2021-08-10 17:09:36,234 -[line:96] - INFO: INTKPI getData Start
2021-08-10 17:09:36,235 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-10 17:09:36,241 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1300, 1301]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'PCBI', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 17:09:36,774 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1355]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'LAM', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 17:09:37,325 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1420]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'AAFC', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 17:09:37,833 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1600]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'CKEN', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 17:09:38,336 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1600]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'DKEN', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 17:09:38,852 -[line:99] - ERROR: File:[D:\Project\source\dataproviderapi\GetINTKPI.py] , Line:469 , in _calFPYData : [NameError] name 'LCM' is not defined
2021-08-10 17:57:59,459 -[line:96] - INFO: INTKPI __init__
2021-08-10 17:57:59,459 -[line:96] - INFO: INTKPI getData Start
2021-08-10 17:57:59,460 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-10 17:57:59,466 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1300, 1301]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'PCBI', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 17:58:00,016 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1355]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'LAM', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 17:58:00,530 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1420]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'AAFC', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 17:58:01,075 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1600]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'CKEN', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 17:58:01,641 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1600]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'DKEN', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 17:58:02,161 -[line:99] - ERROR: File:[D:\Project\source\dataproviderapi\GetINTKPI.py] , Line:469 , in _calFPYData : [NameError] name 'LCM' is not defined
2021-08-10 17:58:19,250 -[line:96] - INFO: INTKPI __init__
2021-08-10 17:58:19,251 -[line:96] - INFO: INTKPI getData Start
2021-08-10 17:58:19,251 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-10 17:58:19,258 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1300, 1301]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'PCBI', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 17:58:20,032 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1355]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'LAM', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 17:58:20,565 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1420]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'AAFC', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 17:58:21,078 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1600]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'CKEN', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 17:58:21,594 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1600]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'DKEN', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 17:59:29,819 -[line:96] - INFO: INTKPI __init__
2021-08-10 17:59:29,820 -[line:96] - INFO: INTKPI getData Start
2021-08-10 17:59:29,821 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-10 17:59:29,827 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1300, 1301]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'PCBI', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 17:59:30,413 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1355]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'LAM', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 17:59:30,951 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1420]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'AAFC', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 17:59:31,460 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1600]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'CKEN', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 17:59:31,974 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1600]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'DKEN', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 17:59:48,929 -[line:96] - INFO: INTKPI __init__
2021-08-10 17:59:48,930 -[line:96] - INFO: INTKPI getData Start
2021-08-10 17:59:48,930 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-10 17:59:48,948 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1300, 1301]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'PCBI', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 17:59:49,476 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1355]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'LAM', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 17:59:49,988 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1420]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'AAFC', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 17:59:50,500 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1600]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'CKEN', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 17:59:51,039 -[line:96] - INFO: passAggregate:[{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'PROCESS': '$PROCESS', 'APPLICATION': '$APPLICATION', 'MAIN_WC': {'$toInt': '$MAIN_WC'}}, 'PASS_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROCESS': '$_id.PROCESS', 'APPLICATION': '$_id.APPLICATION', 'MAIN_WC': '$_id.MAIN_WC', 'PASS_QTY': '$PASS_QTY'}}, {'$match': {'MAIN_WC': {'$in': [1600]}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION'}, 'PassSUMQty': {'$sum': {'$toInt': '$PASS_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'PROD_NBR': '$_id.PROD_NBR', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'OPER': 'DKEN', 'PassSUMQty': '$PassSUMQty'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'PROD_NBR': 1, 'ACCT_DATE': 1, 'MAIN_WC': 1, 'APPLICATION': 1}}]
2021-08-10 18:04:30,096 -[line:96] - INFO: INTKPI __init__
2021-08-10 18:04:30,097 -[line:96] - INFO: INTKPI getData Start
2021-08-10 18:04:30,097 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-10 18:10:28,461 -[line:96] - INFO: INTKPI __init__
2021-08-10 18:10:28,462 -[line:96] - INFO: INTKPI getData Start
2021-08-10 18:10:28,462 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-10 18:10:31,121 -[line:96] - INFO: {'"2HE080IA1010S"': {'APPLICATION': 'TABLET', 'PCBIFPY': -1.0, 'LAMFPY': 1, 'AAFCFPY': 1, 'CKENFPY': 1, 'DKENFPY': 1, 'FPY': -1.0}}
2021-08-10 18:10:31,122 -[line:96] - INFO: {'"GHD140ZB0000S"': {'APPLICATION': 'TABLET', 'PCBIFPY': 0.0, 'LAMFPY': 0.9045, 'AAFCFPY': 0.7727, 'CKENFPY': 1, 'DKENFPY': 1, 'FPY': 0.0}}
2021-08-10 18:10:31,122 -[line:96] - INFO: {'"GP062CCAC100S"': {'APPLICATION': 'CE', 'PCBIFPY': 0.9917, 'LAMFPY': 1, 'AAFCFPY': 0.9784, 'CKENFPY': 0.9253, 'DKENFPY': 1.0, 'FPY': 0.8978}}
2021-08-10 18:10:31,123 -[line:96] - INFO: {'"GP062CCAY010S"': {'APPLICATION': 'CE', 'PCBIFPY': 1.0, 'LAMFPY': 1, 'AAFCFPY': 0.97, 'CKENFPY': 0.9362, 'DKENFPY': 1.0, 'FPY': 0.9081}}
2021-08-10 18:10:31,123 -[line:96] - INFO: {'"GP070BAGM050S"': {'APPLICATION': 'CE', 'PCBIFPY': 0.9767, 'LAMFPY': 1, 'AAFCFPY': 0.9662, 'CKENFPY': 0.9761, 'DKENFPY': 1.0, 'FPY': 0.9211}}
2021-08-10 18:10:31,123 -[line:96] - INFO: {'"GP080DZD00B0S"': {'APPLICATION': 'TABLET', 'PCBIFPY': 0.9795, 'LAMFPY': 0.9543, 'AAFCFPY': 0.9744, 'CKENFPY': 0.9233, 'DKENFPY': 1.0, 'FPY': 0.8409}}
2021-08-10 18:10:31,124 -[line:96] - INFO: {'"GP130ZFA0010S"': {'APPLICATION': 'TABLET', 'PCBIFPY': 0.9868, 'LAMFPY': 1, 'AAFCFPY': 0.9439, 'CKENFPY': 0.9147, 'DKENFPY': 0.9348, 'FPY': 0.7964}}
2021-08-10 18:10:31,124 -[line:96] - INFO: {'"GZD070SA4030S"': {'APPLICATION': 'CE', 'PCBIFPY': 0.9978, 'LAMFPY': 0.9618, 'AAFCFPY': 0.9906, 'CKENFPY': 0.9262, 'DKENFPY': 1.0, 'FPY': 0.8805}}
2021-08-10 18:10:31,125 -[line:96] - INFO: {'"GZD080JAB010S"': {'APPLICATION': 'CE', 'PCBIFPY': 0.9748, 'LAMFPY': 1, 'AAFCFPY': 1, 'CKENFPY': 1, 'DKENFPY': 1, 'FPY': 0.9748}}
2021-08-10 18:10:31,125 -[line:96] - INFO: {'"GP080DZD00C0S"': {'APPLICATION': 'TABLET', 'PCBIFPY': 1, 'LAMFPY': 1, 'AAFCFPY': 0.9828, 'CKENFPY': 0.978, 'DKENFPY': 1.0, 'FPY': 0.9612}}
2021-08-10 18:10:31,125 -[line:96] - INFO: {'"GP104ZZD0220S"': {'APPLICATION': 'TABLET', 'PCBIFPY': 1, 'LAMFPY': 1, 'AAFCFPY': 1.0, 'CKENFPY': 1, 'DKENFPY': 1, 'FPY': 1.0}}
2021-08-10 18:10:31,126 -[line:96] - INFO: {'"GP104ZZD0240S"': {'APPLICATION': 'TABLET', 'PCBIFPY': 1, 'LAMFPY': 1, 'AAFCFPY': 0.9862, 'CKENFPY': 1, 'DKENFPY': 1, 'FPY': 0.9862}}
2021-08-10 18:10:31,126 -[line:96] - INFO: {'"GP130ZFZ1020S"': {'APPLICATION': 'TABLET', 'PCBIFPY': 1, 'LAMFPY': 1, 'AAFCFPY': 0.9048, 'CKENFPY': 0.9103, 'DKENFPY': 1.0, 'FPY': 0.8236}}
2021-08-10 18:10:31,126 -[line:96] - INFO: {'"GP140ZKA0040S"': {'APPLICATION': 'TABLET', 'PCBIFPY': 1, 'LAMFPY': 1, 'AAFCFPY': 0.7766, 'CKENFPY': 0.8, 'DKENFPY': 1.0, 'FPY': 0.6213}}
2021-08-10 18:10:31,127 -[line:96] - INFO: {'"GP140ZKA0060S"': {'APPLICATION': 'TABLET', 'PCBIFPY': 1, 'LAMFPY': 1, 'AAFCFPY': 0.8286, 'CKENFPY': 1, 'DKENFPY': 1, 'FPY': 0.8286}}
2021-08-10 18:10:31,127 -[line:96] - INFO: {'"GZD070SA5010S"': {'APPLICATION': 'CE', 'PCBIFPY': 1, 'LAMFPY': 1, 'AAFCFPY': 1.0, 'CKENFPY': 0.9561, 'DKENFPY': 1.0, 'FPY': 0.9561}}
2021-08-10 18:10:31,127 -[line:96] - INFO: {'"GNJ101IA0030S"': {'APPLICATION': 'CE', 'PCBIFPY': 1, 'LAMFPY': 1, 'AAFCFPY': 1, 'CKENFPY': 0.9697, 'DKENFPY': 1.0, 'FPY': 0.9697}}
2021-08-10 18:10:31,128 -[line:96] - INFO: {'"GZJ101ZA3010S"': {'APPLICATION': 'CE', 'PCBIFPY': 1, 'LAMFPY': 1, 'AAFCFPY': 1, 'CKENFPY': -1.0, 'DKENFPY': 1.0, 'FPY': -1.0}}
2021-08-10 18:11:05,607 -[line:96] - INFO: INTKPI __init__
2021-08-10 18:11:05,607 -[line:96] - INFO: INTKPI getData Start
2021-08-10 18:11:05,607 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-10 18:11:08,158 -[line:96] - INFO: {'2HE080IA1010S': {'APPLICATION': 'TABLET', 'PCBIFPY': -1.0, 'LAMFPY': 1, 'AAFCFPY': 1, 'CKENFPY': 1, 'DKENFPY': 1, 'FPY': -1.0}}
2021-08-10 18:11:08,158 -[line:96] - INFO: {'GHD140ZB0000S': {'APPLICATION': 'TABLET', 'PCBIFPY': 0.0, 'LAMFPY': 0.9045, 'AAFCFPY': 0.7727, 'CKENFPY': 1, 'DKENFPY': 1, 'FPY': 0.0}}
2021-08-10 18:11:08,159 -[line:96] - INFO: {'GP062CCAC100S': {'APPLICATION': 'CE', 'PCBIFPY': 0.9917, 'LAMFPY': 1, 'AAFCFPY': 0.9784, 'CKENFPY': 0.9253, 'DKENFPY': 1.0, 'FPY': 0.8978}}
2021-08-10 18:11:08,159 -[line:96] - INFO: {'GP062CCAY010S': {'APPLICATION': 'CE', 'PCBIFPY': 1.0, 'LAMFPY': 1, 'AAFCFPY': 0.97, 'CKENFPY': 0.9362, 'DKENFPY': 1.0, 'FPY': 0.9081}}
2021-08-10 18:11:08,159 -[line:96] - INFO: {'GP070BAGM050S': {'APPLICATION': 'CE', 'PCBIFPY': 0.9767, 'LAMFPY': 1, 'AAFCFPY': 0.9662, 'CKENFPY': 0.9761, 'DKENFPY': 1.0, 'FPY': 0.9211}}
2021-08-10 18:11:08,160 -[line:96] - INFO: {'GP080DZD00B0S': {'APPLICATION': 'TABLET', 'PCBIFPY': 0.9795, 'LAMFPY': 0.9543, 'AAFCFPY': 0.9744, 'CKENFPY': 0.9233, 'DKENFPY': 1.0, 'FPY': 0.8409}}
2021-08-10 18:11:08,160 -[line:96] - INFO: {'GP130ZFA0010S': {'APPLICATION': 'TABLET', 'PCBIFPY': 0.9868, 'LAMFPY': 1, 'AAFCFPY': 0.9439, 'CKENFPY': 0.9147, 'DKENFPY': 0.9348, 'FPY': 0.7964}}
2021-08-10 18:11:08,160 -[line:96] - INFO: {'GZD070SA4030S': {'APPLICATION': 'CE', 'PCBIFPY': 0.9978, 'LAMFPY': 0.9618, 'AAFCFPY': 0.9906, 'CKENFPY': 0.9262, 'DKENFPY': 1.0, 'FPY': 0.8805}}
2021-08-10 18:11:08,161 -[line:96] - INFO: {'GZD080JAB010S': {'APPLICATION': 'CE', 'PCBIFPY': 0.9748, 'LAMFPY': 1, 'AAFCFPY': 1, 'CKENFPY': 1, 'DKENFPY': 1, 'FPY': 0.9748}}
2021-08-10 18:11:08,161 -[line:96] - INFO: {'GP080DZD00C0S': {'APPLICATION': 'TABLET', 'PCBIFPY': 1, 'LAMFPY': 1, 'AAFCFPY': 0.9828, 'CKENFPY': 0.978, 'DKENFPY': 1.0, 'FPY': 0.9612}}
2021-08-10 18:11:08,161 -[line:96] - INFO: {'GP104ZZD0220S': {'APPLICATION': 'TABLET', 'PCBIFPY': 1, 'LAMFPY': 1, 'AAFCFPY': 1.0, 'CKENFPY': 1, 'DKENFPY': 1, 'FPY': 1.0}}
2021-08-10 18:11:08,162 -[line:96] - INFO: {'GP104ZZD0240S': {'APPLICATION': 'TABLET', 'PCBIFPY': 1, 'LAMFPY': 1, 'AAFCFPY': 0.9862, 'CKENFPY': 1, 'DKENFPY': 1, 'FPY': 0.9862}}
2021-08-10 18:11:08,162 -[line:96] - INFO: {'GP130ZFZ1020S': {'APPLICATION': 'TABLET', 'PCBIFPY': 1, 'LAMFPY': 1, 'AAFCFPY': 0.9048, 'CKENFPY': 0.9103, 'DKENFPY': 1.0, 'FPY': 0.8236}}
2021-08-10 18:11:08,162 -[line:96] - INFO: {'GP140ZKA0040S': {'APPLICATION': 'TABLET', 'PCBIFPY': 1, 'LAMFPY': 1, 'AAFCFPY': 0.7766, 'CKENFPY': 0.8, 'DKENFPY': 1.0, 'FPY': 0.6213}}
2021-08-10 18:11:08,163 -[line:96] - INFO: {'GP140ZKA0060S': {'APPLICATION': 'TABLET', 'PCBIFPY': 1, 'LAMFPY': 1, 'AAFCFPY': 0.8286, 'CKENFPY': 1, 'DKENFPY': 1, 'FPY': 0.8286}}
2021-08-10 18:11:08,163 -[line:96] - INFO: {'GZD070SA5010S': {'APPLICATION': 'CE', 'PCBIFPY': 1, 'LAMFPY': 1, 'AAFCFPY': 1.0, 'CKENFPY': 0.9561, 'DKENFPY': 1.0, 'FPY': 0.9561}}
2021-08-10 18:11:08,164 -[line:96] - INFO: {'GNJ101IA0030S': {'APPLICATION': 'CE', 'PCBIFPY': 1, 'LAMFPY': 1, 'AAFCFPY': 1, 'CKENFPY': 0.9697, 'DKENFPY': 1.0, 'FPY': 0.9697}}
2021-08-10 18:11:08,164 -[line:96] - INFO: {'GZJ101ZA3010S': {'APPLICATION': 'CE', 'PCBIFPY': 1, 'LAMFPY': 1, 'AAFCFPY': 1, 'CKENFPY': -1.0, 'DKENFPY': 1.0, 'FPY': -1.0}}
2021-08-10 18:18:08,344 -[line:96] - INFO: INTKPI __init__
2021-08-10 18:18:08,345 -[line:96] - INFO: INTKPI getData Start
2021-08-10 18:18:08,346 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-10 18:18:11,008 -[line:99] - ERROR: File:[D:\Project\source\dataproviderapi\GetINTKPI.py] , Line:517 , in _calFPYData : [KeyError] APPLICATION
2021-08-10 18:19:16,747 -[line:96] - INFO: INTKPI __init__
2021-08-10 18:19:16,748 -[line:96] - INFO: INTKPI getData Start
2021-08-10 18:19:16,748 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-10 18:19:19,430 -[line:99] - ERROR: File:[D:\Project\source\dataproviderapi\GetINTKPI.py] , Line:517 , in _calFPYData : [KeyError] 0
2021-08-10 18:20:04,867 -[line:96] - INFO: INTKPI __init__
2021-08-10 18:20:04,867 -[line:96] - INFO: INTKPI getData Start
2021-08-10 18:20:04,867 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-10 18:20:07,580 -[line:99] - ERROR: File:[D:\Project\source\dataproviderapi\GetINTKPI.py] , Line:517 , in _calFPYData : [KeyError] 0
2021-08-10 18:20:17,465 -[line:96] - INFO: INTKPI __init__
2021-08-10 18:20:17,466 -[line:96] - INFO: INTKPI getData Start
2021-08-10 18:20:17,466 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-10 18:20:20,067 -[line:99] - ERROR: File:[D:\Project\source\dataproviderapi\GetINTKPI.py] , Line:517 , in _calFPYData : [KeyError] 0
2021-08-10 18:20:48,554 -[line:96] - INFO: INTKPI __init__
2021-08-10 18:20:48,560 -[line:96] - INFO: INTKPI getData Start
2021-08-10 18:20:48,560 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-10 18:20:51,204 -[line:96] - INFO: {'2HE080IA1010S': {'APPLICATION': 'TABLET', 'PCBIFPY': -1.0, 'LAMFPY': 1, 'AAFCFPY': 1, 'CKENFPY': 1, 'DKENFPY': 1, 'FPY': -1.0}}
2021-08-10 18:20:51,206 -[line:99] - ERROR: File:[D:\Project\source\dataproviderapi\GetINTKPI.py] , Line:518 , in _calFPYData : [KeyError] 0
2021-08-10 18:21:56,020 -[line:96] - INFO: INTKPI __init__
2021-08-10 18:21:56,020 -[line:96] - INFO: INTKPI getData Start
2021-08-10 18:21:56,021 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-10 18:21:58,684 -[line:96] - INFO: {'PROD_NBR': '2HE080IA1010S', 'APPLICATION': 'TABLET', 'PCBIFPY': -1.0, 'LAMFPY': 1, 'AAFCFPY': 1, 'CKENFPY': 1, 'DKENFPY': 1, 'FPY': -1.0}
2021-08-10 18:21:58,686 -[line:99] - ERROR: File:[D:\Project\source\dataproviderapi\GetINTKPI.py] , Line:520 , in _calFPYData : [KeyError] 0
2021-08-10 18:22:23,342 -[line:96] - INFO: INTKPI __init__
2021-08-10 18:22:23,343 -[line:96] - INFO: INTKPI getData Start
2021-08-10 18:22:23,343 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-10 18:22:25,939 -[line:96] - INFO: {'PROD_NBR': '2HE080IA1010S', 'APPLICATION': 'TABLET', 'PCBIFPY': -1.0, 'LAMFPY': 1, 'AAFCFPY': 1, 'CKENFPY': 1, 'DKENFPY': 1, 'FPY': -1.0}
2021-08-10 18:22:25,940 -[line:99] - ERROR: File:[D:\Project\source\dataproviderapi\GetINTKPI.py] , Line:520 , in _calFPYData : [KeyError] TABLET
2021-08-10 18:23:17,374 -[line:96] - INFO: INTKPI __init__
2021-08-10 18:23:17,375 -[line:96] - INFO: INTKPI getData Start
2021-08-10 18:23:17,375 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-10 18:23:20,100 -[line:96] - INFO: {'CE': {'qytlim': '3000', 'FPY': '0.95'}, 'Tablet': {'qytlim': '3000', 'FPY': '0.90'}, 'NB': {'qytlim': '3000', 'FPY': '0.94'}}
2021-08-10 18:23:20,100 -[line:96] - INFO: TABLET
2021-08-10 18:23:20,101 -[line:99] - ERROR: File:[D:\Project\source\dataproviderapi\GetINTKPI.py] , Line:521 , in _calFPYData : [KeyError] TABLET
2021-08-10 18:25:05,145 -[line:96] - INFO: INTKPI __init__
2021-08-10 18:25:05,145 -[line:96] - INFO: INTKPI getData Start
2021-08-10 18:25:05,145 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-10 18:25:07,863 -[line:99] - ERROR: File:[D:\Project\source\dataproviderapi\GetINTKPI.py] , Line:519 , in _calFPYData : [KeyError] TABLE
2021-08-10 18:26:05,460 -[line:96] - INFO: INTKPI __init__
2021-08-10 18:26:05,461 -[line:96] - INFO: INTKPI getData Start
2021-08-10 18:26:05,461 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-10 18:26:08,206 -[line:99] - ERROR: File:[D:\Project\source\dataproviderapi\GetINTKPI.py] , Line:519 , in _calFPYData : [KeyError] TABLET
2021-08-10 18:28:15,244 -[line:96] - INFO: INTKPI __init__
2021-08-10 18:28:15,245 -[line:96] - INFO: INTKPI getData Start
2021-08-10 18:28:15,245 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-10 18:28:17,878 -[line:96] - INFO: TABLET
2021-08-10 18:28:17,878 -[line:96] - INFO: TABLET
2021-08-10 18:28:17,878 -[line:96] - INFO: CE
2021-08-10 18:28:17,879 -[line:96] - INFO: CE
2021-08-10 18:28:17,879 -[line:96] - INFO: CE
2021-08-10 18:28:17,879 -[line:96] - INFO: TABLET
2021-08-10 18:28:17,879 -[line:96] - INFO: TABLET
2021-08-10 18:28:17,880 -[line:96] - INFO: CE
2021-08-10 18:28:17,880 -[line:96] - INFO: CE
2021-08-10 18:28:17,880 -[line:96] - INFO: TABLET
2021-08-10 18:28:17,880 -[line:96] - INFO: TABLET
2021-08-10 18:28:17,881 -[line:96] - INFO: TABLET
2021-08-10 18:28:17,881 -[line:96] - INFO: TABLET
2021-08-10 18:28:17,881 -[line:96] - INFO: TABLET
2021-08-10 18:28:17,881 -[line:96] - INFO: TABLET
2021-08-10 18:28:17,881 -[line:96] - INFO: CE
2021-08-10 18:28:17,882 -[line:96] - INFO: CE
2021-08-10 18:28:17,882 -[line:96] - INFO: CE
2021-08-10 18:29:05,099 -[line:96] - INFO: INTKPI __init__
2021-08-10 18:29:05,099 -[line:96] - INFO: INTKPI getData Start
2021-08-10 18:29:05,100 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-10 18:29:07,785 -[line:96] - INFO: 0.90
2021-08-10 18:29:07,786 -[line:99] - ERROR: File:[D:\Project\source\dataproviderapi\GetINTKPI.py] , Line:521 , in _calFPYData : [TypeError] '>=' not supported between instances of 'float' and 'str'
2021-08-10 18:30:19,101 -[line:96] - INFO: INTKPI __init__
2021-08-10 18:30:19,101 -[line:96] - INFO: INTKPI getData Start
2021-08-10 18:30:19,101 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-10 18:30:21,721 -[line:96] - INFO: 0.9
2021-08-10 18:30:21,722 -[line:96] - INFO: 0.9
2021-08-10 18:30:21,722 -[line:96] - INFO: 0.95
2021-08-10 18:30:21,723 -[line:96] - INFO: 0.95
2021-08-10 18:30:21,723 -[line:96] - INFO: 0.95
2021-08-10 18:30:21,723 -[line:96] - INFO: 0.9
2021-08-10 18:30:21,723 -[line:96] - INFO: 0.9
2021-08-10 18:30:21,724 -[line:96] - INFO: 0.95
2021-08-10 18:30:21,724 -[line:96] - INFO: 0.95
2021-08-10 18:30:21,724 -[line:96] - INFO: 0.9
2021-08-10 18:30:21,724 -[line:96] - INFO: 0.9
2021-08-10 18:30:21,725 -[line:96] - INFO: 0.9
2021-08-10 18:30:21,725 -[line:96] - INFO: 0.9
2021-08-10 18:30:21,725 -[line:96] - INFO: 0.9
2021-08-10 18:30:21,725 -[line:96] - INFO: 0.9
2021-08-10 18:30:21,725 -[line:96] - INFO: 0.95
2021-08-10 18:30:21,726 -[line:96] - INFO: 0.95
2021-08-10 18:30:21,726 -[line:96] - INFO: 0.95
2021-08-10 18:31:11,947 -[line:96] - INFO: INTKPI __init__
2021-08-10 18:31:11,947 -[line:96] - INFO: INTKPI getData Start
2021-08-10 18:31:11,948 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-10 18:31:14,517 -[line:96] - INFO: 0.9
2021-08-10 18:31:14,518 -[line:96] - INFO: 0.9
2021-08-10 18:31:14,518 -[line:96] - INFO: 0.95
2021-08-10 18:31:14,519 -[line:96] - INFO: 0.95
2021-08-10 18:31:14,519 -[line:96] - INFO: 0.95
2021-08-10 18:31:14,519 -[line:96] - INFO: 0.9
2021-08-10 18:31:14,519 -[line:96] - INFO: 0.9
2021-08-10 18:31:14,520 -[line:96] - INFO: 0.95
2021-08-10 18:31:14,520 -[line:96] - INFO: 0.95
2021-08-10 18:31:14,520 -[line:96] - INFO: 0.9
2021-08-10 18:31:14,520 -[line:96] - INFO: 0.9
2021-08-10 18:31:14,521 -[line:96] - INFO: 0.9
2021-08-10 18:31:14,521 -[line:96] - INFO: 0.9
2021-08-10 18:31:14,521 -[line:96] - INFO: 0.9
2021-08-10 18:31:14,521 -[line:96] - INFO: 0.9
2021-08-10 18:31:14,522 -[line:96] - INFO: 0.95
2021-08-10 18:31:14,522 -[line:96] - INFO: 0.95
2021-08-10 18:31:14,522 -[line:96] - INFO: 0.95
2021-08-10 18:34:01,528 -[line:96] - INFO: INTKPI __init__
2021-08-10 18:34:01,528 -[line:96] - INFO: INTKPI getData Start
2021-08-10 18:34:01,529 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-10 18:34:04,254 -[line:96] - INFO: 0.9
2021-08-10 18:34:04,254 -[line:96] - INFO: 0.9
2021-08-10 18:34:04,254 -[line:96] - INFO: 0.95
2021-08-10 18:34:04,255 -[line:96] - INFO: 0.95
2021-08-10 18:34:04,255 -[line:96] - INFO: 0.95
2021-08-10 18:34:04,255 -[line:96] - INFO: 0.9
2021-08-10 18:34:04,255 -[line:96] - INFO: 0.9
2021-08-10 18:34:04,255 -[line:96] - INFO: 0.95
2021-08-10 18:34:04,256 -[line:96] - INFO: 0.95
2021-08-10 18:34:04,256 -[line:96] - INFO: 0.9
2021-08-10 18:34:04,256 -[line:96] - INFO: 0.9
2021-08-10 18:34:04,256 -[line:96] - INFO: 0.9
2021-08-10 18:34:04,257 -[line:96] - INFO: 0.9
2021-08-10 18:34:04,257 -[line:96] - INFO: 0.9
2021-08-10 18:34:04,257 -[line:96] - INFO: 0.9
2021-08-10 18:34:04,257 -[line:96] - INFO: 0.95
2021-08-10 18:34:04,258 -[line:96] - INFO: 0.95
2021-08-10 18:34:04,258 -[line:96] - INFO: 0.95
2021-08-10 18:53:55,162 -[line:96] - INFO: INTKPI __init__
2021-08-10 18:53:55,188 -[line:96] - INFO: INTKPI getData Start
2021-08-10 18:53:55,188 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-10 18:53:57,867 -[line:96] - INFO: 0.9
2021-08-10 18:53:57,867 -[line:96] - INFO: 0.9
2021-08-10 18:53:57,868 -[line:96] - INFO: 0.95
2021-08-10 18:53:57,868 -[line:96] - INFO: 0.95
2021-08-10 18:53:57,868 -[line:96] - INFO: 0.95
2021-08-10 18:53:57,868 -[line:96] - INFO: 0.9
2021-08-10 18:53:57,869 -[line:96] - INFO: 0.9
2021-08-10 18:53:57,869 -[line:96] - INFO: 0.95
2021-08-10 18:53:57,869 -[line:96] - INFO: 0.95
2021-08-10 18:53:57,869 -[line:96] - INFO: 0.9
2021-08-10 18:53:57,870 -[line:96] - INFO: 0.9
2021-08-10 18:53:57,870 -[line:96] - INFO: 0.9
2021-08-10 18:53:57,870 -[line:96] - INFO: 0.9
2021-08-10 18:53:57,870 -[line:96] - INFO: 0.9
2021-08-10 18:53:57,871 -[line:96] - INFO: 0.9
2021-08-10 18:53:57,871 -[line:96] - INFO: 0.95
2021-08-10 18:53:57,871 -[line:96] - INFO: 0.95
2021-08-10 18:53:57,872 -[line:96] - INFO: 0.95
2021-08-10 18:53:57,897 -[line:99] - ERROR: File:[C:\Users\hsinyuan.lin\AppData\Local\Programs\Python\Python36\lib\json\__init__.py] , Line:348 , in loads : [TypeError] the JSON object must be str, bytes or bytearray, not 'dict'
2021-08-11 08:15:42,618 -[line:96] - INFO: INTKPI __init__
2021-08-11 08:15:42,628 -[line:96] - INFO: INTKPI getData Start
2021-08-11 08:15:42,628 -[line:96] - INFO: Input Json:{'KPITYPE': 'FPY', 'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'THEME': 'light1', 'ACCT_DATE': '20210810', 'animationEnabled': True, 'pageId': 'INT_TEST', 'LEVELNAME': 'TN-MOD2'}
2021-08-11 08:15:42,647 -[line:96] - INFO: Cache Data From Redis
2021-08-11 08:16:48,723 -[line:96] - INFO: INTKPI __init__
2021-08-11 08:16:48,724 -[line:96] - INFO: INTKPI getData Start
2021-08-11 08:16:48,724 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-11 08:16:51,470 -[line:96] - INFO: 0.9
2021-08-11 08:16:51,470 -[line:96] - INFO: 0.9
2021-08-11 08:16:51,470 -[line:96] - INFO: 0.95
2021-08-11 08:16:51,471 -[line:96] - INFO: 0.95
2021-08-11 08:16:51,471 -[line:96] - INFO: 0.95
2021-08-11 08:16:51,471 -[line:96] - INFO: 0.9
2021-08-11 08:16:51,471 -[line:96] - INFO: 0.9
2021-08-11 08:16:51,472 -[line:96] - INFO: 0.95
2021-08-11 08:16:51,472 -[line:96] - INFO: 0.95
2021-08-11 08:16:51,472 -[line:96] - INFO: 0.9
2021-08-11 08:16:51,472 -[line:96] - INFO: 0.9
2021-08-11 08:16:51,473 -[line:96] - INFO: 0.9
2021-08-11 08:16:51,473 -[line:96] - INFO: 0.9
2021-08-11 08:16:51,473 -[line:96] - INFO: 0.9
2021-08-11 08:16:51,473 -[line:96] - INFO: 0.9
2021-08-11 08:16:51,474 -[line:96] - INFO: 0.95
2021-08-11 08:16:51,474 -[line:96] - INFO: 0.95
2021-08-11 08:16:51,474 -[line:96] - INFO: 0.95
2021-08-11 08:22:45,050 -[line:96] - INFO: INTKPI __init__
2021-08-11 08:22:45,050 -[line:96] - INFO: INTKPI getData Start
2021-08-11 08:22:45,050 -[line:96] - INFO: Input Json:{'KPITYPE': 'FPY', 'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'THEME': 'light1', 'ACCT_DATE': '20210810', 'animationEnabled': True, 'pageId': 'INT_TEST', 'LEVELNAME': 'TN-MOD2'}
2021-08-11 08:22:47,682 -[line:96] - INFO: 0.9
2021-08-11 08:22:47,682 -[line:96] - INFO: 0.9
2021-08-11 08:22:47,682 -[line:96] - INFO: 0.95
2021-08-11 08:22:47,682 -[line:96] - INFO: 0.94
2021-08-11 08:22:47,682 -[line:96] - INFO: 0.94
2021-08-11 08:22:47,682 -[line:96] - INFO: 0.95
2021-08-11 08:22:47,682 -[line:96] - INFO: 0.9
2021-08-11 08:22:47,682 -[line:96] - INFO: 0.9
2021-08-11 08:22:47,682 -[line:96] - INFO: 0.9
2021-08-11 08:22:47,682 -[line:96] - INFO: 0.9
2021-08-11 08:22:47,682 -[line:96] - INFO: 0.95
2021-08-11 08:22:47,682 -[line:96] - INFO: 0.95
2021-08-11 08:22:47,682 -[line:96] - INFO: 0.9
2021-08-11 08:22:47,682 -[line:96] - INFO: 0.95
2021-08-11 08:22:47,682 -[line:96] - INFO: 0.95
2021-08-11 08:22:47,682 -[line:96] - INFO: 0.9
2021-08-11 08:22:47,682 -[line:96] - INFO: 0.95
2021-08-11 08:22:47,682 -[line:96] - INFO: 0.95
2021-08-11 08:23:23,723 -[line:96] - INFO: INTKPI __init__
2021-08-11 08:23:23,724 -[line:96] - INFO: INTKPI getData Start
2021-08-11 08:23:23,725 -[line:96] - INFO: Input Json:{'KPITYPE': 'FPY', 'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'THEME': 'light1', 'ACCT_DATE': '20210810', 'animationEnabled': True, 'pageId': 'INT_TEST', 'LEVELNAME': 'TN-MOD2'}
2021-08-11 08:23:23,731 -[line:96] - INFO: Cache Data From Redis
2021-08-11 08:34:05,205 -[line:96] - INFO: INTKPI __init__
2021-08-11 08:34:05,205 -[line:96] - INFO: INTKPI getData Start
2021-08-11 08:34:05,206 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-11 08:34:07,889 -[line:96] - INFO: {'PROD_NBR': '2HE080IA1010S', 'APPLICATION': 'TABLET', 'PCBIFPY': -1.0, 'LAMFPY': 1, 'AAFCFPY': 1, 'CKENFPY': 1, 'DKENFPY': 1, 'FPY': -1.0}
2021-08-11 08:34:07,890 -[line:96] - INFO: 0.9
2021-08-11 08:34:07,890 -[line:96] - INFO: {'PROD_NBR': 'GHD140ZB0000S', 'APPLICATION': 'TABLET', 'PCBIFPY': 0.0, 'LAMFPY': 0.9045, 'AAFCFPY': 0.7727, 'CKENFPY': 1, 'DKENFPY': 1, 'FPY': 0.0}
2021-08-11 08:34:07,891 -[line:96] - INFO: 0.9
2021-08-11 08:34:07,891 -[line:96] - INFO: {'PROD_NBR': 'GP062CCAC100S', 'APPLICATION': 'CE', 'PCBIFPY': 0.9917, 'LAMFPY': 1, 'AAFCFPY': 0.9784, 'CKENFPY': 0.9253, 'DKENFPY': 1.0, 'FPY': 0.8978}
2021-08-11 08:34:07,891 -[line:96] - INFO: 0.95
2021-08-11 08:34:07,891 -[line:96] - INFO: {'PROD_NBR': 'GP062CCAY010S', 'APPLICATION': 'CE', 'PCBIFPY': 1.0, 'LAMFPY': 1, 'AAFCFPY': 0.97, 'CKENFPY': 0.9362, 'DKENFPY': 1.0, 'FPY': 0.9081}
2021-08-11 08:34:07,892 -[line:96] - INFO: 0.95
2021-08-11 08:34:07,893 -[line:96] - INFO: {'PROD_NBR': 'GP070BAGM050S', 'APPLICATION': 'CE', 'PCBIFPY': 0.9767, 'LAMFPY': 1, 'AAFCFPY': 0.9662, 'CKENFPY': 0.9761, 'DKENFPY': 1.0, 'FPY': 0.9211}
2021-08-11 08:34:07,893 -[line:96] - INFO: 0.95
2021-08-11 08:34:07,893 -[line:96] - INFO: {'PROD_NBR': 'GP080DZD00B0S', 'APPLICATION': 'TABLET', 'PCBIFPY': 0.9795, 'LAMFPY': 0.9543, 'AAFCFPY': 0.9744, 'CKENFPY': 0.9233, 'DKENFPY': 1.0, 'FPY': 0.8409}
2021-08-11 08:34:07,894 -[line:96] - INFO: 0.9
2021-08-11 08:34:07,894 -[line:96] - INFO: {'PROD_NBR': 'GP130ZFA0010S', 'APPLICATION': 'TABLET', 'PCBIFPY': 0.9868, 'LAMFPY': 1, 'AAFCFPY': 0.9439, 'CKENFPY': 0.9147, 'DKENFPY': 0.9348, 'FPY': 0.7964}
2021-08-11 08:34:07,895 -[line:96] - INFO: 0.9
2021-08-11 08:34:07,895 -[line:96] - INFO: {'PROD_NBR': 'GZD070SA4030S', 'APPLICATION': 'CE', 'PCBIFPY': 0.9978, 'LAMFPY': 0.9618, 'AAFCFPY': 0.9906, 'CKENFPY': 0.9262, 'DKENFPY': 1.0, 'FPY': 0.8805}
2021-08-11 08:34:07,895 -[line:96] - INFO: 0.95
2021-08-11 08:34:07,895 -[line:96] - INFO: {'PROD_NBR': 'GZD080JAB010S', 'APPLICATION': 'CE', 'PCBIFPY': 0.9748, 'LAMFPY': 1, 'AAFCFPY': 1, 'CKENFPY': 1, 'DKENFPY': 1, 'FPY': 0.9748}
2021-08-11 08:34:07,896 -[line:96] - INFO: 0.95
2021-08-11 08:34:07,896 -[line:96] - INFO: {'PROD_NBR': 'GP080DZD00C0S', 'APPLICATION': 'TABLET', 'PCBIFPY': 1, 'LAMFPY': 1, 'AAFCFPY': 0.9828, 'CKENFPY': 0.978, 'DKENFPY': 1.0, 'FPY': 0.9612}
2021-08-11 08:34:07,896 -[line:96] - INFO: 0.9
2021-08-11 08:34:07,897 -[line:96] - INFO: {'PROD_NBR': 'GP104ZZD0220S', 'APPLICATION': 'TABLET', 'PCBIFPY': 1, 'LAMFPY': 1, 'AAFCFPY': 1.0, 'CKENFPY': 1, 'DKENFPY': 1, 'FPY': 1.0}
2021-08-11 08:34:07,897 -[line:96] - INFO: 0.9
2021-08-11 08:34:07,897 -[line:96] - INFO: {'PROD_NBR': 'GP104ZZD0240S', 'APPLICATION': 'TABLET', 'PCBIFPY': 1, 'LAMFPY': 1, 'AAFCFPY': 0.9862, 'CKENFPY': 1, 'DKENFPY': 1, 'FPY': 0.9862}
2021-08-11 08:34:07,898 -[line:96] - INFO: 0.9
2021-08-11 08:34:07,898 -[line:96] - INFO: {'PROD_NBR': 'GP130ZFZ1020S', 'APPLICATION': 'TABLET', 'PCBIFPY': 1, 'LAMFPY': 1, 'AAFCFPY': 0.9048, 'CKENFPY': 0.9103, 'DKENFPY': 1.0, 'FPY': 0.8236}
2021-08-11 08:34:07,898 -[line:96] - INFO: 0.9
2021-08-11 08:34:07,898 -[line:96] - INFO: {'PROD_NBR': 'GP140ZKA0040S', 'APPLICATION': 'TABLET', 'PCBIFPY': 1, 'LAMFPY': 1, 'AAFCFPY': 0.7766, 'CKENFPY': 0.8, 'DKENFPY': 1.0, 'FPY': 0.6213}
2021-08-11 08:34:07,899 -[line:96] - INFO: 0.9
2021-08-11 08:34:07,899 -[line:96] - INFO: {'PROD_NBR': 'GP140ZKA0060S', 'APPLICATION': 'TABLET', 'PCBIFPY': 1, 'LAMFPY': 1, 'AAFCFPY': 0.8286, 'CKENFPY': 1, 'DKENFPY': 1, 'FPY': 0.8286}
2021-08-11 08:34:07,899 -[line:96] - INFO: 0.9
2021-08-11 08:34:07,899 -[line:96] - INFO: {'PROD_NBR': 'GZD070SA5010S', 'APPLICATION': 'CE', 'PCBIFPY': 1, 'LAMFPY': 1, 'AAFCFPY': 1.0, 'CKENFPY': 0.9561, 'DKENFPY': 1.0, 'FPY': 0.9561}
2021-08-11 08:34:07,900 -[line:96] - INFO: 0.95
2021-08-11 08:34:07,900 -[line:96] - INFO: {'PROD_NBR': 'GNJ101IA0030S', 'APPLICATION': 'CE', 'PCBIFPY': 1, 'LAMFPY': 1, 'AAFCFPY': 1, 'CKENFPY': 0.9697, 'DKENFPY': 1.0, 'FPY': 0.9697}
2021-08-11 08:34:07,900 -[line:96] - INFO: 0.95
2021-08-11 08:34:07,901 -[line:96] - INFO: {'PROD_NBR': 'GZJ101ZA3010S', 'APPLICATION': 'CE', 'PCBIFPY': 1, 'LAMFPY': 1, 'AAFCFPY': 1, 'CKENFPY': -1.0, 'DKENFPY': 1.0, 'FPY': -1.0}
2021-08-11 08:34:07,901 -[line:96] - INFO: 0.95
2021-08-11 08:36:20,913 -[line:96] - INFO: INTKPI __init__
2021-08-11 08:36:20,913 -[line:96] - INFO: INTKPI getData Start
2021-08-11 08:36:20,914 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-11 08:36:23,659 -[line:96] - INFO: -1.0 * 1 * 1 * 1 * 1 = -1.0
2021-08-11 08:36:23,659 -[line:96] - INFO: 0.0 * 0.9045 * 0.7727 * 1 * 1 = 0.0
2021-08-11 08:36:23,660 -[line:96] - INFO: 0.9917 * 1 * 0.9784 * 0.9253 * 1.0 = 0.8978
2021-08-11 08:36:23,660 -[line:96] - INFO: 1.0 * 1 * 0.97 * 0.9362 * 1.0 = 0.9081
2021-08-11 08:36:23,660 -[line:96] - INFO: 0.9767 * 1 * 0.9662 * 0.9761 * 1.0 = 0.9211
2021-08-11 08:36:23,661 -[line:96] - INFO: 0.9795 * 0.9543 * 0.9744 * 0.9233 * 1.0 = 0.8409
2021-08-11 08:36:23,661 -[line:96] - INFO: 0.9868 * 1 * 0.9439 * 0.9147 * 0.9348 = 0.7964
2021-08-11 08:36:23,662 -[line:96] - INFO: 0.9978 * 0.9618 * 0.9906 * 0.9262 * 1.0 = 0.8805
2021-08-11 08:36:23,662 -[line:96] - INFO: 0.9748 * 1 * 1 * 1 * 1 = 0.9748
2021-08-11 08:36:23,662 -[line:96] - INFO: 1 * 1 * 0.9828 * 0.978 * 1.0 = 0.9612
2021-08-11 08:36:23,663 -[line:96] - INFO: 1 * 1 * 1.0 * 1 * 1 = 1.0
2021-08-11 08:36:23,663 -[line:96] - INFO: 1 * 1 * 0.9862 * 1 * 1 = 0.9862
2021-08-11 08:36:23,663 -[line:96] - INFO: 1 * 1 * 0.9048 * 0.9103 * 1.0 = 0.8236
2021-08-11 08:36:23,664 -[line:96] - INFO: 1 * 1 * 0.7766 * 0.8 * 1.0 = 0.6213
2021-08-11 08:36:23,664 -[line:96] - INFO: 1 * 1 * 0.8286 * 1 * 1 = 0.8286
2021-08-11 08:36:23,664 -[line:96] - INFO: 1 * 1 * 1.0 * 0.9561 * 1.0 = 0.9561
2021-08-11 08:36:23,665 -[line:96] - INFO: 1 * 1 * 1 * 0.9697 * 1.0 = 0.9697
2021-08-11 08:36:23,665 -[line:96] - INFO: 1 * 1 * 1 * -1.0 * 1.0 = -1.0
2021-08-11 08:38:50,931 -[line:96] - INFO: INTKPI __init__
2021-08-11 08:38:50,931 -[line:96] - INFO: INTKPI getData Start
2021-08-11 08:38:50,931 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-11 08:38:53,541 -[line:96] - INFO: [{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'PROD_NBR': '2HE080IA1010S', 'ACCT_DATE': '2021-08-01', 'APPLICATION': 'TABLET', 'OPER': 'PCBI', 'PassSUMQty': 3, 'DeftSUMQty': 6, 'DEFECT_RATE': 2.0, 'FPY_RATE': -1.0}]
2021-08-11 08:38:53,541 -[line:96] - INFO: -1.0 * 1 * 1 * 1 * 1 = -1.0
2021-08-11 08:38:53,542 -[line:96] - INFO: [{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'PROD_NBR': 'GHD140ZB0000S', 'ACCT_DATE': '2021-08-01', 'APPLICATION': 'TABLET', 'OPER': 'PCBI', 'PassSUMQty': 1, 'DeftSUMQty': 1, 'DEFECT_RATE': 1.0, 'FPY_RATE': 0.0}]
2021-08-11 08:38:53,542 -[line:96] - INFO: 0.0 * 0.9045 * 0.7727 * 1 * 1 = 0.0
2021-08-11 08:38:53,542 -[line:96] - INFO: [{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'PROD_NBR': 'GP062CCAC100S', 'ACCT_DATE': '2021-08-01', 'APPLICATION': 'CE', 'OPER': 'PCBI', 'PassSUMQty': 14265, 'DeftSUMQty': 119, 'DEFECT_RATE': 0.0083, 'FPY_RATE': 0.9917}]
2021-08-11 08:38:53,543 -[line:96] - INFO: 0.9917 * 1 * 0.9784 * 0.9253 * 1.0 = 0.8978
2021-08-11 08:38:53,543 -[line:96] - INFO: [{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'PROD_NBR': 'GP062CCAY010S', 'ACCT_DATE': '2021-08-01', 'APPLICATION': 'CE', 'OPER': 'PCBI', 'PassSUMQty': 58, 'DeftSUMQty': 0, 'DEFECT_RATE': 0.0, 'FPY_RATE': 1.0}]
2021-08-11 08:38:53,543 -[line:96] - INFO: 1.0 * 1 * 0.97 * 0.9362 * 1.0 = 0.9081
2021-08-11 08:38:53,544 -[line:96] - INFO: [{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'PROD_NBR': 'GP070BAGM050S', 'ACCT_DATE': '2021-08-01', 'APPLICATION': 'CE', 'OPER': 'PCBI', 'PassSUMQty': 600, 'DeftSUMQty': 14, 'DEFECT_RATE': 0.0233, 'FPY_RATE': 0.9767}]
2021-08-11 08:38:53,544 -[line:96] - INFO: 0.9767 * 1 * 0.9662 * 0.9761 * 1.0 = 0.9211
2021-08-11 08:38:53,544 -[line:96] - INFO: [{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'PROD_NBR': 'GP080DZD00B0S', 'ACCT_DATE': '2021-08-01', 'APPLICATION': 'TABLET', 'OPER': 'PCBI', 'PassSUMQty': 2875, 'DeftSUMQty': 59, 'DEFECT_RATE': 0.0205, 'FPY_RATE': 0.9795}]
2021-08-11 08:38:53,545 -[line:96] - INFO: 0.9795 * 0.9543 * 0.9744 * 0.9233 * 1.0 = 0.8409
2021-08-11 08:38:53,545 -[line:96] - INFO: [{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'PROD_NBR': 'GP130ZFA0010S', 'ACCT_DATE': '2021-08-01', 'APPLICATION': 'TABLET', 'OPER': 'PCBI', 'PassSUMQty': 1292, 'DeftSUMQty': 17, 'DEFECT_RATE': 0.0132, 'FPY_RATE': 0.9868}]
2021-08-11 08:38:53,546 -[line:96] - INFO: 0.9868 * 1 * 0.9439 * 0.9147 * 0.9348 = 0.7964
2021-08-11 08:38:53,546 -[line:96] - INFO: [{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'PROD_NBR': 'GZD070SA4030S', 'ACCT_DATE': '2021-08-01', 'APPLICATION': 'CE', 'OPER': 'PCBI', 'PassSUMQty': 2300, 'DeftSUMQty': 5, 'DEFECT_RATE': 0.0022, 'FPY_RATE': 0.9978}]
2021-08-11 08:38:53,546 -[line:96] - INFO: 0.9978 * 0.9618 * 0.9906 * 0.9262 * 1.0 = 0.8805
2021-08-11 08:38:53,547 -[line:96] - INFO: [{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'PROD_NBR': 'GZD080JAB010S', 'ACCT_DATE': '2021-08-01', 'APPLICATION': 'CE', 'OPER': 'PCBI', 'PassSUMQty': 795, 'DeftSUMQty': 20, 'DEFECT_RATE': 0.0252, 'FPY_RATE': 0.9748}]
2021-08-11 08:38:53,547 -[line:96] - INFO: 0.9748 * 1 * 1 * 1 * 1 = 0.9748
2021-08-11 08:38:53,547 -[line:96] - INFO: 1 * 1 * 0.9828 * 0.978 * 1.0 = 0.9612
2021-08-11 08:38:53,548 -[line:96] - INFO: 1 * 1 * 1.0 * 1 * 1 = 1.0
2021-08-11 08:38:53,548 -[line:96] - INFO: 1 * 1 * 0.9862 * 1 * 1 = 0.9862
2021-08-11 08:38:53,548 -[line:96] - INFO: 1 * 1 * 0.9048 * 0.9103 * 1.0 = 0.8236
2021-08-11 08:38:53,548 -[line:96] - INFO: 1 * 1 * 0.7766 * 0.8 * 1.0 = 0.6213
2021-08-11 08:38:53,549 -[line:96] - INFO: 1 * 1 * 0.8286 * 1 * 1 = 0.8286
2021-08-11 08:38:53,549 -[line:96] - INFO: 1 * 1 * 1.0 * 0.9561 * 1.0 = 0.9561
2021-08-11 08:38:53,549 -[line:96] - INFO: 1 * 1 * 1 * 0.9697 * 1.0 = 0.9697
2021-08-11 08:38:53,549 -[line:96] - INFO: 1 * 1 * 1 * -1.0 * 1.0 = -1.0
2021-08-11 08:49:41,132 -[line:96] - INFO: INTKPI __init__
2021-08-11 08:49:41,133 -[line:96] - INFO: INTKPI getData Start
2021-08-11 08:49:41,133 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-11 08:49:43,781 -[line:96] - INFO: [{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'PROD_NBR': '2HE080IA1010S', 'ACCT_DATE': '2021-08-01', 'APPLICATION': 'TABLET', 'OPER': 'PCBI', 'PassSUMQty': 3, 'DeftSUMQty': 6, 'DEFECT_RATE': 2.0, 'FPY_RATE': -1.0}]
2021-08-11 08:49:43,782 -[line:96] - INFO: -1.0 * 1 * 1 * 1 * 1 = -1.0
2021-08-11 08:49:43,783 -[line:96] - INFO: [{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'PROD_NBR': 'GHD140ZB0000S', 'ACCT_DATE': '2021-08-01', 'APPLICATION': 'TABLET', 'OPER': 'PCBI', 'PassSUMQty': 1, 'DeftSUMQty': 1, 'DEFECT_RATE': 1.0, 'FPY_RATE': 0.0}]
2021-08-11 08:49:43,783 -[line:96] - INFO: 0.0 * 0.9045 * 0.7727 * 1 * 1 = 0.0
2021-08-11 08:49:43,783 -[line:96] - INFO: [{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'PROD_NBR': 'GP062CCAC100S', 'ACCT_DATE': '2021-08-01', 'APPLICATION': 'CE', 'OPER': 'PCBI', 'PassSUMQty': 14265, 'DeftSUMQty': 119, 'DEFECT_RATE': 0.0083, 'FPY_RATE': 0.9917}]
2021-08-11 08:49:43,784 -[line:96] - INFO: 0.9917 * 1 * 0.9784 * 0.9253 * 1.0 = 0.8978
2021-08-11 08:49:43,784 -[line:96] - INFO: [{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'PROD_NBR': 'GP062CCAY010S', 'ACCT_DATE': '2021-08-01', 'APPLICATION': 'CE', 'OPER': 'PCBI', 'PassSUMQty': 58, 'DeftSUMQty': 0, 'DEFECT_RATE': 0.0, 'FPY_RATE': 1.0}]
2021-08-11 08:49:43,785 -[line:96] - INFO: 1.0 * 1 * 0.97 * 0.9362 * 1.0 = 0.9081
2021-08-11 08:49:43,785 -[line:96] - INFO: [{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'PROD_NBR': 'GP070BAGM050S', 'ACCT_DATE': '2021-08-01', 'APPLICATION': 'CE', 'OPER': 'PCBI', 'PassSUMQty': 600, 'DeftSUMQty': 14, 'DEFECT_RATE': 0.0233, 'FPY_RATE': 0.9767}]
2021-08-11 08:49:43,786 -[line:96] - INFO: 0.9767 * 1 * 0.9662 * 0.9761 * 1.0 = 0.9211
2021-08-11 08:49:43,786 -[line:96] - INFO: [{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'PROD_NBR': 'GP080DZD00B0S', 'ACCT_DATE': '2021-08-01', 'APPLICATION': 'TABLET', 'OPER': 'PCBI', 'PassSUMQty': 2875, 'DeftSUMQty': 59, 'DEFECT_RATE': 0.0205, 'FPY_RATE': 0.9795}]
2021-08-11 08:49:43,786 -[line:96] - INFO: 0.9795 * 0.9543 * 0.9744 * 0.9233 * 1.0 = 0.8409
2021-08-11 08:49:43,786 -[line:96] - INFO: [{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'PROD_NBR': 'GP130ZFA0010S', 'ACCT_DATE': '2021-08-01', 'APPLICATION': 'TABLET', 'OPER': 'PCBI', 'PassSUMQty': 1292, 'DeftSUMQty': 17, 'DEFECT_RATE': 0.0132, 'FPY_RATE': 0.9868}]
2021-08-11 08:49:43,787 -[line:96] - INFO: 0.9868 * 1 * 0.9439 * 0.9147 * 0.9348 = 0.7964
2021-08-11 08:49:43,787 -[line:96] - INFO: [{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'PROD_NBR': 'GZD070SA4030S', 'ACCT_DATE': '2021-08-01', 'APPLICATION': 'CE', 'OPER': 'PCBI', 'PassSUMQty': 2300, 'DeftSUMQty': 5, 'DEFECT_RATE': 0.0022, 'FPY_RATE': 0.9978}]
2021-08-11 08:49:43,788 -[line:96] - INFO: 0.9978 * 0.9618 * 0.9906 * 0.9262 * 1.0 = 0.8805
2021-08-11 08:49:43,788 -[line:96] - INFO: [{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'PROD_NBR': 'GZD080JAB010S', 'ACCT_DATE': '2021-08-01', 'APPLICATION': 'CE', 'OPER': 'PCBI', 'PassSUMQty': 795, 'DeftSUMQty': 20, 'DEFECT_RATE': 0.0252, 'FPY_RATE': 0.9748}]
2021-08-11 08:49:43,788 -[line:96] - INFO: 0.9748 * 1 * 1 * 1 * 1 = 0.9748
2021-08-11 08:49:43,789 -[line:96] - INFO: 1 * 1 * 0.9828 * 0.978 * 1.0 = 0.9612
2021-08-11 08:49:43,789 -[line:96] - INFO: 1 * 1 * 1.0 * 1 * 1 = 1.0
2021-08-11 08:49:43,789 -[line:96] - INFO: 1 * 1 * 0.9862 * 1 * 1 = 0.9862
2021-08-11 08:49:43,789 -[line:96] - INFO: 1 * 1 * 0.9048 * 0.9103 * 1.0 = 0.8236
2021-08-11 08:49:43,790 -[line:96] - INFO: 1 * 1 * 0.7766 * 0.8 * 1.0 = 0.6213
2021-08-11 08:49:43,790 -[line:96] - INFO: 1 * 1 * 0.8286 * 1 * 1 = 0.8286
2021-08-11 08:49:43,790 -[line:96] - INFO: 1 * 1 * 1.0 * 0.9561 * 1.0 = 0.9561
2021-08-11 08:49:43,792 -[line:96] - INFO: 1 * 1 * 1 * 0.9697 * 1.0 = 0.9697
2021-08-11 08:49:43,792 -[line:96] - INFO: 1 * 1 * 1 * -1.0 * 1.0 = -1.0
2021-08-11 11:04:02,562 -[line:96] - INFO: INTKPI __init__
2021-08-11 11:04:02,563 -[line:96] - INFO: INTKPI getData Start
2021-08-11 11:04:02,563 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'APPLICATION': 'CE', 'KPITYPE': 'PRODFPY', 'ACCT_DATE': '20210801'}
2021-08-11 11:04:05,248 -[line:96] - INFO: [{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'PROD_NBR': '2HE080IA1010S', 'ACCT_DATE': '2021-08-01', 'APPLICATION': 'TABLET', 'OPER': 'PCBI', 'PassSUMQty': 3, 'DeftSUMQty': 6, 'DEFECT_RATE': 2.0, 'FPY_RATE': -1.0}]
2021-08-11 11:04:05,248 -[line:96] - INFO: -1.0 * 1 * 1 * 1 * 1 = -1.0
2021-08-11 11:04:05,249 -[line:96] - INFO: [{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'PROD_NBR': 'GHD140ZB0000S', 'ACCT_DATE': '2021-08-01', 'APPLICATION': 'TABLET', 'OPER': 'PCBI', 'PassSUMQty': 1, 'DeftSUMQty': 1, 'DEFECT_RATE': 1.0, 'FPY_RATE': 0.0}]
2021-08-11 11:04:05,249 -[line:96] - INFO: 0.0 * 0.9045 * 0.7727 * 1 * 1 = 0.0
2021-08-11 11:04:05,249 -[line:96] - INFO: [{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'PROD_NBR': 'GP062CCAC100S', 'ACCT_DATE': '2021-08-01', 'APPLICATION': 'CE', 'OPER': 'PCBI', 'PassSUMQty': 14265, 'DeftSUMQty': 119, 'DEFECT_RATE': 0.0083, 'FPY_RATE': 0.9917}]
2021-08-11 11:04:05,250 -[line:96] - INFO: 0.9917 * 1 * 0.9784 * 0.9253 * 1.0 = 0.8978
2021-08-11 11:04:05,250 -[line:96] - INFO: [{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'PROD_NBR': 'GP062CCAY010S', 'ACCT_DATE': '2021-08-01', 'APPLICATION': 'CE', 'OPER': 'PCBI', 'PassSUMQty': 58, 'DeftSUMQty': 0, 'DEFECT_RATE': 0.0, 'FPY_RATE': 1.0}]
2021-08-11 11:04:05,251 -[line:96] - INFO: 1.0 * 1 * 0.97 * 0.9362 * 1.0 = 0.9081
2021-08-11 11:04:05,251 -[line:96] - INFO: [{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'PROD_NBR': 'GP070BAGM050S', 'ACCT_DATE': '2021-08-01', 'APPLICATION': 'CE', 'OPER': 'PCBI', 'PassSUMQty': 600, 'DeftSUMQty': 14, 'DEFECT_RATE': 0.0233, 'FPY_RATE': 0.9767}]
2021-08-11 11:04:05,252 -[line:96] - INFO: 0.9767 * 1 * 0.9662 * 0.9761 * 1.0 = 0.9211
2021-08-11 11:04:05,252 -[line:96] - INFO: [{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'PROD_NBR': 'GP080DZD00B0S', 'ACCT_DATE': '2021-08-01', 'APPLICATION': 'TABLET', 'OPER': 'PCBI', 'PassSUMQty': 2875, 'DeftSUMQty': 59, 'DEFECT_RATE': 0.0205, 'FPY_RATE': 0.9795}]
2021-08-11 11:04:05,253 -[line:96] - INFO: 0.9795 * 0.9543 * 0.9744 * 0.9233 * 1.0 = 0.8409
2021-08-11 11:04:05,253 -[line:96] - INFO: [{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'PROD_NBR': 'GP130ZFA0010S', 'ACCT_DATE': '2021-08-01', 'APPLICATION': 'TABLET', 'OPER': 'PCBI', 'PassSUMQty': 1292, 'DeftSUMQty': 17, 'DEFECT_RATE': 0.0132, 'FPY_RATE': 0.9868}]
2021-08-11 11:04:05,254 -[line:96] - INFO: 0.9868 * 1 * 0.9439 * 0.9147 * 0.9348 = 0.7964
2021-08-11 11:04:05,254 -[line:96] - INFO: [{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'PROD_NBR': 'GZD070SA4030S', 'ACCT_DATE': '2021-08-01', 'APPLICATION': 'CE', 'OPER': 'PCBI', 'PassSUMQty': 2300, 'DeftSUMQty': 5, 'DEFECT_RATE': 0.0022, 'FPY_RATE': 0.9978}]
2021-08-11 11:04:05,254 -[line:96] - INFO: 0.9978 * 0.9618 * 0.9906 * 0.9262 * 1.0 = 0.8805
2021-08-11 11:04:05,255 -[line:96] - INFO: [{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'PROD_NBR': 'GZD080JAB010S', 'ACCT_DATE': '2021-08-01', 'APPLICATION': 'CE', 'OPER': 'PCBI', 'PassSUMQty': 795, 'DeftSUMQty': 20, 'DEFECT_RATE': 0.0252, 'FPY_RATE': 0.9748}]
2021-08-11 11:04:05,255 -[line:96] - INFO: 0.9748 * 1 * 1 * 1 * 1 = 0.9748
2021-08-11 11:04:05,256 -[line:96] - INFO: 1 * 1 * 0.9828 * 0.978 * 1.0 = 0.9612
2021-08-11 11:04:05,256 -[line:96] - INFO: 1 * 1 * 1.0 * 1 * 1 = 1.0
2021-08-11 11:04:05,256 -[line:96] - INFO: 1 * 1 * 0.9862 * 1 * 1 = 0.9862
2021-08-11 11:04:05,257 -[line:96] - INFO: 1 * 1 * 0.9048 * 0.9103 * 1.0 = 0.8236
2021-08-11 11:04:05,257 -[line:96] - INFO: 1 * 1 * 0.7766 * 0.8 * 1.0 = 0.6213
2021-08-11 11:04:05,257 -[line:96] - INFO: 1 * 1 * 0.8286 * 1 * 1 = 0.8286
2021-08-11 11:04:05,258 -[line:96] - INFO: 1 * 1 * 1.0 * 0.9561 * 1.0 = 0.9561
2021-08-11 11:04:05,258 -[line:96] - INFO: 1 * 1 * 1 * 0.9697 * 1.0 = 0.9697
2021-08-11 11:04:05,259 -[line:96] - INFO: 1 * 1 * 1 * -1.0 * 1.0 = -1.0
2021-08-11 11:05:04,848 -[line:96] - INFO: INTKPI __init__
2021-08-11 11:05:04,848 -[line:96] - INFO: INTKPI getData Start
2021-08-11 11:05:04,848 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'APPLICATION': 'CE', 'KPITYPE': 'PRODFPY', 'ACCT_DATE': '20210801'}
2021-08-11 11:05:04,860 -[line:96] - INFO: Cache Data From Redis
2021-08-11 11:05:11,782 -[line:96] - INFO: INTKPI __init__
2021-08-11 11:05:11,783 -[line:96] - INFO: INTKPI getData Start
2021-08-11 11:05:11,783 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'APPLICATION': 'CE', 'KPITYPE': 'PRODFPY', 'ACCT_DATE': '20210801'}
2021-08-11 11:05:14,555 -[line:96] - INFO: [{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'PROD_NBR': '2HE080IA1010S', 'ACCT_DATE': '2021-08-01', 'APPLICATION': 'TABLET', 'OPER': 'PCBI', 'PassSUMQty': 3, 'DeftSUMQty': 6, 'DEFECT_RATE': 2.0, 'FPY_RATE': -1.0}]
2021-08-11 11:05:14,556 -[line:96] - INFO: -1.0 * 1 * 1 * 1 * 1 = -1.0
2021-08-11 11:05:14,556 -[line:96] - INFO: [{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'PROD_NBR': 'GHD140ZB0000S', 'ACCT_DATE': '2021-08-01', 'APPLICATION': 'TABLET', 'OPER': 'PCBI', 'PassSUMQty': 1, 'DeftSUMQty': 1, 'DEFECT_RATE': 1.0, 'FPY_RATE': 0.0}]
2021-08-11 11:05:14,556 -[line:96] - INFO: 0.0 * 0.9045 * 0.7727 * 1 * 1 = 0.0
2021-08-11 11:05:14,557 -[line:96] - INFO: [{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'PROD_NBR': 'GP062CCAC100S', 'ACCT_DATE': '2021-08-01', 'APPLICATION': 'CE', 'OPER': 'PCBI', 'PassSUMQty': 14265, 'DeftSUMQty': 119, 'DEFECT_RATE': 0.0083, 'FPY_RATE': 0.9917}]
2021-08-11 11:05:14,557 -[line:96] - INFO: 0.9917 * 1 * 0.9784 * 0.9253 * 1.0 = 0.8978
2021-08-11 11:05:14,558 -[line:96] - INFO: [{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'PROD_NBR': 'GP062CCAY010S', 'ACCT_DATE': '2021-08-01', 'APPLICATION': 'CE', 'OPER': 'PCBI', 'PassSUMQty': 58, 'DeftSUMQty': 0, 'DEFECT_RATE': 0.0, 'FPY_RATE': 1.0}]
2021-08-11 11:05:14,558 -[line:96] - INFO: 1.0 * 1 * 0.97 * 0.9362 * 1.0 = 0.9081
2021-08-11 11:05:14,559 -[line:96] - INFO: [{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'PROD_NBR': 'GP070BAGM050S', 'ACCT_DATE': '2021-08-01', 'APPLICATION': 'CE', 'OPER': 'PCBI', 'PassSUMQty': 600, 'DeftSUMQty': 14, 'DEFECT_RATE': 0.0233, 'FPY_RATE': 0.9767}]
2021-08-11 11:05:14,559 -[line:96] - INFO: 0.9767 * 1 * 0.9662 * 0.9761 * 1.0 = 0.9211
2021-08-11 11:05:14,560 -[line:96] - INFO: [{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'PROD_NBR': 'GP080DZD00B0S', 'ACCT_DATE': '2021-08-01', 'APPLICATION': 'TABLET', 'OPER': 'PCBI', 'PassSUMQty': 2875, 'DeftSUMQty': 59, 'DEFECT_RATE': 0.0205, 'FPY_RATE': 0.9795}]
2021-08-11 11:05:14,560 -[line:96] - INFO: 0.9795 * 0.9543 * 0.9744 * 0.9233 * 1.0 = 0.8409
2021-08-11 11:05:14,560 -[line:96] - INFO: [{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'PROD_NBR': 'GP130ZFA0010S', 'ACCT_DATE': '2021-08-01', 'APPLICATION': 'TABLET', 'OPER': 'PCBI', 'PassSUMQty': 1292, 'DeftSUMQty': 17, 'DEFECT_RATE': 0.0132, 'FPY_RATE': 0.9868}]
2021-08-11 11:05:14,561 -[line:96] - INFO: 0.9868 * 1 * 0.9439 * 0.9147 * 0.9348 = 0.7964
2021-08-11 11:05:14,561 -[line:96] - INFO: [{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'PROD_NBR': 'GZD070SA4030S', 'ACCT_DATE': '2021-08-01', 'APPLICATION': 'CE', 'OPER': 'PCBI', 'PassSUMQty': 2300, 'DeftSUMQty': 5, 'DEFECT_RATE': 0.0022, 'FPY_RATE': 0.9978}]
2021-08-11 11:05:14,562 -[line:96] - INFO: 0.9978 * 0.9618 * 0.9906 * 0.9262 * 1.0 = 0.8805
2021-08-11 11:05:14,562 -[line:96] - INFO: [{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'PROD_NBR': 'GZD080JAB010S', 'ACCT_DATE': '2021-08-01', 'APPLICATION': 'CE', 'OPER': 'PCBI', 'PassSUMQty': 795, 'DeftSUMQty': 20, 'DEFECT_RATE': 0.0252, 'FPY_RATE': 0.9748}]
2021-08-11 11:05:14,563 -[line:96] - INFO: 0.9748 * 1 * 1 * 1 * 1 = 0.9748
2021-08-11 11:05:14,563 -[line:96] - INFO: 1 * 1 * 0.9828 * 0.978 * 1.0 = 0.9612
2021-08-11 11:05:14,564 -[line:96] - INFO: 1 * 1 * 1.0 * 1 * 1 = 1.0
2021-08-11 11:05:14,564 -[line:96] - INFO: 1 * 1 * 0.9862 * 1 * 1 = 0.9862
2021-08-11 11:05:14,564 -[line:96] - INFO: 1 * 1 * 0.9048 * 0.9103 * 1.0 = 0.8236
2021-08-11 11:05:14,565 -[line:96] - INFO: 1 * 1 * 0.7766 * 0.8 * 1.0 = 0.6213
2021-08-11 11:05:14,565 -[line:96] - INFO: 1 * 1 * 0.8286 * 1 * 1 = 0.8286
2021-08-11 11:05:14,565 -[line:96] - INFO: 1 * 1 * 1.0 * 0.9561 * 1.0 = 0.9561
2021-08-11 11:05:14,566 -[line:96] - INFO: 1 * 1 * 1 * 0.9697 * 1.0 = 0.9697
2021-08-11 11:05:14,566 -[line:96] - INFO: 1 * 1 * 1 * -1.0 * 1.0 = -1.0
2021-08-11 11:07:09,739 -[line:96] - INFO: INTKPI __init__
2021-08-11 11:07:09,740 -[line:96] - INFO: INTKPI getData Start
2021-08-11 11:07:09,740 -[line:96] - INFO: Input Json:{'KPITYPE': 'FPY', 'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'THEME': 'light1', 'ACCT_DATE': '20210810', 'animationEnabled': True, 'LEVELNAME': 'TN-MOD2'}
2021-08-11 11:07:09,741 -[line:99] - ERROR: File:[D:\Project\source\dataproviderapi\GetINTKPI.py] , Line:75 , in getData : [KeyError] APPLICATION
2021-08-11 12:03:00,226 -[line:96] - INFO: INTKPI __init__
2021-08-11 12:03:00,270 -[line:96] - INFO: INTKPI getData Start
2021-08-11 12:03:00,270 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'APPLICATION': 'CE', 'KPITYPE': 'PRODFPY', 'ACCT_DATE': '20210801'}
2021-08-11 12:03:03,071 -[line:96] - INFO: [{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'PROD_NBR': '2HE080IA1010S', 'ACCT_DATE': '2021-08-01', 'APPLICATION': 'TABLET', 'OPER': 'PCBI', 'PassSUMQty': 3, 'DeftSUMQty': 6, 'DEFECT_RATE': 2.0, 'FPY_RATE': -1.0}]
2021-08-11 12:03:03,072 -[line:96] - INFO: -1.0 * 1 * 1 * 1 * 1 = -1.0
2021-08-11 12:03:03,072 -[line:96] - INFO: [{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'PROD_NBR': 'GHD140ZB0000S', 'ACCT_DATE': '2021-08-01', 'APPLICATION': 'TABLET', 'OPER': 'PCBI', 'PassSUMQty': 1, 'DeftSUMQty': 1, 'DEFECT_RATE': 1.0, 'FPY_RATE': 0.0}]
2021-08-11 12:03:03,073 -[line:96] - INFO: 0.0 * 0.9045 * 0.7727 * 1 * 1 = 0.0
2021-08-11 12:03:03,073 -[line:96] - INFO: [{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'PROD_NBR': 'GP062CCAC100S', 'ACCT_DATE': '2021-08-01', 'APPLICATION': 'CE', 'OPER': 'PCBI', 'PassSUMQty': 14265, 'DeftSUMQty': 119, 'DEFECT_RATE': 0.0083, 'FPY_RATE': 0.9917}]
2021-08-11 12:03:03,073 -[line:96] - INFO: 0.9917 * 1 * 0.9784 * 0.9253 * 1.0 = 0.8978
2021-08-11 12:03:03,074 -[line:96] - INFO: [{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'PROD_NBR': 'GP062CCAY010S', 'ACCT_DATE': '2021-08-01', 'APPLICATION': 'CE', 'OPER': 'PCBI', 'PassSUMQty': 58, 'DeftSUMQty': 0, 'DEFECT_RATE': 0.0, 'FPY_RATE': 1.0}]
2021-08-11 12:03:03,074 -[line:96] - INFO: 1.0 * 1 * 0.97 * 0.9362 * 1.0 = 0.9081
2021-08-11 12:03:03,074 -[line:96] - INFO: [{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'PROD_NBR': 'GP070BAGM050S', 'ACCT_DATE': '2021-08-01', 'APPLICATION': 'CE', 'OPER': 'PCBI', 'PassSUMQty': 600, 'DeftSUMQty': 14, 'DEFECT_RATE': 0.0233, 'FPY_RATE': 0.9767}]
2021-08-11 12:03:03,075 -[line:96] - INFO: 0.9767 * 1 * 0.9662 * 0.9761 * 1.0 = 0.9211
2021-08-11 12:03:03,075 -[line:96] - INFO: [{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'PROD_NBR': 'GP080DZD00B0S', 'ACCT_DATE': '2021-08-01', 'APPLICATION': 'TABLET', 'OPER': 'PCBI', 'PassSUMQty': 2875, 'DeftSUMQty': 59, 'DEFECT_RATE': 0.0205, 'FPY_RATE': 0.9795}]
2021-08-11 12:03:03,076 -[line:96] - INFO: 0.9795 * 0.9543 * 0.9744 * 0.9233 * 1.0 = 0.8409
2021-08-11 12:03:03,076 -[line:96] - INFO: [{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'PROD_NBR': 'GP130ZFA0010S', 'ACCT_DATE': '2021-08-01', 'APPLICATION': 'TABLET', 'OPER': 'PCBI', 'PassSUMQty': 1292, 'DeftSUMQty': 17, 'DEFECT_RATE': 0.0132, 'FPY_RATE': 0.9868}]
2021-08-11 12:03:03,077 -[line:96] - INFO: 0.9868 * 1 * 0.9439 * 0.9147 * 0.9348 = 0.7964
2021-08-11 12:03:03,077 -[line:96] - INFO: [{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'PROD_NBR': 'GZD070SA4030S', 'ACCT_DATE': '2021-08-01', 'APPLICATION': 'CE', 'OPER': 'PCBI', 'PassSUMQty': 2300, 'DeftSUMQty': 5, 'DEFECT_RATE': 0.0022, 'FPY_RATE': 0.9978}]
2021-08-11 12:03:03,077 -[line:96] - INFO: 0.9978 * 0.9618 * 0.9906 * 0.9262 * 1.0 = 0.8805
2021-08-11 12:03:03,078 -[line:96] - INFO: [{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'PROD_NBR': 'GZD080JAB010S', 'ACCT_DATE': '2021-08-01', 'APPLICATION': 'CE', 'OPER': 'PCBI', 'PassSUMQty': 795, 'DeftSUMQty': 20, 'DEFECT_RATE': 0.0252, 'FPY_RATE': 0.9748}]
2021-08-11 12:03:03,078 -[line:96] - INFO: 0.9748 * 1 * 1 * 1 * 1 = 0.9748
2021-08-11 12:03:03,078 -[line:96] - INFO: 1 * 1 * 0.9828 * 0.978 * 1.0 = 0.9612
2021-08-11 12:03:03,079 -[line:96] - INFO: 1 * 1 * 1.0 * 1 * 1 = 1.0
2021-08-11 12:03:03,079 -[line:96] - INFO: 1 * 1 * 0.9862 * 1 * 1 = 0.9862
2021-08-11 12:03:03,079 -[line:96] - INFO: 1 * 1 * 0.9048 * 0.9103 * 1.0 = 0.8236
2021-08-11 12:03:03,079 -[line:96] - INFO: 1 * 1 * 0.7766 * 0.8 * 1.0 = 0.6213
2021-08-11 12:03:03,080 -[line:96] - INFO: 1 * 1 * 0.8286 * 1 * 1 = 0.8286
2021-08-11 12:03:03,080 -[line:96] - INFO: 1 * 1 * 1.0 * 0.9561 * 1.0 = 0.9561
2021-08-11 12:03:03,080 -[line:96] - INFO: 1 * 1 * 1 * 0.9697 * 1.0 = 0.9697
2021-08-11 12:03:03,081 -[line:96] - INFO: 1 * 1 * 1 * -1.0 * 1.0 = -1.0
2021-08-11 12:05:54,322 -[line:96] - INFO: INTKPI __init__
2021-08-11 12:05:54,324 -[line:96] - INFO: INTKPI getData Start
2021-08-11 12:05:54,324 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'APPLICATION': 'CE', 'KPITYPE': 'PRODFPY', 'ACCT_DATE': '20210801'}
2021-08-11 12:05:56,974 -[line:96] - INFO: -1.0 * 1 * 1 * 1 * 1 = -1.0
2021-08-11 12:05:56,974 -[line:96] - INFO: 0.0 * 0.9045 * 0.7727 * 1 * 1 = 0.0
2021-08-11 12:05:56,975 -[line:96] - INFO: [{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'PROD_NBR': 'GP062CCAC100S', 'ACCT_DATE': '2021-08-01', 'APPLICATION': 'CE', 'OPER': 'CKEN', 'PassSUMQty': 16385, 'DeftSUMQty': 1224, 'DEFECT_RATE': 0.0747, 'FPY_RATE': 0.9253}]
2021-08-11 12:05:56,975 -[line:96] - INFO: 0.9917 * 1 * 0.9784 * 0.9253 * 1.0 = 0.8978
2021-08-11 12:05:56,975 -[line:96] - INFO: [{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'PROD_NBR': 'GP062CCAY010S', 'ACCT_DATE': '2021-08-01', 'APPLICATION': 'CE', 'OPER': 'CKEN', 'PassSUMQty': 2006, 'DeftSUMQty': 128, 'DEFECT_RATE': 0.0638, 'FPY_RATE': 0.9362}]
2021-08-11 12:05:56,976 -[line:96] - INFO: 1.0 * 1 * 0.97 * 0.9362 * 1.0 = 0.9081
2021-08-11 12:05:56,976 -[line:96] - INFO: [{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'PROD_NBR': 'GP070BAGM050S', 'ACCT_DATE': '2021-08-01', 'APPLICATION': 'CE', 'OPER': 'CKEN', 'PassSUMQty': 628, 'DeftSUMQty': 15, 'DEFECT_RATE': 0.0239, 'FPY_RATE': 0.9761}]
2021-08-11 12:05:56,977 -[line:96] - INFO: 0.9767 * 1 * 0.9662 * 0.9761 * 1.0 = 0.9211
2021-08-11 12:05:56,977 -[line:96] - INFO: [{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'PROD_NBR': 'GP080DZD00B0S', 'ACCT_DATE': '2021-08-01', 'APPLICATION': 'TABLET', 'OPER': 'CKEN', 'PassSUMQty': 1877, 'DeftSUMQty': 144, 'DEFECT_RATE': 0.0767, 'FPY_RATE': 0.9233}]
2021-08-11 12:05:56,977 -[line:96] - INFO: 0.9795 * 0.9543 * 0.9744 * 0.9233 * 1.0 = 0.8409
2021-08-11 12:05:56,978 -[line:96] - INFO: [{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'PROD_NBR': 'GP130ZFA0010S', 'ACCT_DATE': '2021-08-01', 'APPLICATION': 'TABLET', 'OPER': 'CKEN', 'PassSUMQty': 1289, 'DeftSUMQty': 110, 'DEFECT_RATE': 0.0853, 'FPY_RATE': 0.9147}]
2021-08-11 12:05:56,978 -[line:96] - INFO: 0.9868 * 1 * 0.9439 * 0.9147 * 0.9348 = 0.7964
2021-08-11 12:05:56,979 -[line:96] - INFO: [{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'PROD_NBR': 'GZD070SA4030S', 'ACCT_DATE': '2021-08-01', 'APPLICATION': 'CE', 'OPER': 'CKEN', 'PassSUMQty': 1030, 'DeftSUMQty': 76, 'DEFECT_RATE': 0.0738, 'FPY_RATE': 0.9262}]
2021-08-11 12:05:56,980 -[line:96] - INFO: 0.9978 * 0.9618 * 0.9906 * 0.9262 * 1.0 = 0.8805
2021-08-11 12:05:56,980 -[line:96] - INFO: 0.9748 * 1 * 1 * 1 * 1 = 0.9748
2021-08-11 12:05:56,980 -[line:96] - INFO: [{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'PROD_NBR': 'GP080DZD00C0S', 'ACCT_DATE': '2021-08-01', 'APPLICATION': 'TABLET', 'OPER': 'CKEN', 'PassSUMQty': 91, 'DeftSUMQty': 2, 'DEFECT_RATE': 0.022, 'FPY_RATE': 0.978}]
2021-08-11 12:05:56,981 -[line:96] - INFO: 1 * 1 * 0.9828 * 0.978 * 1.0 = 0.9612
2021-08-11 12:05:56,981 -[line:96] - INFO: 1 * 1 * 1.0 * 1 * 1 = 1.0
2021-08-11 12:05:56,982 -[line:96] - INFO: 1 * 1 * 0.9862 * 1 * 1 = 0.9862
2021-08-11 12:05:56,982 -[line:96] - INFO: [{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'PROD_NBR': 'GP130ZFZ1020S', 'ACCT_DATE': '2021-08-01', 'APPLICATION': 'TABLET', 'OPER': 'CKEN', 'PassSUMQty': 223, 'DeftSUMQty': 20, 'DEFECT_RATE': 0.0897, 'FPY_RATE': 0.9103}]
2021-08-11 12:05:56,983 -[line:96] - INFO: 1 * 1 * 0.9048 * 0.9103 * 1.0 = 0.8236
2021-08-11 12:05:56,983 -[line:96] - INFO: [{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'PROD_NBR': 'GP140ZKA0040S', 'ACCT_DATE': '2021-08-01', 'APPLICATION': 'TABLET', 'OPER': 'CKEN', 'PassSUMQty': 125, 'DeftSUMQty': 25, 'DEFECT_RATE': 0.2, 'FPY_RATE': 0.8}]
2021-08-11 12:05:56,984 -[line:96] - INFO: 1 * 1 * 0.7766 * 0.8 * 1.0 = 0.6213
2021-08-11 12:05:56,984 -[line:96] - INFO: 1 * 1 * 0.8286 * 1 * 1 = 0.8286
2021-08-11 12:05:56,984 -[line:96] - INFO: [{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'PROD_NBR': 'GZD070SA5010S', 'ACCT_DATE': '2021-08-01', 'APPLICATION': 'CE', 'OPER': 'CKEN', 'PassSUMQty': 114, 'DeftSUMQty': 5, 'DEFECT_RATE': 0.0439, 'FPY_RATE': 0.9561}]
2021-08-11 12:05:56,985 -[line:96] - INFO: 1 * 1 * 1.0 * 0.9561 * 1.0 = 0.9561
2021-08-11 12:05:56,985 -[line:96] - INFO: [{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'PROD_NBR': 'GNJ101IA0030S', 'ACCT_DATE': '2021-08-01', 'APPLICATION': 'CE', 'OPER': 'CKEN', 'PassSUMQty': 33, 'DeftSUMQty': 1, 'DEFECT_RATE': 0.0303, 'FPY_RATE': 0.9697}]
2021-08-11 12:05:56,986 -[line:96] - INFO: 1 * 1 * 1 * 0.9697 * 1.0 = 0.9697
2021-08-11 12:05:56,986 -[line:96] - INFO: [{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'PROD_NBR': 'GZJ101ZA3010S', 'ACCT_DATE': '2021-08-01', 'APPLICATION': 'CE', 'OPER': 'CKEN', 'PassSUMQty': 2, 'DeftSUMQty': 4, 'DEFECT_RATE': 2.0, 'FPY_RATE': -1.0}]
2021-08-11 12:05:56,986 -[line:96] - INFO: 1 * 1 * 1 * -1.0 * 1.0 = -1.0
2021-08-11 12:23:40,049 -[line:96] - INFO: INTKPI __init__
2021-08-11 12:23:40,051 -[line:96] - INFO: INTKPI getData Start
2021-08-11 12:23:40,051 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'APPLICATION': 'CE', 'KPITYPE': 'PRODFPY', 'ACCT_DATE': '20210801'}
2021-08-11 12:32:10,778 -[line:96] - INFO: INTKPI __init__
2021-08-11 12:32:10,779 -[line:96] - INFO: INTKPI getData Start
2021-08-11 12:32:10,779 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'APPLICATION': 'CE', 'KPITYPE': 'PRODFPY', 'ACCT_DATE': '20210801'}
2021-08-11 12:32:28,598 -[line:96] - INFO: INTKPI __init__
2021-08-11 12:32:28,599 -[line:96] - INFO: INTKPI getData Start
2021-08-11 12:32:28,599 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'APPLICATION': 'CE', 'KPITYPE': 'PRODFPY', 'ACCT_DATE': '20210811'}
2021-08-11 12:33:11,908 -[line:96] - INFO: INTKPI __init__
2021-08-11 12:33:11,908 -[line:96] - INFO: INTKPI getData Start
2021-08-11 12:33:11,909 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'APPLICATION': 'CE', 'KPITYPE': 'PRODFPY', 'ACCT_DATE': '20210810'}
2021-08-12 08:18:16,108 -[line:96] - INFO: INTKPI __init__
2021-08-12 08:18:16,151 -[line:96] - INFO: INTKPI getData Start
2021-08-12 08:18:16,151 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'APPLICATION': 'CE', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210811'}
2021-08-12 08:18:29,006 -[line:96] - INFO: INTKPI __init__
2021-08-12 08:18:29,006 -[line:96] - INFO: INTKPI getData Start
2021-08-12 08:18:29,007 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'APPLICATION': 'CE', 'KPITYPE': 'PRODFPY', 'ACCT_DATE': '20210811'}
2021-08-12 08:19:23,951 -[line:96] - INFO: INTKPI __init__
2021-08-12 08:19:23,953 -[line:96] - INFO: INTKPI getData Start
2021-08-12 08:19:23,954 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'APPLICATION': 'ALL', 'KPITYPE': 'PRODFPY', 'ACCT_DATE': '20210811'}
2021-08-12 08:19:26,555 -[line:99] - ERROR: File:[D:\Project\source\dataproviderapi\GetINTKPI.py] , Line:540 , in _calPRODFPYData : [KeyError] ALL
2021-08-12 08:21:56,130 -[line:96] - INFO: INTKPI __init__
2021-08-12 08:21:56,130 -[line:96] - INFO: INTKPI getData Start
2021-08-12 08:21:56,130 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'APPLICATION': 'ALL', 'KPITYPE': 'PRODFPY', 'ACCT_DATE': '20210811'}
2021-08-12 08:23:13,690 -[line:96] - INFO: INTKPI __init__
2021-08-12 08:23:13,691 -[line:96] - INFO: INTKPI getData Start
2021-08-12 08:23:13,691 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'APPLICATION': 'CE', 'KPITYPE': 'PRODFPY', 'ACCT_DATE': '20210811'}
2021-08-12 11:05:47,778 -[line:96] - INFO: INTKPI __init__
2021-08-12 11:05:47,779 -[line:96] - INFO: INTKPI getData Start
2021-08-12 11:05:47,779 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'APPLICATION': 'CE', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-12 11:06:02,965 -[line:96] - INFO: INTKPI __init__
2021-08-12 11:06:02,965 -[line:96] - INFO: INTKPI getData Start
2021-08-12 11:06:02,965 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'APPLICATION': 'CE', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210811'}
2021-08-12 11:09:55,185 -[line:96] - INFO: INTKPI __init__
2021-08-12 11:09:55,186 -[line:96] - INFO: INTKPI getData Start
2021-08-12 11:09:55,186 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'APPLICATION': 'CE', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210811'}
2021-08-12 11:10:09,230 -[line:96] - INFO: INTKPI __init__
2021-08-12 11:10:09,232 -[line:96] - INFO: INTKPI getData Start
2021-08-12 11:10:09,233 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'APPLICATION': 'ALL', 'KPITYPE': 'PRODFPY', 'ACCT_DATE': '20210811'}
2021-08-12 11:11:58,032 -[line:96] - INFO: INTKPI __init__
2021-08-12 11:11:58,033 -[line:96] - INFO: INTKPI getData Start
2021-08-12 11:11:58,033 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'APPLICATION': 'ALL', 'KPITYPE': 'PRODFPY', 'ACCT_DATE': '20210811'}
2021-08-12 11:16:18,396 -[line:96] - INFO: INTKPI __init__
2021-08-12 11:16:18,397 -[line:96] - INFO: INTKPI getData Start
2021-08-12 11:16:18,397 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'APPLICATION': 'CE', 'KPITYPE': 'PRODFPY', 'ACCT_DATE': '20210811'}
2021-08-12 11:16:19,188 -[line:96] - INFO: INTKPI __init__
2021-08-12 11:16:19,189 -[line:96] - INFO: INTKPI getData Start
2021-08-12 11:16:19,189 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'APPLICATION': 'CE', 'KPITYPE': 'PRODFPY', 'ACCT_DATE': '20210811'}
2021-08-12 11:16:59,815 -[line:96] - INFO: INTKPI __init__
2021-08-12 11:16:59,815 -[line:96] - INFO: INTKPI getData Start
2021-08-12 11:16:59,815 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'APPLICATION': 'TABLET', 'KPITYPE': 'PRODFPY', 'ACCT_DATE': '20210811'}
2021-08-12 11:16:59,824 -[line:96] - INFO: Cache Data From Redis
2021-08-12 11:17:28,713 -[line:96] - INFO: INTKPI __init__
2021-08-12 11:17:28,714 -[line:96] - INFO: INTKPI getData Start
2021-08-12 11:17:28,714 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'APPLICATION': 'TABLET', 'KPITYPE': 'PRODFPY', 'ACCT_DATE': '20210811'}
2021-08-12 11:17:28,720 -[line:96] - INFO: Cache Data From Redis
2021-08-12 11:29:02,594 -[line:96] - INFO: INTKPI __init__
2021-08-12 11:29:02,595 -[line:96] - INFO: INTKPI getData Start
2021-08-12 11:29:02,595 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'APPLICATION': 'ALL', 'KPITYPE': 'PRODFPY', 'ACCT_DATE': '20210811'}
2021-08-12 11:44:06,573 -[line:96] - INFO: INTKPI __init__
2021-08-12 11:44:06,573 -[line:96] - INFO: INTKPI getData Start
2021-08-12 11:44:06,574 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'APPLICATION': 'ALL', 'KPITYPE': 'PRODFPY', 'ACCT_DATE': '20210811'}
2021-08-12 13:05:26,926 -[line:96] - INFO: INTKPI __init__
2021-08-12 13:05:26,927 -[line:96] - INFO: INTKPI getData Start
2021-08-12 13:05:26,927 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'APPLICATION': 'ALL', 'KPITYPE': 'PRODFPY', 'ACCT_DATE': '20210811'}
2021-08-12 13:05:29,715 -[line:99] - ERROR: File:[D:\Project\source\dataproviderapi\GetINTKPI.py] , Line:574 , in _calPRODFPYData : [TypeError] unsupported operand type(s) for *: 'NoneType' and 'int'
2021-08-12 13:08:28,337 -[line:96] - INFO: INTKPI __init__
2021-08-12 13:08:28,338 -[line:96] - INFO: INTKPI getData Start
2021-08-12 13:08:28,338 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'APPLICATION': 'ALL', 'KPITYPE': 'PRODFPY', 'ACCT_DATE': '20210811'}
2021-08-12 13:08:30,982 -[line:99] - ERROR: File:[D:\Project\source\dataproviderapi\GetINTKPI.py] , Line:574 , in _calPRODFPYData : [TypeError] unsupported operand type(s) for *: 'NoneType' and 'int'
2021-08-12 15:18:15,569 -[line:96] - INFO: INTKPI __init__
2021-08-12 15:18:15,572 -[line:96] - INFO: INTKPI getData Start
2021-08-12 15:18:15,573 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'APPLICATION': 'ALL', 'KPITYPE': 'PRODFPY', 'ACCT_DATE': '20210811'}
2021-08-12 15:18:18,194 -[line:99] - ERROR: File:[D:\Project\source\dataproviderapi\GetINTKPI.py] , Line:574 , in _calPRODFPYData : [TypeError] unsupported operand type(s) for *: 'NoneType' and 'int'
2021-08-12 15:18:56,568 -[line:96] - INFO: INTKPI __init__
2021-08-12 15:18:56,568 -[line:96] - INFO: INTKPI getData Start
2021-08-12 15:18:56,568 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'APPLICATION': 'ALL', 'KPITYPE': 'PRODFPY', 'ACCT_DATE': '20210811'}
2021-08-12 17:56:01,103 -[line:96] - INFO: INTKPI __init__
2021-08-12 17:56:01,122 -[line:96] - INFO: INTKPI getData Start
2021-08-12 17:56:01,122 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'APPLICATION': 'CE', 'KPITYPE': 'PRODFPY', 'ACCT_DATE': '20210801'}
2021-08-13 11:44:31,287 -[line:96] - INFO: INTKPI __init__
2021-08-13 11:44:31,303 -[line:96] - INFO: INTKPI getData Start
2021-08-13 11:44:31,303 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'APPLICATION': 'CE', 'KPITYPE': 'MSHIP', 'ACCT_DATE': '20210801'}
2021-08-13 11:44:52,450 -[line:96] - INFO: INTKPI __init__
2021-08-13 11:44:52,450 -[line:96] - INFO: INTKPI getData Start
2021-08-13 11:44:52,451 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'APPLICATION': 'CE', 'KPITYPE': 'MSHIP', 'ACCT_DATE': '20210801'}
2021-08-13 11:44:52,452 -[line:99] - ERROR: File:[D:\Project\source\dataproviderapi\GetINTKPI.py] , Line:744 , in _getMSHIPData : [TypeError] append() takes exactly one argument (4 given)
2021-08-13 11:46:44,113 -[line:96] - INFO: INTKPI __init__
2021-08-13 11:46:44,114 -[line:96] - INFO: INTKPI getData Start
2021-08-13 11:46:44,114 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'APPLICATION': 'CE', 'KPITYPE': 'MSHIP', 'ACCT_DATE': '20210801'}
2021-08-13 11:46:44,116 -[line:99] - ERROR: File:[D:\Project\source\dataproviderapi\GetINTKPI.py] , Line:744 , in _getMSHIPData : [TypeError] extend() takes exactly one argument (4 given)
2021-08-13 11:47:07,925 -[line:96] - INFO: INTKPI __init__
2021-08-13 11:47:07,926 -[line:96] - INFO: INTKPI getData Start
2021-08-13 11:47:07,927 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'APPLICATION': 'CE', 'KPITYPE': 'MSHIP', 'ACCT_DATE': '20210801'}
2021-08-13 11:47:30,767 -[line:96] - INFO: INTKPI __init__
2021-08-13 11:47:30,767 -[line:96] - INFO: INTKPI getData Start
2021-08-13 11:47:30,768 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'APPLICATION': 'ALL', 'KPITYPE': 'MSHIP', 'ACCT_DATE': '20210801'}
2021-08-13 11:48:19,352 -[line:96] - INFO: INTKPI __init__
2021-08-13 11:48:19,353 -[line:96] - INFO: INTKPI getData Start
2021-08-13 11:48:19,353 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'APPLICATION': 'ALL', 'KPITYPE': 'MSHIP', 'ACCT_DATE': '20210801'}
2021-08-13 11:51:37,203 -[line:96] - INFO: INTKPI __init__
2021-08-13 11:51:37,203 -[line:96] - INFO: INTKPI getData Start
2021-08-13 11:51:37,204 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'APPLICATION': 'ALL', 'KPITYPE': 'MSHIP', 'ACCT_DATE': '20210801'}
2021-08-13 11:51:37,356 -[line:99] - ERROR: File:[C:\Users\hsinyuan.lin\AppData\Local\Programs\Python\Python36\lib\json\encoder.py] , Line:180 , in default : [TypeError] Object of type 'CommandCursor' is not JSON serializable
2021-08-13 13:08:30,203 -[line:96] - INFO: INTKPI __init__
2021-08-13 13:08:30,204 -[line:96] - INFO: INTKPI getData Start
2021-08-13 13:08:30,204 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'APPLICATION': 'ALL', 'KPITYPE': 'MSHIP', 'ACCT_DATE': '20210801'}
2021-08-13 13:10:37,388 -[line:96] - INFO: INTKPI __init__
2021-08-13 13:10:37,388 -[line:96] - INFO: INTKPI getData Start
2021-08-13 13:10:37,389 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'APPLICATION': 'ALL', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-13 13:10:47,293 -[line:96] - INFO: INTKPI __init__
2021-08-13 13:10:47,294 -[line:96] - INFO: INTKPI getData Start
2021-08-13 13:10:47,294 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'APPLICATION': 'ALL', 'KPITYPE': 'CE', 'ACCT_DATE': '20210801'}
2021-08-13 13:11:00,430 -[line:96] - INFO: INTKPI __init__
2021-08-13 13:11:00,431 -[line:96] - INFO: INTKPI getData Start
2021-08-13 13:11:00,431 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'APPLICATION': 'CE', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-13 13:11:10,337 -[line:96] - INFO: INTKPI __init__
2021-08-13 13:11:10,338 -[line:96] - INFO: INTKPI getData Start
2021-08-13 13:11:10,339 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'APPLICATION': 'ALL', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-13 13:11:10,346 -[line:96] - INFO: Cache Data From Redis
2021-08-13 13:11:45,042 -[line:96] - INFO: INTKPI __init__
2021-08-13 13:11:45,043 -[line:96] - INFO: INTKPI getData Start
2021-08-13 13:11:45,043 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'APPLICATION': 'ALL', 'KPITYPE': 'PRODFPY', 'ACCT_DATE': '20210801'}
2021-08-13 13:12:21,397 -[line:96] - INFO: INTKPI __init__
2021-08-13 13:12:21,398 -[line:96] - INFO: INTKPI getData Start
2021-08-13 13:12:21,398 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'APPLICATION': 'ALL', 'KPITYPE': 'PRODFPY', 'ACCT_DATE': '20210812'}
2021-08-13 13:15:12,245 -[line:96] - INFO: INTKPI __init__
2021-08-13 13:15:12,245 -[line:96] - INFO: INTKPI getData Start
2021-08-13 13:15:12,246 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'APPLICATION': 'ALL', 'KPITYPE': 'PRODFPY', 'ACCT_DATE': '20210812'}
2021-08-13 13:15:30,338 -[line:96] - INFO: INTKPI __init__
2021-08-13 13:15:30,339 -[line:96] - INFO: INTKPI getData Start
2021-08-13 13:15:30,339 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'APPLICATION': 'ALL', 'KPITYPE': 'PRODFPY', 'ACCT_DATE': '20210812'}
2021-08-13 13:15:30,345 -[line:96] - INFO: Cache Data From Redis
2021-08-13 13:15:46,948 -[line:96] - INFO: INTKPI __init__
2021-08-13 13:15:46,949 -[line:96] - INFO: INTKPI getData Start
2021-08-13 13:15:46,949 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'APPLICATION': 'ALL', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210812'}
2021-08-13 13:15:46,952 -[line:96] - INFO: INTKPI_INX_TN_J001_ALL_FPY_20210812
2021-08-13 13:19:40,576 -[line:96] - INFO: INTKPI __init__
2021-08-13 13:19:40,577 -[line:96] - INFO: INTKPI getData Start
2021-08-13 13:19:40,577 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'APPLICATION': 'ALL', 'KPITYPE': 'QQ', 'ACCT_DATE': '20210812'}
2021-08-13 13:19:40,581 -[line:96] - INFO: INTKPI_INX_TN_J001_ALL_QQ_20210812
2021-08-13 13:20:05,427 -[line:96] - INFO: INTKPI __init__
2021-08-13 13:20:05,427 -[line:96] - INFO: INTKPI getData Start
2021-08-13 13:20:05,427 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'APPLICATION': 'ALL', 'KPITYPE': 'QQ', 'ACCT_DATE': '20210812'}
2021-08-13 13:20:05,431 -[line:96] - INFO: INTKPI_INX_TN_J001_ALL_QQ_20210812
2021-08-13 13:20:08,308 -[line:96] - INFO: INTKPI __init__
2021-08-13 13:20:08,309 -[line:96] - INFO: INTKPI getData Start
2021-08-13 13:20:08,309 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'APPLICATION': 'ALL', 'KPITYPE': 'QQ', 'ACCT_DATE': '20210812'}
2021-08-13 13:20:08,327 -[line:96] - INFO: INTKPI_INX_TN_J001_ALL_QQ_20210812
2021-08-13 13:20:10,775 -[line:96] - INFO: INTKPI __init__
2021-08-13 13:20:10,775 -[line:96] - INFO: INTKPI getData Start
2021-08-13 13:20:10,775 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'APPLICATION': 'ALL', 'KPITYPE': 'QQ', 'ACCT_DATE': '20210812'}
2021-08-13 13:20:10,779 -[line:96] - INFO: INTKPI_INX_TN_J001_ALL_QQ_20210812
2021-08-13 13:20:13,924 -[line:96] - INFO: INTKPI __init__
2021-08-13 13:20:13,925 -[line:96] - INFO: INTKPI getData Start
2021-08-13 13:20:13,925 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'APPLICATION': 'ALL', 'KPITYPE': 'QQ', 'ACCT_DATE': '20210812'}
2021-08-13 13:20:13,954 -[line:96] - INFO: INTKPI_INX_TN_J001_ALL_QQ_20210812
2021-08-13 13:20:36,076 -[line:96] - INFO: INTKPI __init__
2021-08-13 13:20:36,076 -[line:96] - INFO: INTKPI getData Start
2021-08-13 13:20:36,077 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'APPLICATION': 'ALL', 'KPITYPE': 'QQ', 'ACCT_DATE': '20210812'}
2021-08-13 13:20:36,080 -[line:96] - INFO: INTKPI_INX_TN_J001_ALL_QQ_20210812
2021-08-13 13:20:42,794 -[line:96] - INFO: INTKPI __init__
2021-08-13 13:20:42,795 -[line:96] - INFO: INTKPI getData Start
2021-08-13 13:20:42,795 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'APPLICATION': 'ALL', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210812'}
2021-08-13 13:20:42,799 -[line:96] - INFO: INTKPI_INX_TN_J001_ALL_FPY_20210812
2021-08-13 13:22:09,832 -[line:96] - INFO: INTKPI __init__
2021-08-13 13:22:09,832 -[line:96] - INFO: INTKPI getData Start
2021-08-13 13:22:09,833 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'APPLICATION': 'ALL', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210812'}
2021-08-13 13:22:09,836 -[line:96] - INFO: INTKPI_INX_TN_J001_ALL_FPY_20210812
2021-08-13 13:22:12,530 -[line:96] - INFO: 2
2021-08-13 13:22:34,747 -[line:96] - INFO: INTKPI __init__
2021-08-13 13:22:34,748 -[line:96] - INFO: INTKPI getData Start
2021-08-13 13:22:34,748 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'APPLICATION': 'ALL', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210812'}
2021-08-13 13:22:34,752 -[line:96] - INFO: INTKPI_INX_TN_J001_ALL_FPY_20210812
2021-08-13 13:22:34,756 -[line:96] - INFO: Cache Data From Redis
2021-08-13 13:22:34,758 -[line:96] - INFO: {
  "CLASS_TYPE": "FPY",
  "GREEN_VALUE": 7,
  "RED_VALUE": 8,
  "YELLOW_VALUE": 1
}
2021-08-13 13:22:34,761 -[line:99] - ERROR: File:[D:\Project\source\dataproviderapi\GetINTKPI.py] , Line:96 , in getData : [UnboundLocalError] local variable 'expirTimeKey' referenced before assignment
2021-08-13 13:23:38,427 -[line:96] - INFO: INTKPI __init__
2021-08-13 13:23:38,428 -[line:96] - INFO: INTKPI getData Start
2021-08-13 13:23:38,428 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'APPLICATION': 'ALL', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210812'}
2021-08-13 13:23:38,432 -[line:96] - INFO: INTKPI_INX_TN_J001_ALL_FPY_20210812
2021-08-13 13:23:41,136 -[line:96] - INFO: 2
2021-08-13 13:23:47,133 -[line:96] - INFO: INTKPI __init__
2021-08-13 13:23:47,134 -[line:96] - INFO: INTKPI getData Start
2021-08-13 13:23:47,134 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'APPLICATION': 'ALL', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210812'}
2021-08-13 13:23:47,138 -[line:96] - INFO: INTKPI_INX_TN_J001_ALL_FPY_20210812
2021-08-13 13:23:47,142 -[line:96] - INFO: Cache Data From Redis
2021-08-13 13:23:47,144 -[line:96] - INFO: {
  "CLASS_TYPE": "FPY",
  "GREEN_VALUE": 7,
  "RED_VALUE": 8,
  "YELLOW_VALUE": 1
}
2021-08-13 13:24:00,836 -[line:96] - INFO: INTKPI __init__
2021-08-13 13:24:00,837 -[line:96] - INFO: INTKPI getData Start
2021-08-13 13:24:00,837 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'APPLICATION': 'ALL', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210812'}
2021-08-13 13:24:00,841 -[line:96] - INFO: INTKPI_INX_TN_J001_ALL_FPY_20210812
2021-08-13 13:24:00,845 -[line:96] - INFO: Cache Data From Redis
2021-08-13 13:24:00,847 -[line:96] - INFO: {
  "CLASS_TYPE": "FPY",
  "GREEN_VALUE": 7,
  "RED_VALUE": 8,
  "YELLOW_VALUE": 1
}
2021-08-13 13:28:31,124 -[line:96] - INFO: INTKPI __init__
2021-08-13 13:28:31,125 -[line:96] - INFO: INTKPI getData Start
2021-08-13 13:28:31,125 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'APPLICATION': 'ALL', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210812'}
2021-08-13 13:28:31,129 -[line:96] - INFO: INTKPI_INX_TN_J001_ALL_FPY_20210812
2021-08-13 13:28:33,813 -[line:96] - INFO: 2
2021-08-13 13:28:39,867 -[line:96] - INFO: INTKPI __init__
2021-08-13 13:28:39,868 -[line:96] - INFO: INTKPI getData Start
2021-08-13 13:28:39,868 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'APPLICATION': 'ALL', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210812'}
2021-08-13 13:28:39,933 -[line:96] - INFO: INTKPI_INX_TN_J001_ALL_FPY_20210812
2021-08-13 13:28:39,996 -[line:96] - INFO: Cache Data From Redis
2021-08-13 13:28:39,998 -[line:96] - INFO: {
  "CLASS_TYPE": "FPY",
  "GREEN_VALUE": 7,
  "RED_VALUE": 8,
  "YELLOW_VALUE": 1
}
2021-08-13 13:28:51,459 -[line:96] - INFO: INTKPI __init__
2021-08-13 13:28:51,460 -[line:96] - INFO: INTKPI getData Start
2021-08-13 13:28:51,460 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'APPLICATION': 'ALL', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210812'}
2021-08-13 13:28:51,463 -[line:96] - INFO: INTKPI_INX_TN_J001_ALL_FPY_20210812
2021-08-13 13:28:51,467 -[line:96] - INFO: Cache Data From Redis
2021-08-13 13:28:51,469 -[line:96] - INFO: {
  "CLASS_TYPE": "FPY",
  "GREEN_VALUE": 7,
  "RED_VALUE": 8,
  "YELLOW_VALUE": 1
}
2021-08-13 18:47:24,280 -[line:96] - INFO: INTKPI __init__
2021-08-13 18:47:24,282 -[line:96] - INFO: INTKPI getData Start
2021-08-13 18:47:24,282 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J004', 'APPLICATION': 'ALL', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210812'}
2021-08-13 18:47:24,288 -[line:96] - INFO: INTKPI_INX_TN_J004_ALL_FPY_20210812
2021-08-13 18:47:24,304 -[line:99] - ERROR: File:[D:\Project\source\dataproviderapi\GetINTKPI.py] , Line:199 , in _getFPYData : [KeyError] J004
2021-08-13 18:49:06,040 -[line:96] - INFO: INTKPI __init__
2021-08-13 18:49:06,040 -[line:96] - INFO: INTKPI getData Start
2021-08-13 18:49:06,041 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J004', 'APPLICATION': 'ALL', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210812'}
2021-08-13 18:49:06,044 -[line:96] - INFO: INTKPI_INX_TN_J004_ALL_FPY_20210812
2021-08-13 18:49:06,049 -[line:99] - ERROR: File:[D:\Project\source\dataproviderapi\GetINTKPI.py] , Line:199 , in _getFPYData : [KeyError] J004
2021-08-13 18:50:34,154 -[line:96] - INFO: INTKPI __init__
2021-08-13 18:50:34,155 -[line:96] - INFO: INTKPI getData Start
2021-08-13 18:50:34,155 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J004', 'APPLICATION': 'ALL', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210812'}
2021-08-13 18:50:34,159 -[line:96] - INFO: INTKPI_INX_TN_J004_ALL_FPY_20210812
2021-08-13 18:50:36,913 -[line:96] - INFO: 2
2021-08-13 18:50:47,612 -[line:96] - INFO: INTKPI __init__
2021-08-13 18:50:47,612 -[line:96] - INFO: INTKPI getData Start
2021-08-13 18:50:47,613 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J003', 'APPLICATION': 'ALL', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210812'}
2021-08-13 18:50:47,616 -[line:96] - INFO: INTKPI_INX_TN_J003_ALL_FPY_20210812
2021-08-13 18:50:50,237 -[line:99] - ERROR: File:[D:\Project\source\dataproviderapi\GetINTKPI.py] , Line:663 , in _calFPYData : [KeyError] IAVM
2021-08-13 18:51:38,667 -[line:96] - INFO: INTKPI __init__
2021-08-13 18:51:38,668 -[line:96] - INFO: INTKPI getData Start
2021-08-13 18:51:38,668 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J003', 'APPLICATION': 'ALL', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210812'}
2021-08-13 18:51:38,672 -[line:96] - INFO: INTKPI_INX_TN_J003_ALL_FPY_20210812
2021-08-13 18:51:41,341 -[line:96] - INFO: [{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J003', 'PROD_NBR': 'GN116BCPB080S', 'ACCT_DATE': '2021-08-12', 'APPLICATION': 'NB', 'OPER': 'DKEN', 'PassSUMQty': 25, 'DeftSUMQty': 0, 'DEFECT_RATE': 0.0, 'FPY_RATE': 1.0}]
2021-08-13 18:51:41,342 -[line:96] - INFO: [{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J003', 'PROD_NBR': 'GN140HCAGK40S', 'ACCT_DATE': '2021-08-12', 'APPLICATION': 'NB', 'OPER': 'DKEN', 'PassSUMQty': 3094, 'DeftSUMQty': 0, 'DEFECT_RATE': 0.0, 'FPY_RATE': 1.0}]
2021-08-13 18:51:41,342 -[line:96] - INFO: [{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J003', 'PROD_NBR': 'GN140HCAK7L0S', 'ACCT_DATE': '2021-08-12', 'APPLICATION': 'NB', 'OPER': 'DKEN', 'PassSUMQty': 6331, 'DeftSUMQty': 0, 'DEFECT_RATE': 0.0, 'FPY_RATE': 1.0}]
2021-08-13 18:51:41,342 -[line:96] - INFO: [{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J003', 'PROD_NBR': 'GN140HCRL010S', 'ACCT_DATE': '2021-08-12', 'APPLICATION': 'NB', 'OPER': 'DKEN', 'PassSUMQty': 599, 'DeftSUMQty': 0, 'DEFECT_RATE': 0.0, 'FPY_RATE': 1.0}]
2021-08-13 18:51:41,344 -[line:96] - INFO: [{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J003', 'PROD_NBR': 'GN140HCRL020S', 'ACCT_DATE': '2021-08-12', 'APPLICATION': 'NB', 'OPER': 'DKEN', 'PassSUMQty': 794, 'DeftSUMQty': 0, 'DEFECT_RATE': 0.0, 'FPY_RATE': 1.0}]
2021-08-13 18:51:41,344 -[line:96] - INFO: [{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J003', 'PROD_NBR': 'GN140JCNS030S', 'ACCT_DATE': '2021-08-12', 'APPLICATION': 'NB', 'OPER': 'DKEN', 'PassSUMQty': 93, 'DeftSUMQty': 0, 'DEFECT_RATE': 0.0, 'FPY_RATE': 1.0}]
2021-08-13 18:51:41,344 -[line:96] - INFO: [{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J003', 'PROD_NBR': 'GN156BGAA240S', 'ACCT_DATE': '2021-08-12', 'APPLICATION': 'NB', 'OPER': 'DKEN', 'PassSUMQty': 19, 'DeftSUMQty': 0, 'DEFECT_RATE': 0.0, 'FPY_RATE': 1.0}]
2021-08-13 18:51:41,345 -[line:96] - INFO: [{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J003', 'PROD_NBR': 'GN156BGAA2X0S', 'ACCT_DATE': '2021-08-12', 'APPLICATION': 'NB', 'OPER': 'DKEN', 'PassSUMQty': 38, 'DeftSUMQty': 0, 'DEFECT_RATE': 0.0, 'FPY_RATE': 1.0}]
2021-08-13 18:51:41,345 -[line:96] - INFO: [{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J003', 'PROD_NBR': 'GN156BGAAQA0S', 'ACCT_DATE': '2021-08-12', 'APPLICATION': 'NB', 'OPER': 'DKEN', 'PassSUMQty': 14006, 'DeftSUMQty': 0, 'DEFECT_RATE': 0.0, 'FPY_RATE': 1.0}]
2021-08-13 18:51:41,346 -[line:96] - INFO: [{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J003', 'PROD_NBR': 'GN161HCAA240S', 'ACCT_DATE': '2021-08-12', 'APPLICATION': 'NB', 'OPER': 'DKEN', 'PassSUMQty': 188, 'DeftSUMQty': 0, 'DEFECT_RATE': 0.0, 'FPY_RATE': 1.0}]
2021-08-13 18:51:41,346 -[line:96] - INFO: [{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J003', 'PROD_NBR': 'GG121AGE0020S', 'ACCT_DATE': '2021-08-12', 'APPLICATION': 'IAVM', 'OPER': 'DKEN', 'PassSUMQty': 30, 'DeftSUMQty': 0, 'DEFECT_RATE': 0.0, 'FPY_RATE': 1.0}]
2021-08-13 18:51:41,390 -[line:96] - INFO: [{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J003', 'PROD_NBR': 'GG121S100060S', 'ACCT_DATE': '2021-08-12', 'APPLICATION': 'IAVM', 'OPER': 'DKEN', 'PassSUMQty': 2, 'DeftSUMQty': 0, 'DEFECT_RATE': 0.0, 'FPY_RATE': 1.0}]
2021-08-13 18:51:41,391 -[line:96] - INFO: [{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J003', 'PROD_NBR': 'GG154I10E040S', 'ACCT_DATE': '2021-08-12', 'APPLICATION': 'IAVM', 'OPER': 'DKEN', 'PassSUMQty': 90, 'DeftSUMQty': 0, 'DEFECT_RATE': 0.0, 'FPY_RATE': 1.0}]
2021-08-13 18:51:41,392 -[line:96] - INFO: [{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J003', 'PROD_NBR': 'GN116BCNA030S', 'ACCT_DATE': '2021-08-12', 'APPLICATION': 'NB', 'OPER': 'DKEN', 'PassSUMQty': 2, 'DeftSUMQty': 0, 'DEFECT_RATE': 0.0, 'FPY_RATE': 1.0}]
2021-08-13 18:51:41,392 -[line:96] - INFO: [{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J003', 'PROD_NBR': 'GN156BGAAER0S', 'ACCT_DATE': '2021-08-12', 'APPLICATION': 'NB', 'OPER': 'DKEN', 'PassSUMQty': 2, 'DeftSUMQty': 0, 'DEFECT_RATE': 0.0, 'FPY_RATE': 1.0}]
2021-08-13 18:51:41,393 -[line:96] - INFO: [{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J003', 'PROD_NBR': 'GN140HCA18L0S', 'ACCT_DATE': '2021-08-12', 'APPLICATION': 'NB', 'OPER': 'DKEN', 'PassSUMQty': 21, 'DeftSUMQty': 0, 'DEFECT_RATE': 0.0, 'FPY_RATE': 1.0}]
2021-08-13 18:51:41,394 -[line:96] - INFO: [{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J003', 'PROD_NBR': 'GN140HCA50B0S', 'ACCT_DATE': '2021-08-12', 'APPLICATION': 'NB', 'OPER': 'DKEN', 'PassSUMQty': 21, 'DeftSUMQty': 0, 'DEFECT_RATE': 0.0, 'FPY_RATE': 1.0}]
2021-08-13 18:51:41,394 -[line:96] - INFO: [{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J003', 'PROD_NBR': 'GN140HCA56A0S', 'ACCT_DATE': '2021-08-12', 'APPLICATION': 'NB', 'OPER': 'DKEN', 'PassSUMQty': 13, 'DeftSUMQty': 0, 'DEFECT_RATE': 0.0, 'FPY_RATE': 1.0}]
2021-08-13 18:51:41,395 -[line:96] - INFO: [{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J003', 'PROD_NBR': 'GN140HCNA0K0S', 'ACCT_DATE': '2021-08-12', 'APPLICATION': 'NB', 'OPER': 'DKEN', 'PassSUMQty': 19, 'DeftSUMQty': 0, 'DEFECT_RATE': 0.0, 'FPY_RATE': 1.0}]
2021-08-13 18:51:41,396 -[line:96] - INFO: [{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J003', 'PROD_NBR': 'GN156BGAA220S', 'ACCT_DATE': '2021-08-12', 'APPLICATION': 'NB', 'OPER': 'DKEN', 'PassSUMQty': 45, 'DeftSUMQty': 0, 'DEFECT_RATE': 0.0, 'FPY_RATE': 1.0}]
2021-08-13 18:51:41,396 -[line:96] - INFO: [{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J003', 'PROD_NBR': 'GN156BGAAA70S', 'ACCT_DATE': '2021-08-12', 'APPLICATION': 'NB', 'OPER': 'DKEN', 'PassSUMQty': 11, 'DeftSUMQty': 0, 'DEFECT_RATE': 0.0, 'FPY_RATE': 1.0}]
2021-08-13 18:51:41,397 -[line:96] - INFO: [{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J003', 'PROD_NBR': 'GN156BGAAS60S', 'ACCT_DATE': '2021-08-12', 'APPLICATION': 'NB', 'OPER': 'DKEN', 'PassSUMQty': 2, 'DeftSUMQty': 0, 'DEFECT_RATE': 0.0, 'FPY_RATE': 1.0}]
2021-08-13 18:51:41,398 -[line:96] - INFO: [{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J003', 'PROD_NBR': 'GN156HCNAL20S', 'ACCT_DATE': '2021-08-12', 'APPLICATION': 'NB', 'OPER': 'DKEN', 'PassSUMQty': 5, 'DeftSUMQty': 0, 'DEFECT_RATE': 0.0, 'FPY_RATE': 1.0}]
2021-08-13 18:51:41,399 -[line:99] - ERROR: File:[D:\Project\source\dataproviderapi\GetINTKPI.py] , Line:664 , in _calFPYData : [KeyError] IAVM
2021-08-13 18:52:33,346 -[line:96] - INFO: INTKPI __init__
2021-08-13 18:52:33,346 -[line:96] - INFO: INTKPI getData Start
2021-08-13 18:52:33,346 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J003', 'APPLICATION': 'ALL', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210812'}
2021-08-13 18:52:33,350 -[line:96] - INFO: INTKPI_INX_TN_J003_ALL_FPY_20210812
2021-08-13 18:52:35,954 -[line:99] - ERROR: File:[D:\Project\source\dataproviderapi\GetINTKPI.py] , Line:663 , in _calFPYData : [KeyError] IAVM
2021-08-13 18:53:23,628 -[line:96] - INFO: INTKPI __init__
2021-08-13 18:53:23,629 -[line:96] - INFO: INTKPI getData Start
2021-08-13 18:53:23,630 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J003', 'APPLICATION': 'ALL', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210812'}
2021-08-13 18:53:23,633 -[line:96] - INFO: INTKPI_INX_TN_J003_ALL_FPY_20210812
2021-08-13 18:53:26,339 -[line:96] - INFO: J003
2021-08-13 18:53:26,340 -[line:99] - ERROR: File:[D:\Project\source\dataproviderapi\GetINTKPI.py] , Line:665 , in _calFPYData : [KeyError] IAVM
2021-08-13 18:54:26,129 -[line:96] - INFO: INTKPI __init__
2021-08-13 18:54:26,129 -[line:96] - INFO: INTKPI getData Start
2021-08-13 18:54:26,130 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J003', 'APPLICATION': 'ALL', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210812'}
2021-08-13 18:54:26,133 -[line:96] - INFO: INTKPI_INX_TN_J003_ALL_FPY_20210812
2021-08-13 18:54:28,769 -[line:96] - INFO: {'FPY': {'limit': {'CE': {'qytlim': 3000, 'FPY': 0.95}, 'TABLET': {'qytlim': 3000, 'FPY': 0.9}, 'NB': {'qytlim': 3000, 'FPY': 0.94}}, 'numerator': {'PCBI': {'fromt': 1050, 'tot': 1310}, 'LAM': {'fromt': 1340, 'tot': 1399}, 'AAFC': {'fromt': 1400, 'tot': 1499}, 'CKEN': {'fromt': 1500, 'tot': 1699}, 'DKEN': {'fromt': 1700, 'tot': 1799}}, 'denominator': {'PCBI': [1300, 1301], 'LAM': [1355], 'AAFC': [1420], 'CKEN': [1600], 'DKEN': [1600]}}, 'M-SHIP': {'limit': {'CE': {'qytlim': 3000, 'FPT': 0.97}, 'TABLET': {'qytlim': 3000, 'FPT': 0.955}, 'NB': {'qytlim': 3000, 'FPT': 0.96}}, 'numerator': {}, 'denominator': {}}, 'EFA': {'limit': {'CE': {'qytlim': 1000, 'FPT': 0.003}, 'TABLET': {'qytlim': 1000, 'FPT': 0.003}, 'NB': {'qytlim': 1000, 'FPT': 0.003}}, 'numerator': {}, 'denominator': {}}}
2021-08-13 18:54:28,771 -[line:99] - ERROR: File:[D:\Project\source\dataproviderapi\GetINTKPI.py] , Line:665 , in _calFPYData : [KeyError] IAVM
2021-08-13 18:54:54,698 -[line:96] - INFO: INTKPI __init__
2021-08-13 18:54:54,699 -[line:96] - INFO: INTKPI getData Start
2021-08-13 18:54:54,700 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'APPLICATION': 'ALL', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210812'}
2021-08-13 18:54:54,703 -[line:96] - INFO: INTKPI_INX_TN_J001_ALL_FPY_20210812
2021-08-13 18:54:57,557 -[line:96] - INFO: {'FPY': {'limit': {'CE': {'qytlim': 3000, 'FPY': 0.95}, 'TABLET': {'qytlim': 3000, 'FPY': 0.9}, 'NB': {'qytlim': 3000, 'FPY': 0.94}}, 'numerator': {'PCBI': {'fromt': 1050, 'tot': 1310}, 'LAM': {'fromt': 1340, 'tot': 1399}, 'AAFC': {'fromt': 1400, 'tot': 1499}, 'CKEN': {'fromt': 1500, 'tot': 1699}, 'DKEN': {'fromt': 1700, 'tot': 1799}}, 'denominator': {'PCBI': [1300, 1301], 'LAM': [1355], 'AAFC': [1420], 'CKEN': [1600], 'DKEN': [1600]}}, 'M-SHIP': {'limit': {'CE': {'qytlim': 3000, 'FPT': 0.97}, 'TABLET': {'qytlim': 3000, 'FPT': 0.955}, 'NB': {'qytlim': 3000, 'FPT': 0.96}}, 'numerator': {}, 'denominator': {}}, 'EFA': {'limit': {'CE': {'qytlim': 1000, 'FPT': 0.003}, 'TABLET': {'qytlim': 1000, 'FPT': 0.003}, 'NB': {'qytlim': 1000, 'FPT': 0.003}}, 'numerator': {}, 'denominator': {}}}
2021-08-13 18:54:57,583 -[line:96] - INFO: 2
2021-08-13 18:55:04,136 -[line:96] - INFO: INTKPI __init__
2021-08-13 18:55:04,137 -[line:96] - INFO: INTKPI getData Start
2021-08-13 18:55:04,137 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J003', 'APPLICATION': 'ALL', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210812'}
2021-08-13 18:55:04,140 -[line:96] - INFO: INTKPI_INX_TN_J003_ALL_FPY_20210812
2021-08-13 18:55:07,304 -[line:96] - INFO: {'FPY': {'limit': {'CE': {'qytlim': 3000, 'FPY': 0.95}, 'TABLET': {'qytlim': 3000, 'FPY': 0.9}, 'NB': {'qytlim': 3000, 'FPY': 0.94}}, 'numerator': {'PCBI': {'fromt': 1050, 'tot': 1310}, 'LAM': {'fromt': 1340, 'tot': 1399}, 'AAFC': {'fromt': 1400, 'tot': 1499}, 'CKEN': {'fromt': 1500, 'tot': 1699}, 'DKEN': {'fromt': 1700, 'tot': 1799}}, 'denominator': {'PCBI': [1300, 1301], 'LAM': [1355], 'AAFC': [1420], 'CKEN': [1600], 'DKEN': [1600]}}, 'M-SHIP': {'limit': {'CE': {'qytlim': 3000, 'FPT': 0.97}, 'TABLET': {'qytlim': 3000, 'FPT': 0.955}, 'NB': {'qytlim': 3000, 'FPT': 0.96}}, 'numerator': {}, 'denominator': {}}, 'EFA': {'limit': {'CE': {'qytlim': 1000, 'FPT': 0.003}, 'TABLET': {'qytlim': 1000, 'FPT': 0.003}, 'NB': {'qytlim': 1000, 'FPT': 0.003}}, 'numerator': {}, 'denominator': {}}}
2021-08-13 18:55:07,305 -[line:99] - ERROR: File:[D:\Project\source\dataproviderapi\GetINTKPI.py] , Line:665 , in _calFPYData : [KeyError] IAVM
2021-08-13 18:55:13,686 -[line:96] - INFO: INTKPI __init__
2021-08-13 18:55:13,687 -[line:96] - INFO: INTKPI getData Start
2021-08-13 18:55:13,687 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J004', 'APPLICATION': 'ALL', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210812'}
2021-08-13 18:55:13,690 -[line:96] - INFO: INTKPI_INX_TN_J004_ALL_FPY_20210812
2021-08-13 18:55:16,146 -[line:96] - INFO: {'FPY': {'limit': {'CE': {'qytlim': 3000, 'FPY': 0.95}, 'TABLET': {'qytlim': 3000, 'FPY': 0.9}, 'NB': {'qytlim': 3000, 'FPY': 0.94}}, 'numerator': {'PCBI': {'fromt': 1050, 'tot': 1310}, 'LAM': {'fromt': 1340, 'tot': 1399}, 'AAFC': {'fromt': 1400, 'tot': 1499}, 'CKEN': {'fromt': 1500, 'tot': 1699}, 'DKEN': {'fromt': 1700, 'tot': 1799}}, 'denominator': {'PCBI': [1300, 1301], 'LAM': [1355], 'AAFC': [1420], 'CKEN': [1600], 'DKEN': [1600]}}, 'M-SHIP': {'limit': {'CE': {'qytlim': 3000, 'FPT': 0.97}, 'TABLET': {'qytlim': 3000, 'FPT': 0.955}, 'NB': {'qytlim': 3000, 'FPT': 0.96}}, 'numerator': {}, 'denominator': {}}, 'EFA': {'limit': {'CE': {'qytlim': 1000, 'FPT': 0.003}, 'TABLET': {'qytlim': 1000, 'FPT': 0.003}, 'NB': {'qytlim': 1000, 'FPT': 0.003}}, 'numerator': {}, 'denominator': {}}}
2021-08-13 18:55:16,154 -[line:96] - INFO: 2
2021-08-13 18:55:24,153 -[line:96] - INFO: INTKPI __init__
2021-08-13 18:55:24,154 -[line:96] - INFO: INTKPI getData Start
2021-08-13 18:55:24,154 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'M001', 'APPLICATION': 'ALL', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210812'}
2021-08-13 18:55:24,157 -[line:96] - INFO: INTKPI_INX_TN_M001_ALL_FPY_20210812
2021-08-13 18:55:24,161 -[line:99] - ERROR: File:[D:\Project\source\dataproviderapi\GetINTKPI.py] , Line:322 , in _getFPYData : [KeyError] M001
2021-08-13 18:55:46,083 -[line:96] - INFO: INTKPI __init__
2021-08-13 18:55:46,084 -[line:96] - INFO: INTKPI getData Start
2021-08-13 18:55:46,121 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'M011', 'APPLICATION': 'ALL', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210812'}
2021-08-13 18:55:46,125 -[line:96] - INFO: INTKPI_INX_TN_M011_ALL_FPY_20210812
2021-08-13 18:55:48,666 -[line:96] - INFO: {'FPY': {'limit': {'CE': {'qytlim': 3000, 'FPY': 0.95}, 'TABLET': {'qytlim': 3000, 'FPY': 0.9}, 'NB': {'qytlim': 3000, 'FPY': 0.94}}, 'numerator': {'PCBI': {'fromt': 1050, 'tot': 1310}, 'LAM': {'fromt': 1340, 'tot': 1399}, 'AAFC': {'fromt': 1400, 'tot': 1499}, 'CKEN': {'fromt': 1500, 'tot': 1699}, 'DKEN': {'fromt': 1700, 'tot': 1799}}, 'denominator': {'PCBI': [1300, 1301], 'LAM': [1355], 'AAFC': [1420], 'CKEN': [1600], 'DKEN': [1600]}}, 'M-SHIP': {'limit': {'CE': {'qytlim': 3000, 'FPT': 0.97}, 'TABLET': {'qytlim': 3000, 'FPT': 0.955}, 'NB': {'qytlim': 3000, 'FPT': 0.96}}, 'numerator': {}, 'denominator': {}}, 'EFA': {'limit': {'CE': {'qytlim': 1000, 'FPT': 0.003}, 'TABLET': {'qytlim': 1000, 'FPT': 0.003}, 'NB': {'qytlim': 1000, 'FPT': 0.003}}, 'numerator': {}, 'denominator': {}}}
2021-08-13 18:55:48,668 -[line:99] - ERROR: File:[D:\Project\source\dataproviderapi\GetINTKPI.py] , Line:665 , in _calFPYData : [KeyError] TV
2021-08-13 18:58:04,267 -[line:96] - INFO: INTKPI __init__
2021-08-13 18:58:04,267 -[line:96] - INFO: INTKPI getData Start
2021-08-13 18:58:04,267 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'M011', 'APPLICATION': 'ALL', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210812'}
2021-08-13 18:58:04,271 -[line:96] - INFO: INTKPI_INX_TN_M011_ALL_FPY_20210812
2021-08-13 18:58:06,951 -[line:96] - INFO: {'FPY': {'limit': {'CE': {'qytlim': 3000, 'FPY': 0.95}, 'TABLET': {'qytlim': 3000, 'FPY': 0.9}, 'NB': {'qytlim': 3000, 'FPY': 0.94}}, 'numerator': {'PCBI': {'fromt': 1050, 'tot': 1310}, 'LAM': {'fromt': 1340, 'tot': 1399}, 'AAFC': {'fromt': 1400, 'tot': 1499}, 'CKEN': {'fromt': 1500, 'tot': 1699}, 'DKEN': {'fromt': 1700, 'tot': 1799}}, 'denominator': {'PCBI': [1300, 1301], 'LAM': [1355], 'AAFC': [1420], 'CKEN': [1600], 'DKEN': [1600]}}, 'M-SHIP': {'limit': {'CE': {'qytlim': 3000, 'FPT': 0.97}, 'TABLET': {'qytlim': 3000, 'FPT': 0.955}, 'NB': {'qytlim': 3000, 'FPT': 0.96}}, 'numerator': {}, 'denominator': {}}, 'EFA': {'limit': {'CE': {'qytlim': 1000, 'FPT': 0.003}, 'TABLET': {'qytlim': 1000, 'FPT': 0.003}, 'NB': {'qytlim': 1000, 'FPT': 0.003}}, 'numerator': {}, 'denominator': {}}}
2021-08-13 18:58:06,952 -[line:99] - ERROR: File:[D:\Project\source\dataproviderapi\GetINTKPI.py] , Line:671 , in _calFPYData : [KeyError] TV
2021-08-13 18:58:17,818 -[line:96] - INFO: INTKPI __init__
2021-08-13 18:58:17,819 -[line:96] - INFO: INTKPI getData Start
2021-08-13 18:58:17,819 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'M011', 'APPLICATION': 'ALL', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210812'}
2021-08-13 18:58:17,823 -[line:96] - INFO: INTKPI_INX_TN_M011_ALL_FPY_20210812
2021-08-13 18:58:20,402 -[line:96] - INFO: {'FPY': {'limit': {'CE': {'qytlim': 3000, 'FPY': 0.95}, 'TABLET': {'qytlim': 3000, 'FPY': 0.9}, 'NB': {'qytlim': 3000, 'FPY': 0.94}}, 'numerator': {'PCBI': {'fromt': 1050, 'tot': 1310}, 'LAM': {'fromt': 1340, 'tot': 1399}, 'AAFC': {'fromt': 1400, 'tot': 1499}, 'CKEN': {'fromt': 1500, 'tot': 1699}, 'DKEN': {'fromt': 1700, 'tot': 1799}}, 'denominator': {'PCBI': [1300, 1301], 'LAM': [1355], 'AAFC': [1420], 'CKEN': [1600], 'DKEN': [1600]}}, 'M-SHIP': {'limit': {'CE': {'qytlim': 3000, 'FPT': 0.97}, 'TABLET': {'qytlim': 3000, 'FPT': 0.955}, 'NB': {'qytlim': 3000, 'FPT': 0.96}}, 'numerator': {}, 'denominator': {}}, 'EFA': {'limit': {'CE': {'qytlim': 1000, 'FPT': 0.003}, 'TABLET': {'qytlim': 1000, 'FPT': 0.003}, 'NB': {'qytlim': 1000, 'FPT': 0.003}}, 'numerator': {}, 'denominator': {}}}
2021-08-13 18:58:20,403 -[line:99] - ERROR: File:[D:\Project\source\dataproviderapi\GetINTKPI.py] , Line:671 , in _calFPYData : [KeyError] TV
2021-08-13 18:59:58,077 -[line:96] - INFO: INTKPI __init__
2021-08-13 18:59:58,078 -[line:96] - INFO: INTKPI getData Start
2021-08-13 18:59:58,078 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'M011', 'APPLICATION': 'ALL', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210812'}
2021-08-13 18:59:58,082 -[line:96] - INFO: INTKPI_INX_TN_M011_ALL_FPY_20210812
2021-08-13 19:00:00,707 -[line:96] - INFO: {'FPY': {'limit': {'CE': {'qytlim': 3000, 'FPY': 0.95}, 'TABLET': {'qytlim': 3000, 'FPY': 0.9}, 'NB': {'qytlim': 3000, 'FPY': 0.94}, 'TV': {'qytlim': 3000, 'FPY': 0.9}, 'AA': {'qytlim': 3000, 'FPY': 0.95}}, 'numerator': {'PCBI': {'fromt': 1050, 'tot': 1310}, 'LAM': {'fromt': 1340, 'tot': 1399}, 'AAFC': {'fromt': 1400, 'tot': 1499}, 'CKEN': {'fromt': 1500, 'tot': 1699}, 'DKEN': {'fromt': 1700, 'tot': 1799}}, 'denominator': {'PCBI': [1300, 1301], 'LAM': [1355], 'AAFC': [1420], 'CKEN': [1600], 'DKEN': [1600]}}, 'M-SHIP': {'limit': {'CE': {'qytlim': 3000, 'FPT': 0.97}, 'TABLET': {'qytlim': 3000, 'FPT': 0.955}, 'NB': {'qytlim': 3000, 'FPT': 0.96}, 'TV': {'qytlim': 3000, 'FPY': 0.9}, 'AA': {'qytlim': 3000, 'FPY': 0.95}}, 'numerator': {}, 'denominator': {}}, 'EFA': {'limit': {'CE': {'qytlim': 1000, 'FPT': 0.003}, 'TABLET': {'qytlim': 1000, 'FPT': 0.003}, 'NB': {'qytlim': 1000, 'FPT': 0.003}, 'TV': {'qytlim': 3000, 'FPY': 0.003}, 'AA': {'qytlim': 3000, 'FPY': 0.003}}, 'numerator': {}, 'denominator': {}}}
2021-08-13 19:00:00,709 -[line:99] - ERROR: File:[D:\Project\source\dataproviderapi\GetINTKPI.py] , Line:689 , in _calFPYData : [KeyError] IAVM
2021-08-13 19:15:26,115 -[line:96] - INFO: INTKPI __init__
2021-08-13 19:15:26,117 -[line:96] - INFO: INTKPI getData Start
2021-08-13 19:15:26,117 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'M011', 'APPLICATION': 'ALL', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210812'}
2021-08-13 19:15:26,121 -[line:96] - INFO: INTKPI_INX_TN_M011_ALL_FPY_20210812
2021-08-13 19:15:28,690 -[line:99] - ERROR: File:[D:\Project\source\dataproviderapi\GetINTKPI.py] , Line:691 , in _calFPYData : [KeyError] TV
2021-08-13 19:16:22,080 -[line:96] - INFO: INTKPI __init__
2021-08-13 19:16:22,081 -[line:96] - INFO: INTKPI getData Start
2021-08-13 19:16:22,081 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J003', 'APPLICATION': 'ALL', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-13 19:16:22,086 -[line:96] - INFO: INTKPI_INX_TN_J003_ALL_FPY_20210801
2021-08-13 19:16:22,644 -[line:99] - ERROR: File:[D:\Project\source\dataproviderapi\GetINTKPI.py] , Line:572 , in _groupPassDeftByPRODandOPER : [KeyError] APPLICATION
2021-08-13 19:16:35,220 -[line:96] - INFO: INTKPI __init__
2021-08-13 19:16:35,220 -[line:96] - INFO: INTKPI getData Start
2021-08-13 19:16:35,221 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J003', 'APPLICATION': 'CE', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-13 19:16:35,239 -[line:96] - INFO: INTKPI_INX_TN_J003_CE_FPY_20210801
2021-08-13 19:16:37,737 -[line:96] - INFO: {'CE': {'qytlim': 3000, 'FPY': 0.95}}
2021-08-13 19:16:37,759 -[line:96] - INFO: 2
2021-08-13 19:16:48,483 -[line:96] - INFO: INTKPI __init__
2021-08-13 19:16:48,484 -[line:96] - INFO: INTKPI getData Start
2021-08-13 19:16:48,484 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J003', 'APPLICATION': 'TV', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-13 19:16:48,487 -[line:96] - INFO: INTKPI_INX_TN_J003_TV_FPY_20210801
2021-08-13 19:16:51,068 -[line:96] - INFO: {'TV': {'qytlim': 3000, 'FPY': 0.95}}
2021-08-13 19:16:51,088 -[line:96] - INFO: 2
2021-08-13 19:16:56,965 -[line:96] - INFO: INTKPI __init__
2021-08-13 19:16:56,966 -[line:96] - INFO: INTKPI getData Start
2021-08-13 19:16:56,966 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J003', 'APPLICATION': 'NB', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-13 19:16:56,970 -[line:96] - INFO: INTKPI_INX_TN_J003_NB_FPY_20210801
2021-08-13 19:16:59,547 -[line:96] - INFO: {'NB': {'qytlim': 3000, 'FPY': 0.95}}
2021-08-13 19:16:59,558 -[line:96] - INFO: 2
2021-08-13 19:17:15,899 -[line:96] - INFO: INTKPI __init__
2021-08-13 19:17:15,900 -[line:96] - INFO: INTKPI getData Start
2021-08-13 19:17:15,900 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J003', 'APPLICATION': 'TABLET', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-13 19:17:15,903 -[line:96] - INFO: INTKPI_INX_TN_J003_TABLET_FPY_20210801
2021-08-13 19:17:18,473 -[line:96] - INFO: {'TABLET': {'qytlim': 3000, 'FPY': 0.95}}
2021-08-13 19:17:18,497 -[line:96] - INFO: 2
2021-08-13 19:17:24,273 -[line:96] - INFO: INTKPI __init__
2021-08-13 19:17:24,273 -[line:96] - INFO: INTKPI getData Start
2021-08-13 19:17:24,274 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J003', 'APPLICATION': 'ALL', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-13 19:17:24,278 -[line:96] - INFO: INTKPI_INX_TN_J003_ALL_FPY_20210801
2021-08-13 19:17:24,785 -[line:99] - ERROR: File:[D:\Project\source\dataproviderapi\GetINTKPI.py] , Line:572 , in _groupPassDeftByPRODandOPER : [KeyError] APPLICATION
2021-08-13 19:20:48,600 -[line:96] - INFO: INTKPI __init__
2021-08-13 19:20:48,601 -[line:96] - INFO: INTKPI getData Start
2021-08-13 19:20:48,601 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J003', 'APPLICATION': 'ALL', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-13 19:20:48,605 -[line:96] - INFO: INTKPI_INX_TN_J003_ALL_FPY_20210801
2021-08-13 19:20:51,282 -[line:96] - INFO: {'ALL': {'qytlim': 3000, 'FPY': 0.95}}
2021-08-13 19:20:51,283 -[line:99] - ERROR: File:[D:\Project\source\dataproviderapi\GetINTKPI.py] , Line:696 , in _calFPYData : [KeyError] IAVM
2021-08-13 19:27:38,520 -[line:96] - INFO: INTKPI __init__
2021-08-13 19:27:38,521 -[line:96] - INFO: INTKPI getData Start
2021-08-13 19:27:38,521 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J003', 'APPLICATION': 'ALL', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-13 19:30:59,932 -[line:96] - INFO: INTKPI __init__
2021-08-13 19:30:59,932 -[line:96] - INFO: INTKPI getData Start
2021-08-13 19:30:59,932 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J003', 'APPLICATION': 'ALL', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-13 19:31:07,240 -[line:96] - INFO: INTKPI __init__
2021-08-13 19:31:07,240 -[line:96] - INFO: INTKPI getData Start
2021-08-13 19:31:07,240 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'QQQ', 'APPLICATION': 'ALL', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-13 19:31:18,403 -[line:96] - INFO: INTKPI __init__
2021-08-13 19:31:18,404 -[line:96] - INFO: INTKPI getData Start
2021-08-13 19:31:18,404 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'M011', 'APPLICATION': 'ALL', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-13 19:32:12,577 -[line:96] - INFO: INTKPI __init__
2021-08-13 19:32:12,578 -[line:96] - INFO: INTKPI getData Start
2021-08-13 19:32:12,578 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J004', 'APPLICATION': 'ALL', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-13 19:35:33,976 -[line:96] - INFO: INTKPI __init__
2021-08-13 19:35:33,977 -[line:96] - INFO: INTKPI getData Start
2021-08-13 19:35:33,977 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J004', 'APPLICATION': 'ALL', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-14 08:35:09,198 -[line:96] - INFO: INTKPI __init__
2021-08-14 08:35:09,202 -[line:96] - INFO: INTKPI getData Start
2021-08-14 08:35:09,202 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'APPLICATION': 'ALL', 'KPITYPE': 'MSHIP', 'ACCT_DATE': '20210801'}
2021-08-14 08:36:16,723 -[line:96] - INFO: INTKPI __init__
2021-08-14 08:36:16,724 -[line:96] - INFO: INTKPI getData Start
2021-08-14 08:36:16,724 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'APPLICATION': 'ALL', 'KPITYPE': 'MSHIP', 'ACCT_DATE': '20210801'}
2021-08-14 08:36:16,730 -[line:96] - INFO: [{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['INT0', 'LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION', 'PROD_NBR': '$PROD_NBR'}, 'TOBESCRAP_QTY': {'$sum': {'$toInt': '$TOBESCRAP_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$APPLICATION', 'SITE': '$ACCT_DATE', 'FACTORY_ID': '$_id.PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION', 'PROD_NBR': '$PROD_NBR', 'TOBESCRAP_SUMQTY': '$TOBESCRAP_QTY'}}, {'$sort': {'_id.SCRAP_CODE': 1, '_id.RESP_OWNER': 1}}]
2021-08-14 08:36:16,731 -[line:96] - INFO: [{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'TRANS_TYPE': 'SHIP', 'LCM_OWNER': {'$in': ['INT0', 'LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION', 'PROD_NBR': '$PROD_NBR'}, 'SHIPSUM': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'APPLICATION': '$APPLICATION', 'ACCT_DATE': '$ACCT_DATE', 'PROD_NBR': '$_id.PROD_NBR', 'SHIP_SUMQTY': '$SHIPSUM'}}, {'$sort': {'APPLICATION': 1, 'ACCT_DATE': 1, 'PROD_NBR': 1}}]
2021-08-14 08:36:16,732 -[line:96] - INFO: [{'$match': {'COMPANY_CODE': 'INX', 'FACTORY_ID': 'J001', 'SITE': 'TN', 'ACCT_DATE': '20210801', 'MAIN_WC': {'$in': ['1600']}, 'LCM_OWNER': {'$in': ['INT0', 'LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'APPLICATION': '$APPLICATION', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE'}, 'DOWNGRADE_QTY': {'$sum': {'$cond': [{'$eq': ['$IS_DOWNGRADE', 'Y']}, {'$toInt': '$QTY'}, {'$toInt': 0}]}}, 'TOTAL_QTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'APPLICATION': '$_id.APPLICATION', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROD_NBR': '$_id.PROD_NBR', 'DOWNGRADE_SUMQTY': '$PassSUMQty', 'TOTAL_SUMQTY': '$PassSUMQty'}}, {'$sort': {'APPLICATION': 1, 'ACCT_DATE': 1, 'PROD_NBR': 1}}]
2021-08-14 08:40:15,028 -[line:96] - INFO: INTKPI __init__
2021-08-14 08:40:15,029 -[line:96] - INFO: INTKPI getData Start
2021-08-14 08:40:15,029 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'APPLICATION': 'ALL', 'KPITYPE': 'MSHIP', 'ACCT_DATE': '20210801'}
2021-08-14 08:40:15,056 -[line:96] - INFO: [{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['INT0', 'LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION', 'PROD_NBR': '$PROD_NBR'}, 'TOBESCRAP_QTY': {'$sum': {'$toInt': '$TOBESCRAP_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$APPLICATION', 'SITE': '$ACCT_DATE', 'FACTORY_ID': '$_id.PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION', 'PROD_NBR': '$PROD_NBR', 'TOBESCRAP_SUMQTY': '$TOBESCRAP_QTY'}}, {'$sort': {'_id.SCRAP_CODE': 1, '_id.RESP_OWNER': 1}}]
2021-08-14 08:40:15,057 -[line:96] - INFO: [{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'TRANS_TYPE': 'SHIP', 'LCM_OWNER': {'$in': ['INT0', 'LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION', 'PROD_NBR': '$PROD_NBR'}, 'SHIPSUM': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'APPLICATION': '$APPLICATION', 'ACCT_DATE': '$ACCT_DATE', 'PROD_NBR': '$_id.PROD_NBR', 'SHIP_SUMQTY': '$SHIPSUM'}}, {'$sort': {'APPLICATION': 1, 'ACCT_DATE': 1, 'PROD_NBR': 1}}]
2021-08-14 08:40:15,057 -[line:96] - INFO: [{'$match': {'COMPANY_CODE': 'INX', 'FACTORY_ID': 'J001', 'SITE': 'TN', 'ACCT_DATE': '20210801', 'MAIN_WC': {'$in': ['1600']}, 'LCM_OWNER': {'$in': ['INT0', 'LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'APPLICATION': '$APPLICATION', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE'}, 'DOWNGRADE_SUMQTY': {'$sum': {'$cond': [{'$eq': ['$IS_DOWNGRADE', 'Y']}, {'$toInt': '$QTY'}, {'$toInt': 0}]}}, 'TOTAL_SUMQTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'APPLICATION': '$_id.APPLICATION', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROD_NBR': '$_id.PROD_NBR', 'DOWNGRADE_SUMQTY': '$PassSUMQty', 'TOTAL_SUMQTY': '$PassSUMQty'}}, {'$sort': {'APPLICATION': 1, 'ACCT_DATE': 1, 'PROD_NBR': 1}}]
2021-08-14 08:41:21,000 -[line:96] - INFO: INTKPI __init__
2021-08-14 08:41:21,000 -[line:96] - INFO: INTKPI getData Start
2021-08-14 08:41:21,001 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'APPLICATION': 'ALL', 'KPITYPE': 'MSHIP', 'ACCT_DATE': '20210801'}
2021-08-14 08:41:21,007 -[line:96] - INFO: [{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['INT0', 'LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION', 'PROD_NBR': '$PROD_NBR'}, 'TOBESCRAP_QTY': {'$sum': {'$toInt': '$TOBESCRAP_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$APPLICATION', 'SITE': '$ACCT_DATE', 'FACTORY_ID': '$_id.PROD_NBR', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION', 'PROD_NBR': '$PROD_NBR', 'TOBESCRAP_SUMQTY': '$TOBESCRAP_QTY'}}, {'$sort': {'_id.SCRAP_CODE': 1, '_id.RESP_OWNER': 1}}]
2021-08-14 08:41:21,007 -[line:96] - INFO: [{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'TRANS_TYPE': 'SHIP', 'LCM_OWNER': {'$in': ['INT0', 'LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION', 'PROD_NBR': '$PROD_NBR'}, 'SHIPSUM': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'APPLICATION': '$APPLICATION', 'ACCT_DATE': '$ACCT_DATE', 'PROD_NBR': '$_id.PROD_NBR', 'SHIP_SUMQTY': '$SHIPSUM'}}, {'$sort': {'APPLICATION': 1, 'ACCT_DATE': 1, 'PROD_NBR': 1}}]
2021-08-14 08:41:21,008 -[line:96] - INFO: [{'$match': {'COMPANY_CODE': 'INX', 'FACTORY_ID': 'J001', 'SITE': 'TN', 'ACCT_DATE': '20210801', 'MAIN_WC': {'$in': ['1600']}, 'LCM_OWNER': {'$in': ['INT0', 'LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'APPLICATION': '$APPLICATION', 'PROD_NBR': '$PROD_NBR', 'ACCT_DATE': '$ACCT_DATE'}, 'DOWNGRADE_SUMQTY': {'$sum': {'$cond': [{'$eq': ['$IS_DOWNGRADE', 'Y']}, {'$toInt': '$QTY'}, {'$toInt': 0}]}}, 'TOTAL_SUMQTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'APPLICATION': '$_id.APPLICATION', 'ACCT_DATE': '$_id.ACCT_DATE', 'PROD_NBR': '$_id.PROD_NBR', 'DOWNGRADE_SUMQTY': '$DOWNGRADE_SUMQTY', 'TOTAL_SUMQTY': '$TOTAL_SUMQTY'}}, {'$sort': {'APPLICATION': 1, 'ACCT_DATE': 1, 'PROD_NBR': 1}}]
2021-08-14 08:54:50,160 -[line:96] - INFO: INTKPI __init__
2021-08-14 08:54:50,160 -[line:96] - INFO: INTKPI getData Start
2021-08-14 08:54:50,161 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'APPLICATION': 'ALL', 'KPITYPE': 'MSHIP', 'ACCT_DATE': '20210801'}
2021-08-14 08:54:50,167 -[line:96] - INFO: [{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['INT0', 'LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION', 'PROD_NBR': '$PROD_NBR'}, 'TOBESCRAP_QTY': {'$sum': {'$toInt': '$TOBESCRAP_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'PROD_NBR': '$_id.PROD_NBR', 'TOBESCRAP_SUMQTY': '$TOBESCRAP_QTY'}}, {'$sort': {'_id.SCRAP_CODE': 1, '_id.RESP_OWNER': 1}}]
2021-08-14 08:54:50,168 -[line:96] - INFO: [{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'TRANS_TYPE': 'SHIP', 'LCM_OWNER': {'$in': ['INT0', 'LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION', 'PROD_NBR': '$PROD_NBR'}, 'SHIPSUM': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'PROD_NBR': '$_id.PROD_NBR', 'SHIP_SUMQTY': '$SHIPSUM'}}, {'$sort': {'APPLICATION': 1, 'ACCT_DATE': 1, 'PROD_NBR': 1}}]
2021-08-14 08:54:50,169 -[line:96] - INFO: [{'$match': {'COMPANY_CODE': 'INX', 'FACTORY_ID': 'J001', 'SITE': 'TN', 'ACCT_DATE': '20210801', 'MAIN_WC': {'$in': ['1600']}, 'LCM_OWNER': {'$in': ['INT0', 'LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION', 'PROD_NBR': '$PROD_NBR'}, 'DOWNGRADE_SUMQTY': {'$sum': {'$cond': [{'$eq': ['$IS_DOWNGRADE', 'Y']}, {'$toInt': '$QTY'}, {'$toInt': 0}]}}, 'TOTAL_SUMQTY': {'$sum': {'$toInt': '$QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'PROD_NBR': '$_id.PROD_NBR', 'DOWNGRADE_SUMQTY': '$DOWNGRADE_SUMQTY', 'TOTAL_SUMQTY': '$TOTAL_SUMQTY'}}, {'$sort': {'APPLICATION': 1, 'ACCT_DATE': 1, 'PROD_NBR': 1}}]
2021-08-14 10:20:59,409 -[line:96] - INFO: INTKPI __init__
2021-08-14 10:20:59,410 -[line:96] - INFO: INTKPI getData Start
2021-08-14 10:20:59,410 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'APPLICATION': 'ALL', 'KPITYPE': 'MSHIP', 'ACCT_DATE': '20210801'}
2021-08-14 10:58:17,034 -[line:96] - INFO: INTKPI __init__
2021-08-14 10:58:17,035 -[line:96] - INFO: INTKPI getData Start
2021-08-14 10:58:17,035 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'APPLICATION': 'ALL', 'KPITYPE': 'MSHIP', 'ACCT_DATE': '20210801'}
2021-08-14 10:58:17,190 -[line:96] - INFO: [{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'CE', 'PROD_NBR': 'GNJ101IA0030S', 'TOBESCRAP_SUMQTY': 0}, {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'CE', 'PROD_NBR': 'GP062CCAC100S', 'TOBESCRAP_SUMQTY': 0}, {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'CE', 'PROD_NBR': 'GP062CCAY010S', 'TOBESCRAP_SUMQTY': 0}, {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'CE', 'PROD_NBR': 'GP070BAGM050S', 'TOBESCRAP_SUMQTY': 0}, {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'CE', 'PROD_NBR': 'GZD070SA4030S', 'TOBESCRAP_SUMQTY': 0}, {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'CE', 'PROD_NBR': 'GZD070SA5010S', 'TOBESCRAP_SUMQTY': 0}, {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'CE', 'PROD_NBR': 'GZD070SAB020S', 'TOBESCRAP_SUMQTY': 0}, {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'CE', 'PROD_NBR': 'GZD080JAB010S', 'TOBESCRAP_SUMQTY': 0}, {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'CE', 'PROD_NBR': 'GZJ101IA0040S', 'TOBESCRAP_SUMQTY': 0}, {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'CE', 'PROD_NBR': 'GZJ101ZA3010S', 'TOBESCRAP_SUMQTY': 0}, {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'CE', 'PROD_NBR': 'GZJ140IAB010S', 'TOBESCRAP_SUMQTY': 0}, {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'NB', 'PROD_NBR': 'GN140HCNA050S', 'TOBESCRAP_SUMQTY': 0}, {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'TABLET', 'PROD_NBR': '2HE080IA1010S', 'TOBESCRAP_SUMQTY': 0}, {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'TABLET', 'PROD_NBR': '2P125ZZD0030M', 'TOBESCRAP_SUMQTY': 0}, {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'TABLET', 'PROD_NBR': 'GHD140ZB0000S', 'TOBESCRAP_SUMQTY': 0}, {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'TABLET', 'PROD_NBR': 'GP080DZD00B0S', 'TOBESCRAP_SUMQTY': 0}, {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'TABLET', 'PROD_NBR': 'GP080DZD00C0S', 'TOBESCRAP_SUMQTY': 0}, {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'TABLET', 'PROD_NBR': 'GP101KZD0200S', 'TOBESCRAP_SUMQTY': 0}, {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'TABLET', 'PROD_NBR': 'GP104ZZD0220S', 'TOBESCRAP_SUMQTY': 0}, {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'TABLET', 'PROD_NBR': 'GP104ZZD0240S', 'TOBESCRAP_SUMQTY': 0}, {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'TABLET', 'PROD_NBR': 'GP125ZZD0030S', 'TOBESCRAP_SUMQTY': 0}, {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'TABLET', 'PROD_NBR': 'GP125ZZD0040S', 'TOBESCRAP_SUMQTY': 0}, {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'TABLET', 'PROD_NBR': 'GP130ZFA0010S', 'TOBESCRAP_SUMQTY': 0}, {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'TABLET', 'PROD_NBR': 'GP130ZFZ1020S', 'TOBESCRAP_SUMQTY': 0}, {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'TABLET', 'PROD_NBR': 'GP140ZKA0040S', 'TOBESCRAP_SUMQTY': 0}, {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'TABLET', 'PROD_NBR': 'GP140ZKA0060S', 'TOBESCRAP_SUMQTY': 0}]
2021-08-14 10:58:17,250 -[line:96] - INFO: []
2021-08-14 10:58:17,250 -[line:96] - INFO: [{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'CE', 'PROD_NBR': 'GNJ101IA0030S', 'DOWNGRADE_SUMQTY': 0, 'TOTAL_SUMQTY': 33}, {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'CE', 'PROD_NBR': 'GP062CCAC100S', 'DOWNGRADE_SUMQTY': 1, 'TOTAL_SUMQTY': 16385}, {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'CE', 'PROD_NBR': 'GP062CCAY010S', 'DOWNGRADE_SUMQTY': 0, 'TOTAL_SUMQTY': 2006}, {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'CE', 'PROD_NBR': 'GP070BAGM050S', 'DOWNGRADE_SUMQTY': 0, 'TOTAL_SUMQTY': 628}, {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'CE', 'PROD_NBR': 'GZD070SA4030S', 'DOWNGRADE_SUMQTY': 0, 'TOTAL_SUMQTY': 1030}, {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'CE', 'PROD_NBR': 'GZD070SA5010S', 'DOWNGRADE_SUMQTY': 0, 'TOTAL_SUMQTY': 114}, {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'CE', 'PROD_NBR': 'GZJ101ZA3010S', 'DOWNGRADE_SUMQTY': 0, 'TOTAL_SUMQTY': 2}, {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'TABLET', 'PROD_NBR': 'GP080DZD00B0S', 'DOWNGRADE_SUMQTY': 12, 'TOTAL_SUMQTY': 1877}, {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'TABLET', 'PROD_NBR': 'GP080DZD00C0S', 'DOWNGRADE_SUMQTY': 0, 'TOTAL_SUMQTY': 91}, {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'TABLET', 'PROD_NBR': 'GP130ZFA0010S', 'DOWNGRADE_SUMQTY': 14, 'TOTAL_SUMQTY': 1289}, {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'TABLET', 'PROD_NBR': 'GP130ZFZ1020S', 'DOWNGRADE_SUMQTY': 4, 'TOTAL_SUMQTY': 223}, {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'TABLET', 'PROD_NBR': 'GP140ZKA0040S', 'DOWNGRADE_SUMQTY': 7, 'TOTAL_SUMQTY': 125}]
2021-08-14 10:58:17,253 -[line:96] - INFO: [{'PROD_NBR': 'GNJ101IA0030S', 'APPLICATION': 'CE'}, {'PROD_NBR': 'GP062CCAC100S', 'APPLICATION': 'CE'}, {'PROD_NBR': 'GP062CCAY010S', 'APPLICATION': 'CE'}, {'PROD_NBR': 'GP070BAGM050S', 'APPLICATION': 'CE'}, {'PROD_NBR': 'GZD070SA4030S', 'APPLICATION': 'CE'}, {'PROD_NBR': 'GZD070SA5010S', 'APPLICATION': 'CE'}, {'PROD_NBR': 'GZJ101ZA3010S', 'APPLICATION': 'CE'}, {'PROD_NBR': 'GP080DZD00B0S', 'APPLICATION': 'TABLET'}, {'PROD_NBR': 'GP080DZD00C0S', 'APPLICATION': 'TABLET'}, {'PROD_NBR': 'GP130ZFA0010S', 'APPLICATION': 'TABLET'}, {'PROD_NBR': 'GP130ZFZ1020S', 'APPLICATION': 'TABLET'}, {'PROD_NBR': 'GP140ZKA0040S', 'APPLICATION': 'TABLET'}]
2021-08-14 10:58:17,254 -[line:96] - INFO: [{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'CE', 'PROD_NBR': 'GNJ101IA0030S', 'TOBESCRAP_SUMQTY': 0}]
2021-08-14 10:58:17,254 -[line:96] - INFO: []
2021-08-14 10:58:17,254 -[line:96] - INFO: [{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'CE', 'PROD_NBR': 'GNJ101IA0030S', 'DOWNGRADE_SUMQTY': 0, 'TOTAL_SUMQTY': 33}]
2021-08-14 10:58:17,255 -[line:96] - INFO: [{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'CE', 'PROD_NBR': 'GP062CCAC100S', 'TOBESCRAP_SUMQTY': 0}]
2021-08-14 10:58:17,255 -[line:96] - INFO: []
2021-08-14 10:58:17,255 -[line:96] - INFO: [{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'CE', 'PROD_NBR': 'GP062CCAC100S', 'DOWNGRADE_SUMQTY': 1, 'TOTAL_SUMQTY': 16385}]
2021-08-14 10:58:17,256 -[line:96] - INFO: [{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'CE', 'PROD_NBR': 'GP062CCAY010S', 'TOBESCRAP_SUMQTY': 0}]
2021-08-14 10:58:17,256 -[line:96] - INFO: []
2021-08-14 10:58:17,257 -[line:96] - INFO: [{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'CE', 'PROD_NBR': 'GP062CCAY010S', 'DOWNGRADE_SUMQTY': 0, 'TOTAL_SUMQTY': 2006}]
2021-08-14 10:58:17,257 -[line:96] - INFO: [{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'CE', 'PROD_NBR': 'GP070BAGM050S', 'TOBESCRAP_SUMQTY': 0}]
2021-08-14 10:58:17,257 -[line:96] - INFO: []
2021-08-14 10:58:17,258 -[line:96] - INFO: [{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'CE', 'PROD_NBR': 'GP070BAGM050S', 'DOWNGRADE_SUMQTY': 0, 'TOTAL_SUMQTY': 628}]
2021-08-14 10:58:17,258 -[line:96] - INFO: [{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'CE', 'PROD_NBR': 'GZD070SA4030S', 'TOBESCRAP_SUMQTY': 0}]
2021-08-14 10:58:17,258 -[line:96] - INFO: []
2021-08-14 10:58:17,259 -[line:96] - INFO: [{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'CE', 'PROD_NBR': 'GZD070SA4030S', 'DOWNGRADE_SUMQTY': 0, 'TOTAL_SUMQTY': 1030}]
2021-08-14 10:58:17,259 -[line:96] - INFO: [{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'CE', 'PROD_NBR': 'GZD070SA5010S', 'TOBESCRAP_SUMQTY': 0}]
2021-08-14 10:58:17,259 -[line:96] - INFO: []
2021-08-14 10:58:17,259 -[line:96] - INFO: [{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'CE', 'PROD_NBR': 'GZD070SA5010S', 'DOWNGRADE_SUMQTY': 0, 'TOTAL_SUMQTY': 114}]
2021-08-14 10:58:17,260 -[line:96] - INFO: [{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'CE', 'PROD_NBR': 'GZJ101ZA3010S', 'TOBESCRAP_SUMQTY': 0}]
2021-08-14 10:58:17,260 -[line:96] - INFO: []
2021-08-14 10:58:17,260 -[line:96] - INFO: [{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'CE', 'PROD_NBR': 'GZJ101ZA3010S', 'DOWNGRADE_SUMQTY': 0, 'TOTAL_SUMQTY': 2}]
2021-08-14 10:58:17,261 -[line:96] - INFO: [{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'TABLET', 'PROD_NBR': 'GP080DZD00B0S', 'TOBESCRAP_SUMQTY': 0}]
2021-08-14 10:58:17,261 -[line:96] - INFO: []
2021-08-14 10:58:17,261 -[line:96] - INFO: [{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'TABLET', 'PROD_NBR': 'GP080DZD00B0S', 'DOWNGRADE_SUMQTY': 12, 'TOTAL_SUMQTY': 1877}]
2021-08-14 10:58:17,262 -[line:96] - INFO: [{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'TABLET', 'PROD_NBR': 'GP080DZD00C0S', 'TOBESCRAP_SUMQTY': 0}]
2021-08-14 10:58:17,262 -[line:96] - INFO: []
2021-08-14 10:58:17,262 -[line:96] - INFO: [{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'TABLET', 'PROD_NBR': 'GP080DZD00C0S', 'DOWNGRADE_SUMQTY': 0, 'TOTAL_SUMQTY': 91}]
2021-08-14 10:58:17,262 -[line:96] - INFO: [{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'TABLET', 'PROD_NBR': 'GP130ZFA0010S', 'TOBESCRAP_SUMQTY': 0}]
2021-08-14 10:58:17,263 -[line:96] - INFO: []
2021-08-14 10:58:17,263 -[line:96] - INFO: [{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'TABLET', 'PROD_NBR': 'GP130ZFA0010S', 'DOWNGRADE_SUMQTY': 14, 'TOTAL_SUMQTY': 1289}]
2021-08-14 10:58:17,263 -[line:96] - INFO: [{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'TABLET', 'PROD_NBR': 'GP130ZFZ1020S', 'TOBESCRAP_SUMQTY': 0}]
2021-08-14 10:58:17,264 -[line:96] - INFO: []
2021-08-14 10:58:17,264 -[line:96] - INFO: [{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'TABLET', 'PROD_NBR': 'GP130ZFZ1020S', 'DOWNGRADE_SUMQTY': 4, 'TOTAL_SUMQTY': 223}]
2021-08-14 10:58:17,264 -[line:96] - INFO: [{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'TABLET', 'PROD_NBR': 'GP140ZKA0040S', 'TOBESCRAP_SUMQTY': 0}]
2021-08-14 10:58:17,265 -[line:96] - INFO: []
2021-08-14 10:58:17,265 -[line:96] - INFO: [{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'TABLET', 'PROD_NBR': 'GP140ZKA0040S', 'DOWNGRADE_SUMQTY': 7, 'TOTAL_SUMQTY': 125}]
2021-08-14 10:59:03,786 -[line:96] - INFO: INTKPI __init__
2021-08-14 10:59:03,786 -[line:96] - INFO: INTKPI getData Start
2021-08-14 10:59:03,786 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'APPLICATION': 'ALL', 'KPITYPE': 'MSHIP', 'ACCT_DATE': '20210801'}
2021-08-14 10:59:03,954 -[line:96] - INFO: [{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'CE', 'PROD_NBR': 'GNJ101IA0030S', 'TOBESCRAP_SUMQTY': 0}, {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'CE', 'PROD_NBR': 'GP062CCAC100S', 'TOBESCRAP_SUMQTY': 0}, {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'CE', 'PROD_NBR': 'GP062CCAY010S', 'TOBESCRAP_SUMQTY': 0}, {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'CE', 'PROD_NBR': 'GP070BAGM050S', 'TOBESCRAP_SUMQTY': 0}, {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'CE', 'PROD_NBR': 'GZD070SA4030S', 'TOBESCRAP_SUMQTY': 0}, {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'CE', 'PROD_NBR': 'GZD070SA5010S', 'TOBESCRAP_SUMQTY': 0}, {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'CE', 'PROD_NBR': 'GZD070SAB020S', 'TOBESCRAP_SUMQTY': 0}, {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'CE', 'PROD_NBR': 'GZD080JAB010S', 'TOBESCRAP_SUMQTY': 0}, {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'CE', 'PROD_NBR': 'GZJ101IA0040S', 'TOBESCRAP_SUMQTY': 0}, {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'CE', 'PROD_NBR': 'GZJ101ZA3010S', 'TOBESCRAP_SUMQTY': 0}, {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'CE', 'PROD_NBR': 'GZJ140IAB010S', 'TOBESCRAP_SUMQTY': 0}, {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'NB', 'PROD_NBR': 'GN140HCNA050S', 'TOBESCRAP_SUMQTY': 0}, {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'TABLET', 'PROD_NBR': '2HE080IA1010S', 'TOBESCRAP_SUMQTY': 0}, {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'TABLET', 'PROD_NBR': '2P125ZZD0030M', 'TOBESCRAP_SUMQTY': 0}, {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'TABLET', 'PROD_NBR': 'GHD140ZB0000S', 'TOBESCRAP_SUMQTY': 0}, {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'TABLET', 'PROD_NBR': 'GP080DZD00B0S', 'TOBESCRAP_SUMQTY': 0}, {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'TABLET', 'PROD_NBR': 'GP080DZD00C0S', 'TOBESCRAP_SUMQTY': 0}, {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'TABLET', 'PROD_NBR': 'GP101KZD0200S', 'TOBESCRAP_SUMQTY': 0}, {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'TABLET', 'PROD_NBR': 'GP104ZZD0220S', 'TOBESCRAP_SUMQTY': 0}, {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'TABLET', 'PROD_NBR': 'GP104ZZD0240S', 'TOBESCRAP_SUMQTY': 0}, {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'TABLET', 'PROD_NBR': 'GP125ZZD0030S', 'TOBESCRAP_SUMQTY': 0}, {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'TABLET', 'PROD_NBR': 'GP125ZZD0040S', 'TOBESCRAP_SUMQTY': 0}, {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'TABLET', 'PROD_NBR': 'GP130ZFA0010S', 'TOBESCRAP_SUMQTY': 0}, {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'TABLET', 'PROD_NBR': 'GP130ZFZ1020S', 'TOBESCRAP_SUMQTY': 0}, {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'TABLET', 'PROD_NBR': 'GP140ZKA0040S', 'TOBESCRAP_SUMQTY': 0}, {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'TABLET', 'PROD_NBR': 'GP140ZKA0060S', 'TOBESCRAP_SUMQTY': 0}]
2021-08-14 10:59:03,957 -[line:96] - INFO: []
2021-08-14 10:59:03,958 -[line:96] - INFO: [{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'CE', 'PROD_NBR': 'GNJ101IA0030S', 'DOWNGRADE_SUMQTY': 0, 'TOTAL_SUMQTY': 33}, {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'CE', 'PROD_NBR': 'GP062CCAC100S', 'DOWNGRADE_SUMQTY': 1, 'TOTAL_SUMQTY': 16385}, {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'CE', 'PROD_NBR': 'GP062CCAY010S', 'DOWNGRADE_SUMQTY': 0, 'TOTAL_SUMQTY': 2006}, {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'CE', 'PROD_NBR': 'GP070BAGM050S', 'DOWNGRADE_SUMQTY': 0, 'TOTAL_SUMQTY': 628}, {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'CE', 'PROD_NBR': 'GZD070SA4030S', 'DOWNGRADE_SUMQTY': 0, 'TOTAL_SUMQTY': 1030}, {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'CE', 'PROD_NBR': 'GZD070SA5010S', 'DOWNGRADE_SUMQTY': 0, 'TOTAL_SUMQTY': 114}, {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'CE', 'PROD_NBR': 'GZJ101ZA3010S', 'DOWNGRADE_SUMQTY': 0, 'TOTAL_SUMQTY': 2}, {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'TABLET', 'PROD_NBR': 'GP080DZD00B0S', 'DOWNGRADE_SUMQTY': 12, 'TOTAL_SUMQTY': 1877}, {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'TABLET', 'PROD_NBR': 'GP080DZD00C0S', 'DOWNGRADE_SUMQTY': 0, 'TOTAL_SUMQTY': 91}, {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'TABLET', 'PROD_NBR': 'GP130ZFA0010S', 'DOWNGRADE_SUMQTY': 14, 'TOTAL_SUMQTY': 1289}, {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'TABLET', 'PROD_NBR': 'GP130ZFZ1020S', 'DOWNGRADE_SUMQTY': 4, 'TOTAL_SUMQTY': 223}, {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'TABLET', 'PROD_NBR': 'GP140ZKA0040S', 'DOWNGRADE_SUMQTY': 7, 'TOTAL_SUMQTY': 125}]
2021-08-14 10:59:03,959 -[line:96] - INFO: [{'PROD_NBR': 'GNJ101IA0030S', 'APPLICATION': 'CE'}, {'PROD_NBR': 'GP062CCAC100S', 'APPLICATION': 'CE'}, {'PROD_NBR': 'GP062CCAY010S', 'APPLICATION': 'CE'}, {'PROD_NBR': 'GP070BAGM050S', 'APPLICATION': 'CE'}, {'PROD_NBR': 'GZD070SA4030S', 'APPLICATION': 'CE'}, {'PROD_NBR': 'GZD070SA5010S', 'APPLICATION': 'CE'}, {'PROD_NBR': 'GZJ101ZA3010S', 'APPLICATION': 'CE'}, {'PROD_NBR': 'GP080DZD00B0S', 'APPLICATION': 'TABLET'}, {'PROD_NBR': 'GP080DZD00C0S', 'APPLICATION': 'TABLET'}, {'PROD_NBR': 'GP130ZFA0010S', 'APPLICATION': 'TABLET'}, {'PROD_NBR': 'GP130ZFZ1020S', 'APPLICATION': 'TABLET'}, {'PROD_NBR': 'GP140ZKA0040S', 'APPLICATION': 'TABLET'}]
2021-08-14 10:59:03,961 -[line:99] - ERROR: File:[D:\Project\source\dataproviderapi\GetINTKPI.py] , Line:968 , in _groupMSHIPDAT : [TypeError] must be str, not list
2021-08-14 11:00:10,945 -[line:96] - INFO: INTKPI __init__
2021-08-14 11:00:10,945 -[line:96] - INFO: INTKPI getData Start
2021-08-14 11:00:10,945 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'APPLICATION': 'ALL', 'KPITYPE': 'MSHIP', 'ACCT_DATE': '20210801'}
2021-08-14 11:00:11,111 -[line:96] - INFO: [{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'CE', 'PROD_NBR': 'GNJ101IA0030S', 'TOBESCRAP_SUMQTY': 0}, {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'CE', 'PROD_NBR': 'GP062CCAC100S', 'TOBESCRAP_SUMQTY': 0}, {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'CE', 'PROD_NBR': 'GP062CCAY010S', 'TOBESCRAP_SUMQTY': 0}, {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'CE', 'PROD_NBR': 'GP070BAGM050S', 'TOBESCRAP_SUMQTY': 0}, {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'CE', 'PROD_NBR': 'GZD070SA4030S', 'TOBESCRAP_SUMQTY': 0}, {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'CE', 'PROD_NBR': 'GZD070SA5010S', 'TOBESCRAP_SUMQTY': 0}, {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'CE', 'PROD_NBR': 'GZD070SAB020S', 'TOBESCRAP_SUMQTY': 0}, {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'CE', 'PROD_NBR': 'GZD080JAB010S', 'TOBESCRAP_SUMQTY': 0}, {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'CE', 'PROD_NBR': 'GZJ101IA0040S', 'TOBESCRAP_SUMQTY': 0}, {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'CE', 'PROD_NBR': 'GZJ101ZA3010S', 'TOBESCRAP_SUMQTY': 0}, {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'CE', 'PROD_NBR': 'GZJ140IAB010S', 'TOBESCRAP_SUMQTY': 0}, {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'NB', 'PROD_NBR': 'GN140HCNA050S', 'TOBESCRAP_SUMQTY': 0}, {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'TABLET', 'PROD_NBR': '2HE080IA1010S', 'TOBESCRAP_SUMQTY': 0}, {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'TABLET', 'PROD_NBR': '2P125ZZD0030M', 'TOBESCRAP_SUMQTY': 0}, {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'TABLET', 'PROD_NBR': 'GHD140ZB0000S', 'TOBESCRAP_SUMQTY': 0}, {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'TABLET', 'PROD_NBR': 'GP080DZD00B0S', 'TOBESCRAP_SUMQTY': 0}, {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'TABLET', 'PROD_NBR': 'GP080DZD00C0S', 'TOBESCRAP_SUMQTY': 0}, {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'TABLET', 'PROD_NBR': 'GP101KZD0200S', 'TOBESCRAP_SUMQTY': 0}, {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'TABLET', 'PROD_NBR': 'GP104ZZD0220S', 'TOBESCRAP_SUMQTY': 0}, {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'TABLET', 'PROD_NBR': 'GP104ZZD0240S', 'TOBESCRAP_SUMQTY': 0}, {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'TABLET', 'PROD_NBR': 'GP125ZZD0030S', 'TOBESCRAP_SUMQTY': 0}, {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'TABLET', 'PROD_NBR': 'GP125ZZD0040S', 'TOBESCRAP_SUMQTY': 0}, {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'TABLET', 'PROD_NBR': 'GP130ZFA0010S', 'TOBESCRAP_SUMQTY': 0}, {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'TABLET', 'PROD_NBR': 'GP130ZFZ1020S', 'TOBESCRAP_SUMQTY': 0}, {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'TABLET', 'PROD_NBR': 'GP140ZKA0040S', 'TOBESCRAP_SUMQTY': 0}, {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'TABLET', 'PROD_NBR': 'GP140ZKA0060S', 'TOBESCRAP_SUMQTY': 0}]
2021-08-14 11:00:11,114 -[line:96] - INFO: []
2021-08-14 11:00:11,115 -[line:96] - INFO: [{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'CE', 'PROD_NBR': 'GNJ101IA0030S', 'DOWNGRADE_SUMQTY': 0, 'TOTAL_SUMQTY': 33}, {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'CE', 'PROD_NBR': 'GP062CCAC100S', 'DOWNGRADE_SUMQTY': 1, 'TOTAL_SUMQTY': 16385}, {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'CE', 'PROD_NBR': 'GP062CCAY010S', 'DOWNGRADE_SUMQTY': 0, 'TOTAL_SUMQTY': 2006}, {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'CE', 'PROD_NBR': 'GP070BAGM050S', 'DOWNGRADE_SUMQTY': 0, 'TOTAL_SUMQTY': 628}, {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'CE', 'PROD_NBR': 'GZD070SA4030S', 'DOWNGRADE_SUMQTY': 0, 'TOTAL_SUMQTY': 1030}, {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'CE', 'PROD_NBR': 'GZD070SA5010S', 'DOWNGRADE_SUMQTY': 0, 'TOTAL_SUMQTY': 114}, {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'CE', 'PROD_NBR': 'GZJ101ZA3010S', 'DOWNGRADE_SUMQTY': 0, 'TOTAL_SUMQTY': 2}, {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'TABLET', 'PROD_NBR': 'GP080DZD00B0S', 'DOWNGRADE_SUMQTY': 12, 'TOTAL_SUMQTY': 1877}, {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'TABLET', 'PROD_NBR': 'GP080DZD00C0S', 'DOWNGRADE_SUMQTY': 0, 'TOTAL_SUMQTY': 91}, {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'TABLET', 'PROD_NBR': 'GP130ZFA0010S', 'DOWNGRADE_SUMQTY': 14, 'TOTAL_SUMQTY': 1289}, {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'TABLET', 'PROD_NBR': 'GP130ZFZ1020S', 'DOWNGRADE_SUMQTY': 4, 'TOTAL_SUMQTY': 223}, {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'TABLET', 'PROD_NBR': 'GP140ZKA0040S', 'DOWNGRADE_SUMQTY': 7, 'TOTAL_SUMQTY': 125}]
2021-08-14 11:00:11,117 -[line:96] - INFO: [{'PROD_NBR': 'GNJ101IA0030S', 'APPLICATION': 'CE'}, {'PROD_NBR': 'GP062CCAC100S', 'APPLICATION': 'CE'}, {'PROD_NBR': 'GP062CCAY010S', 'APPLICATION': 'CE'}, {'PROD_NBR': 'GP070BAGM050S', 'APPLICATION': 'CE'}, {'PROD_NBR': 'GZD070SA4030S', 'APPLICATION': 'CE'}, {'PROD_NBR': 'GZD070SA5010S', 'APPLICATION': 'CE'}, {'PROD_NBR': 'GZJ101ZA3010S', 'APPLICATION': 'CE'}, {'PROD_NBR': 'GP080DZD00B0S', 'APPLICATION': 'TABLET'}, {'PROD_NBR': 'GP080DZD00C0S', 'APPLICATION': 'TABLET'}, {'PROD_NBR': 'GP130ZFA0010S', 'APPLICATION': 'TABLET'}, {'PROD_NBR': 'GP130ZFZ1020S', 'APPLICATION': 'TABLET'}, {'PROD_NBR': 'GP140ZKA0040S', 'APPLICATION': 'TABLET'}]
2021-08-14 11:01:31,206 -[line:96] - INFO: INTKPI __init__
2021-08-14 11:01:31,206 -[line:96] - INFO: INTKPI getData Start
2021-08-14 11:01:31,207 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'APPLICATION': 'ALL', 'KPITYPE': 'MSHIP', 'ACCT_DATE': '20210801'}
2021-08-14 11:01:31,400 -[line:99] - ERROR: File:[D:\Project\source\dataproviderapi\GetINTKPI.py] , Line:946 , in _groupMSHIPDAT : [TypeError] must be str, not list
2021-08-14 11:01:47,112 -[line:96] - INFO: INTKPI __init__
2021-08-14 11:01:47,116 -[line:96] - INFO: INTKPI getData Start
2021-08-14 11:01:47,116 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'APPLICATION': 'ALL', 'KPITYPE': 'MSHIP', 'ACCT_DATE': '20210801'}
2021-08-14 11:01:47,260 -[line:99] - ERROR: File:[D:\Project\source\dataproviderapi\GetINTKPI.py] , Line:946 , in _groupMSHIPDAT : [TypeError] must be str, not list
2021-08-14 11:03:49,404 -[line:96] - INFO: INTKPI __init__
2021-08-14 11:03:49,404 -[line:96] - INFO: INTKPI getData Start
2021-08-14 11:03:49,405 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'APPLICATION': 'ALL', 'KPITYPE': 'MSHIP', 'ACCT_DATE': '20210801'}
2021-08-14 11:03:49,554 -[line:99] - ERROR: File:[D:\Project\source\dataproviderapi\GetINTKPI.py] , Line:917 , in _getMSHIPData : [TypeError] must be str, not CommandCursor
2021-08-14 11:03:49,555 -[line:99] - ERROR: File:[D:\Project\source\dataproviderapi\GetINTKPI.py] , Line:943 , in _groupMSHIPDAT : [TypeError] string indices must be integers
2021-08-14 11:06:23,239 -[line:96] - INFO: INTKPI __init__
2021-08-14 11:06:23,241 -[line:96] - INFO: INTKPI getData Start
2021-08-14 11:06:23,241 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'APPLICATION': 'ALL', 'KPITYPE': 'MSHIP', 'ACCT_DATE': '20210801'}
2021-08-14 11:06:23,375 -[line:99] - ERROR: File:[D:\Project\source\dataproviderapi\GetINTKPI.py] , Line:917 , in _getMSHIPData : [TypeError] must be str, not CommandCursor
2021-08-14 11:06:23,376 -[line:99] - ERROR: File:[D:\Project\source\dataproviderapi\GetINTKPI.py] , Line:943 , in _groupMSHIPDAT : [TypeError] string indices must be integers
2021-08-14 11:07:00,747 -[line:96] - INFO: INTKPI __init__
2021-08-14 11:07:00,748 -[line:96] - INFO: INTKPI getData Start
2021-08-14 11:07:00,748 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'APPLICATION': 'ALL', 'KPITYPE': 'MSHIP', 'ACCT_DATE': '20210801'}
2021-08-14 11:07:00,898 -[line:96] - INFO: [{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'LCM_OWNER': {'$in': ['INT0', 'LCM0', 'LCME', 'PROD', 'QTAP', 'RES0']}}}, {'$group': {'_id': {'COMPANY_CODE': '$COMPANY_CODE', 'SITE': '$SITE', 'FACTORY_ID': '$FACTORY_ID', 'ACCT_DATE': '$ACCT_DATE', 'APPLICATION': '$APPLICATION', 'PROD_NBR': '$PROD_NBR'}, 'TOBESCRAP_QTY': {'$sum': {'$toInt': '$TOBESCRAP_QTY'}}}}, {'$project': {'_id': 0, 'COMPANY_CODE': '$_id.COMPANY_CODE', 'SITE': '$_id.SITE', 'FACTORY_ID': '$_id.FACTORY_ID', 'ACCT_DATE': '$_id.ACCT_DATE', 'APPLICATION': '$_id.APPLICATION', 'PROD_NBR': '$_id.PROD_NBR', 'TOBESCRAP_SUMQTY': '$TOBESCRAP_QTY'}}, {'$sort': {'COMPANY_CODE': 1, 'SITE': 1, 'FACTORY_ID': 1, 'ACCT_DATE': 1, 'APPLICATION': 1, 'PROD_NBR': 1}}]
2021-08-14 11:07:40,689 -[line:96] - INFO: INTKPI __init__
2021-08-14 11:07:40,689 -[line:96] - INFO: INTKPI getData Start
2021-08-14 11:07:40,690 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'APPLICATION': 'ALL', 'KPITYPE': 'MSHIP', 'ACCT_DATE': '20210801'}
2021-08-14 11:07:40,844 -[line:96] - INFO: <pymongo.command_cursor.CommandCursor object at 0x0000026980580240>
2021-08-14 11:08:53,412 -[line:96] - INFO: INTKPI __init__
2021-08-14 11:08:53,413 -[line:96] - INFO: INTKPI getData Start
2021-08-14 11:08:53,413 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'APPLICATION': 'ALL', 'KPITYPE': 'MSHIP', 'ACCT_DATE': '20210801'}
2021-08-14 11:08:53,548 -[line:96] - INFO: <pymongo.command_cursor.CommandCursor object at 0x00000269805A0AC8>
2021-08-14 11:09:17,703 -[line:96] - INFO: INTKPI __init__
2021-08-14 11:09:17,704 -[line:96] - INFO: INTKPI getData Start
2021-08-14 11:09:17,704 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'APPLICATION': 'ALL', 'KPITYPE': 'MSHIP', 'ACCT_DATE': '20210801'}
2021-08-14 11:09:17,877 -[line:96] - INFO: <pymongo.command_cursor.CommandCursor object at 0x000001FE01E33748>
2021-08-14 11:09:51,660 -[line:96] - INFO: INTKPI __init__
2021-08-14 11:09:51,660 -[line:96] - INFO: INTKPI getData Start
2021-08-14 11:09:51,661 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'APPLICATION': 'ALL', 'KPITYPE': 'MSHIP', 'ACCT_DATE': '20210801'}
2021-08-14 11:09:51,805 -[line:96] - INFO: [{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'CE', 'PROD_NBR': 'GNJ101IA0030S', 'TOBESCRAP_SUMQTY': 11}, {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'CE', 'PROD_NBR': 'GP062CCAC100S', 'TOBESCRAP_SUMQTY': 351}, {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'CE', 'PROD_NBR': 'GP062CCAY010S', 'TOBESCRAP_SUMQTY': 88}, {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'CE', 'PROD_NBR': 'GP070BAGM050S', 'TOBESCRAP_SUMQTY': 20}, {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'CE', 'PROD_NBR': 'GZD070SA4030S', 'TOBESCRAP_SUMQTY': 43}, {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'CE', 'PROD_NBR': 'GZD080JAB010S', 'TOBESCRAP_SUMQTY': 1}, {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'CE', 'PROD_NBR': 'GZD101IA0020S', 'TOBESCRAP_SUMQTY': 4}, {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'CE', 'PROD_NBR': 'GZJ055IAB010S', 'TOBESCRAP_SUMQTY': 15}, {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'CE', 'PROD_NBR': 'GZJ101IA0040S', 'TOBESCRAP_SUMQTY': 1}, {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'CE', 'PROD_NBR': 'GZJ101ZA3010S', 'TOBESCRAP_SUMQTY': 9}, {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'NB', 'PROD_NBR': 'GN140HCA56A0S', 'TOBESCRAP_SUMQTY': 16}, {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'TABLET', 'PROD_NBR': '2HE080IA1010S', 'TOBESCRAP_SUMQTY': 6}, {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'TABLET', 'PROD_NBR': 'GP080DZD00C0S', 'TOBESCRAP_SUMQTY': 10}, {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'TABLET', 'PROD_NBR': 'GP101KZD0200S', 'TOBESCRAP_SUMQTY': 9}, {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'TABLET', 'PROD_NBR': 'GP101KZD0210S', 'TOBESCRAP_SUMQTY': 9}, {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'TABLET', 'PROD_NBR': 'GP104ZZD0240S', 'TOBESCRAP_SUMQTY': 6}, {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'APPLICATION': 'TABLET', 'PROD_NBR': 'GP130ZFA0010S', 'TOBESCRAP_SUMQTY': 42}]
2021-08-14 11:10:06,365 -[line:96] - INFO: INTKPI __init__
2021-08-14 11:10:06,366 -[line:96] - INFO: INTKPI getData Start
2021-08-14 11:10:06,366 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'APPLICATION': 'ALL', 'KPITYPE': 'MSHIP', 'ACCT_DATE': '20210801'}
2021-08-14 11:12:57,036 -[line:96] - INFO: INTKPI __init__
2021-08-14 11:12:57,036 -[line:96] - INFO: INTKPI getData Start
2021-08-14 11:12:57,036 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'APPLICATION': 'ALL', 'KPITYPE': 'MSHIP', 'ACCT_DATE': '20210801'}
2021-08-14 11:13:25,497 -[line:96] - INFO: INTKPI __init__
2021-08-14 11:13:25,498 -[line:96] - INFO: INTKPI getData Start
2021-08-14 11:13:25,498 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'APPLICATION': 'CE', 'KPITYPE': 'MSHIP', 'ACCT_DATE': '20210801'}
2021-08-14 11:13:25,640 -[line:99] - ERROR: File:[D:\Project\source\dataproviderapi\GetINTKPI.py] , Line:1011 , in _calMSHIPData : [KeyError] APPLICATION
2021-08-14 11:15:09,188 -[line:96] - INFO: INTKPI __init__
2021-08-14 11:15:09,189 -[line:96] - INFO: INTKPI getData Start
2021-08-14 11:15:09,189 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'APPLICATION': 'CE', 'KPITYPE': 'MSHIP', 'ACCT_DATE': '20210801'}
2021-08-14 11:15:09,338 -[line:99] - ERROR: File:[D:\Project\source\dataproviderapi\GetINTKPI.py] , Line:976 , in _groupMSHIPData : [NameError] name 'p' is not defined
2021-08-14 11:15:32,792 -[line:96] - INFO: INTKPI __init__
2021-08-14 11:15:32,792 -[line:96] - INFO: INTKPI getData Start
2021-08-14 11:15:32,792 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'APPLICATION': 'CE', 'KPITYPE': 'MSHIP', 'ACCT_DATE': '20210801'}
2021-08-14 11:15:49,404 -[line:96] - INFO: INTKPI __init__
2021-08-14 11:15:49,404 -[line:96] - INFO: INTKPI getData Start
2021-08-14 11:15:49,404 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'APPLICATION': 'ALL', 'KPITYPE': 'MSHIP', 'ACCT_DATE': '20210801'}
2021-08-14 11:18:29,745 -[line:96] - INFO: INTKPI __init__
2021-08-14 11:18:29,745 -[line:96] - INFO: INTKPI getData Start
2021-08-14 11:18:29,745 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'APPLICATION': 'ALL', 'KPITYPE': 'MSHIP', 'ACCT_DATE': '20210801'}
2021-08-14 11:18:29,900 -[line:96] - INFO: {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'APPLICATION': 'CE', 'PROD_NBR': 'GP062CCAC100S', 'ACCT_DATE': '2021-08-01', 'TOBESCRAP_SUMQTY': 351, 'SHIP_SUMQTY': 15120, 'GRADW_YIELD': 0.9768, 'DOWNGRADE_SUMQTY': 1, 'TOTAL_SUMQTY': 16385, 'TOTAL_YIELD': 0.9999, 'MSHIP': 0.9769}
2021-08-14 11:18:29,901 -[line:96] - INFO: {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'APPLICATION': 'CE', 'PROD_NBR': 'GZD070SA4030S', 'ACCT_DATE': '2021-08-01', 'TOBESCRAP_SUMQTY': 43, 'SHIP_SUMQTY': 1152, 'GRADW_YIELD': 0.9627, 'DOWNGRADE_SUMQTY': 0, 'TOTAL_SUMQTY': 1030, 'TOTAL_YIELD': 1, 'MSHIP': 0.9627}
2021-08-14 11:18:29,901 -[line:96] - INFO: {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'APPLICATION': 'TABLET', 'PROD_NBR': 'GP080DZD00B0S', 'ACCT_DATE': '2021-08-01', 'TOBESCRAP_SUMQTY': 0, 'SHIP_SUMQTY': 1080, 'GRADW_YIELD': 1, 'DOWNGRADE_SUMQTY': 12, 'TOTAL_SUMQTY': 1877, 'TOTAL_YIELD': 0.9936, 'MSHIP': 1.0064}
2021-08-14 11:18:29,902 -[line:96] - INFO: {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'APPLICATION': 'TABLET', 'PROD_NBR': 'GP130ZFA0010S', 'ACCT_DATE': '2021-08-01', 'TOBESCRAP_SUMQTY': 42, 'SHIP_SUMQTY': 1088, 'GRADW_YIELD': 0.9614, 'DOWNGRADE_SUMQTY': 14, 'TOTAL_SUMQTY': 1289, 'TOTAL_YIELD': 0.9891, 'MSHIP': 0.972}
2021-08-14 11:18:29,902 -[line:96] - INFO: {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'APPLICATION': 'TABLET', 'PROD_NBR': 'GP130ZFZ1020S', 'ACCT_DATE': '2021-08-01', 'TOBESCRAP_SUMQTY': 0, 'SHIP_SUMQTY': 480, 'GRADW_YIELD': 1, 'DOWNGRADE_SUMQTY': 4, 'TOTAL_SUMQTY': 223, 'TOTAL_YIELD': 0.9821, 'MSHIP': 1.0182}
2021-08-14 11:21:44,638 -[line:96] - INFO: INTKPI __init__
2021-08-14 11:21:44,640 -[line:96] - INFO: INTKPI getData Start
2021-08-14 11:21:44,641 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'APPLICATION': 'ALL', 'KPITYPE': 'MSHIP', 'ACCT_DATE': '20210801'}
2021-08-14 11:21:56,095 -[line:96] - INFO: INTKPI __init__
2021-08-14 11:21:56,095 -[line:96] - INFO: INTKPI getData Start
2021-08-14 11:21:56,095 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'APPLICATION': 'ALL', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-14 11:22:08,203 -[line:96] - INFO: INTKPI __init__
2021-08-14 11:22:08,204 -[line:96] - INFO: INTKPI getData Start
2021-08-14 11:22:08,205 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'APPLICATION': 'ALL', 'KPITYPE': 'PRODFPY', 'ACCT_DATE': '20210801'}
2021-08-14 11:22:35,709 -[line:96] - INFO: INTKPI __init__
2021-08-14 11:22:35,709 -[line:96] - INFO: INTKPI getData Start
2021-08-14 11:22:35,710 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J003', 'APPLICATION': 'ALL', 'KPITYPE': 'PRODFPY', 'ACCT_DATE': '20210801'}
2021-08-14 11:22:54,811 -[line:96] - INFO: INTKPI __init__
2021-08-14 11:22:54,811 -[line:96] - INFO: INTKPI getData Start
2021-08-14 11:22:54,811 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'M011', 'APPLICATION': 'ALL', 'KPITYPE': 'PRODFPY', 'ACCT_DATE': '20210801'}
2021-08-14 11:23:03,996 -[line:96] - INFO: INTKPI __init__
2021-08-14 11:23:03,996 -[line:96] - INFO: INTKPI getData Start
2021-08-14 11:23:03,997 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'M011', 'APPLICATION': 'ALL', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-14 11:23:13,788 -[line:96] - INFO: INTKPI __init__
2021-08-14 11:23:13,789 -[line:96] - INFO: INTKPI getData Start
2021-08-14 11:23:13,789 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'M011', 'APPLICATION': 'ALL', 'KPITYPE': 'MSHIP', 'ACCT_DATE': '20210801'}
2021-08-14 11:23:27,931 -[line:96] - INFO: INTKPI __init__
2021-08-14 11:23:27,932 -[line:96] - INFO: INTKPI getData Start
2021-08-14 11:23:27,932 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'M011', 'APPLICATION': 'NB', 'KPITYPE': 'MSHIP', 'ACCT_DATE': '20210801'}
2021-08-14 11:23:33,419 -[line:96] - INFO: INTKPI __init__
2021-08-14 11:23:33,419 -[line:96] - INFO: INTKPI getData Start
2021-08-14 11:23:33,420 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'M011', 'APPLICATION': 'CE', 'KPITYPE': 'MSHIP', 'ACCT_DATE': '20210801'}
2021-08-14 11:23:44,460 -[line:96] - INFO: INTKPI __init__
2021-08-14 11:23:44,461 -[line:96] - INFO: INTKPI getData Start
2021-08-14 11:23:44,461 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'M011', 'APPLICATION': 'CE', 'KPITYPE': 'PRODFPY', 'ACCT_DATE': '20210801'}
2021-08-14 11:23:54,402 -[line:96] - INFO: INTKPI __init__
2021-08-14 11:23:54,403 -[line:96] - INFO: INTKPI getData Start
2021-08-14 11:23:54,403 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'M011', 'APPLICATION': 'ALL', 'KPITYPE': 'PRODFPY', 'ACCT_DATE': '20210801'}
2021-08-14 11:23:54,410 -[line:96] - INFO: Cache Data From Redis
2021-08-14 11:24:05,583 -[line:96] - INFO: INTKPI __init__
2021-08-14 11:24:05,584 -[line:96] - INFO: INTKPI getData Start
2021-08-14 11:24:05,585 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'M011', 'APPLICATION': 'TV', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-14 11:24:14,589 -[line:96] - INFO: INTKPI __init__
2021-08-14 11:24:14,590 -[line:96] - INFO: INTKPI getData Start
2021-08-14 11:24:14,590 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'M011', 'APPLICATION': 'TV', 'KPITYPE': 'MSHIP', 'ACCT_DATE': '20210801'}
2021-08-14 11:24:17,982 -[line:96] - INFO: INTKPI __init__
2021-08-14 11:24:17,983 -[line:96] - INFO: INTKPI getData Start
2021-08-14 11:24:17,983 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'M011', 'APPLICATION': 'TV', 'KPITYPE': 'MSHIP', 'ACCT_DATE': '20210801'}
2021-08-14 11:24:17,989 -[line:96] - INFO: Cache Data From Redis
2021-08-14 11:24:24,151 -[line:96] - INFO: INTKPI __init__
2021-08-14 11:24:24,151 -[line:96] - INFO: INTKPI getData Start
2021-08-14 11:24:24,151 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'M011', 'APPLICATION': 'TV', 'KPITYPE': 'FPY', 'ACCT_DATE': '20210801'}
2021-08-14 11:24:24,159 -[line:96] - INFO: Cache Data From Redis
2021-08-14 11:24:40,953 -[line:96] - INFO: INTKPI __init__
2021-08-14 11:24:40,954 -[line:96] - INFO: INTKPI getData Start
2021-08-14 11:24:40,954 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'M011', 'APPLICATION': 'TV', 'KPITYPE': 'PRODFPY', 'ACCT_DATE': '20210801'}
2021-08-14 13:36:58,033 -[line:96] - INFO: INTKPI __init__
2021-08-14 13:36:58,034 -[line:96] - INFO: INTKPI getData Start
2021-08-14 13:36:58,034 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'APPLICATION': 'ALL', 'KPITYPE': 'EFA', 'ACCT_DATE': '20210801'}
2021-08-14 13:36:58,378 -[line:99] - ERROR: File:[C:\Users\hsinyuan.lin\AppData\Local\Programs\Python\Python36\lib\site-packages\pymongo\helpers.py] , Line:160 , in _check_command_response : [OperationFailure] The field 'deftQty' must be an accumulator object, full error: {'ok': 0.0, 'errmsg': "The field 'deftQty' must be an accumulator object", 'code': 40234, 'codeName': 'Location40234'}
2021-08-14 13:38:41,130 -[line:96] - INFO: INTKPI __init__
2021-08-14 13:38:41,131 -[line:96] - INFO: INTKPI getData Start
2021-08-14 13:38:41,132 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'APPLICATION': 'ALL', 'KPITYPE': 'EFA', 'ACCT_DATE': '20210801'}
2021-08-14 13:38:41,139 -[line:96] - INFO: [{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'MAIN_WC': {'$in': ['1300', '1301', '1340', '1370', '1419', '1420', '1510', '1590', '1600']}, 'PROD_NBR': ['GZJ055IA0200S', 'GP062CCAC100S', 'GZD070SA4030S', 'GZD070SAB020S', 'GNJ101IA0030S', 'GZJ101ZA3010S', 'GP062CCAY010S', 'GN116BCNA030S', 'GN140HCNA0C0S', 'GN140HCNA0M0S', 'GN140HCNA0N0S', 'GN140HCNA0R0S', '2HE080IA1010S', '2P101DEZ0020S', 'GP080DZD00B0S', 'GP080DZD00C0S', 'GP101KZD0210S', 'GP104ZZD0220S', 'GP104ZZD0240S', 'GP130ZFZ1020S', 'GP130ZFA0010S', 'GP140ZKA0020S']}}, {'$lookup': {'from': 'deftCodeView', 'as': 'deftCodeList', 'let': {'dfctCode': '$DFCT_CODE'}, 'pipeline': [{'$match': {'$expr': {'$and': [{'$eq': ['$$dfctCode', '$DEFECT_CODE']}]}}}, {'$project': {'DEFECT_CODE': 1}}]}}, {'$unwind': '$deftCodeList'}, {'$group': {'_id': {'PROD_NBR': '$PROD_NBR'}, 'deftQty': {'$sum': '$QTY'}}}, {'$addFields': {'PROD_NBR': '$_id.PROD_NBR', 'deftQty': '$deftQty', 'passQty': 0}}, {'$project': {'_id': 0}}, {'$unionWith': {'coll': 'passHisAndCurrent', 'pipeline': [{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'MAIN_WC': {'$in': ['1300', '1301', '1340', '1370', '1419', '1420', '1510', '1590', '1600']}, 'PROD_NBR': ['GZJ055IA0200S', 'GP062CCAC100S', 'GZD070SA4030S', 'GZD070SAB020S', 'GNJ101IA0030S', 'GZJ101ZA3010S', 'GP062CCAY010S', 'GN116BCNA030S', 'GN140HCNA0C0S', 'GN140HCNA0M0S', 'GN140HCNA0N0S', 'GN140HCNA0R0S', '2HE080IA1010S', '2P101DEZ0020S', 'GP080DZD00B0S', 'GP080DZD00C0S', 'GP101KZD0210S', 'GP104ZZD0220S', 'GP104ZZD0240S', 'GP130ZFZ1020S', 'GP130ZFA0010S', 'GP140ZKA0020S']}}, {'$group': {'_id': {'PROD_NBR': '$PROD_NBR'}, 'passQty': {'$sum': {'$toInt': '$QTY'}}}}, {'$addFields': {'PROD_NBR': '$_id.PROD_NBR', 'passQty': '$passQty', 'deftQty': 0}}, {'$project': {'_id': 0}}]}}, {'$group': {'_id': {'PROD_NBR': '$PROD_NBR'}, 'deftQty': {'$sum': '$deftQty'}, 'passQty': {'$sum': '$passQty'}}}, {'$addFields': {'prodNbr': '$_id.PROD_NBR', 'prodNbrDfctYield': {'$cond': [{'$eq': ['$passQty', 0]}, 0, {' $divide': ['$deftQty', '$passQty']}]}}}, {'$sort': {'prodNbr': 1}}, {'$project': {'_id': 0}}]
2021-08-14 13:40:07,777 -[line:96] - INFO: INTKPI __init__
2021-08-14 13:40:07,778 -[line:96] - INFO: INTKPI getData Start
2021-08-14 13:40:07,778 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'APPLICATION': 'ALL', 'KPITYPE': 'EFA', 'ACCT_DATE': '20210801'}
2021-08-14 13:40:07,785 -[line:96] - INFO: [{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'MAIN_WC': {'$in': ['1300', '1301', '1340', '1370', '1419', '1420', '1510', '1590', '1600']}, 'PROD_NBR': ['GZJ055IA0200S', 'GP062CCAC100S', 'GZD070SA4030S', 'GZD070SAB020S', 'GNJ101IA0030S', 'GZJ101ZA3010S', 'GP062CCAY010S', 'GN116BCNA030S', 'GN140HCNA0C0S', 'GN140HCNA0M0S', 'GN140HCNA0N0S', 'GN140HCNA0R0S', '2HE080IA1010S', '2P101DEZ0020S', 'GP080DZD00B0S', 'GP080DZD00C0S', 'GP101KZD0210S', 'GP104ZZD0220S', 'GP104ZZD0240S', 'GP130ZFZ1020S', 'GP130ZFA0010S', 'GP140ZKA0020S']}}, {'$lookup': {'from': 'deftCodeView', 'as': 'deftCodeList', 'let': {'dfctCode': '$DFCT_CODE'}, 'pipeline': [{'$match': {'$expr': {'$and': [{'$eq': ['$$dfctCode', '$DEFECT_CODE']}]}}}, {'$project': {'DEFECT_CODE': 1}}]}}, {'$unwind': '$deftCodeList'}, {'$group': {'_id': {'PROD_NBR': '$PROD_NBR'}, 'deftQty': {'$sum': '$QTY'}}}, {'$addFields': {'PROD_NBR': '$_id.PROD_NBR', 'deftQty': '$deftQty', 'passQty': 0}}, {'$project': {'_id': 0}}, {'$unionWith': {'coll': 'passHisAndCurrent', 'pipeline': [{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'MAIN_WC': {'$in': ['1300', '1301', '1340', '1370', '1419', '1420', '1510', '1590', '1600']}, 'PROD_NBR': ['GZJ055IA0200S', 'GP062CCAC100S', 'GZD070SA4030S', 'GZD070SAB020S', 'GNJ101IA0030S', 'GZJ101ZA3010S', 'GP062CCAY010S', 'GN116BCNA030S', 'GN140HCNA0C0S', 'GN140HCNA0M0S', 'GN140HCNA0N0S', 'GN140HCNA0R0S', '2HE080IA1010S', '2P101DEZ0020S', 'GP080DZD00B0S', 'GP080DZD00C0S', 'GP101KZD0210S', 'GP104ZZD0220S', 'GP104ZZD0240S', 'GP130ZFZ1020S', 'GP130ZFA0010S', 'GP140ZKA0020S']}}, {'$group': {'_id': {'PROD_NBR': '$PROD_NBR'}, 'passQty': {'$sum': {'$toInt': '$QTY'}}}}, {'$addFields': {'PROD_NBR': '$_id.PROD_NBR', 'passQty': '$passQty', 'deftQty': 0}}, {'$project': {'_id': 0}}]}}, {'$group': {'_id': {'PROD_NBR': '$PROD_NBR'}, 'deftQty': {'$sum': '$deftQty'}, 'passQty': {'$sum': '$passQty'}}}, {'$addFields': {'prodNbr': '$_id.PROD_NBR', 'prodNbrDfctYield': {'$cond': [{'$eq': ['$passQty', 0]}, 0, {' $divide': ['$deftQty', '$passQty']}]}}}, {'$sort': {'prodNbr': 1}}, {'$project': {'_id': 0}}]
2021-08-14 13:43:29,185 -[line:96] - INFO: INTKPI __init__
2021-08-14 13:43:29,186 -[line:96] - INFO: INTKPI getData Start
2021-08-14 13:43:29,186 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'APPLICATION': 'ALL', 'KPITYPE': 'EFA', 'ACCT_DATE': '20210801'}
2021-08-14 13:43:29,193 -[line:96] - INFO: [{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'MAIN_WC': {'$in': ['1300', '1301', '1340', '1370', '1419', '1420', '1510', '1590', '1600']}, 'PROD_NBR': ['GZJ055IA0200S', 'GP062CCAC100S', 'GZD070SA4030S', 'GZD070SAB020S', 'GNJ101IA0030S', 'GZJ101ZA3010S', 'GP062CCAY010S', 'GN116BCNA030S', 'GN140HCNA0C0S', 'GN140HCNA0M0S', 'GN140HCNA0N0S', 'GN140HCNA0R0S', '2HE080IA1010S', '2P101DEZ0020S', 'GP080DZD00B0S', 'GP080DZD00C0S', 'GP101KZD0210S', 'GP104ZZD0220S', 'GP104ZZD0240S', 'GP130ZFZ1020S', 'GP130ZFA0010S', 'GP140ZKA0020S']}}, {'$lookup': {'from': 'deftCodeView', 'as': 'deftCodeList', 'let': {'dfctCode': '$DFCT_CODE'}, 'pipeline': [{'$match': {'$expr': {'$and': [{'$eq': ['$$dfctCode', '$DEFECT_CODE']}]}}}, {'$project': {'DEFECT_CODE': 1}}]}}, {'$unwind': '$deftCodeList'}, {'$group': {'_id': {'PROD_NBR': '$PROD_NBR'}, 'deftQty': {'$sum': '$QTY'}}}, {'$addFields': {'PROD_NBR': '$_id.PROD_NBR', 'deftQty': '$deftQty', 'passQty': 0}}, {'$project': {'_id': 0}}, {'$unionWith': {'coll': 'passHisAndCurrent', 'pipeline': [{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'MAIN_WC': {'$in': ['1300', '1301', '1340', '1370', '1419', '1420', '1510', '1590', '1600']}, 'PROD_NBR': {'$in': ['GZJ055IA0200S', 'GP062CCAC100S', 'GZD070SA4030S', 'GZD070SAB020S', 'GNJ101IA0030S', 'GZJ101ZA3010S', 'GP062CCAY010S', 'GN116BCNA030S', 'GN140HCNA0C0S', 'GN140HCNA0M0S', 'GN140HCNA0N0S', 'GN140HCNA0R0S', '2HE080IA1010S', '2P101DEZ0020S', 'GP080DZD00B0S', 'GP080DZD00C0S', 'GP101KZD0210S', 'GP104ZZD0220S', 'GP104ZZD0240S', 'GP130ZFZ1020S', 'GP130ZFA0010S', 'GP140ZKA0020S']}}}, {'$group': {'_id': {'PROD_NBR': '$PROD_NBR'}, 'passQty': {'$sum': {'$toInt': '$QTY'}}}}, {'$addFields': {'PROD_NBR': '$_id.PROD_NBR', 'passQty': '$passQty', 'deftQty': 0}}, {'$project': {'_id': 0}}]}}, {'$group': {'_id': {'PROD_NBR': '$PROD_NBR'}, 'deftQty': {'$sum': '$deftQty'}, 'passQty': {'$sum': '$passQty'}}}, {'$addFields': {'prodNbr': '$_id.PROD_NBR', 'prodNbrDfctYield': {'$cond': [{'$eq': ['$passQty', 0]}, 0, {' $divide': ['$deftQty', '$passQty']}]}}}, {'$sort': {'prodNbr': 1}}, {'$project': {'_id': 0}}]
2021-08-14 13:45:20,993 -[line:96] - INFO: INTKPI __init__
2021-08-14 13:45:20,993 -[line:96] - INFO: INTKPI getData Start
2021-08-14 13:45:20,994 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'APPLICATION': 'ALL', 'KPITYPE': 'EFA', 'ACCT_DATE': '20210801'}
2021-08-14 13:45:21,000 -[line:96] - INFO: [{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'MAIN_WC': {'$in': ['1300', '1301', '1340', '1370', '1419', '1420', '1510', '1590', '1600']}, 'PROD_NBR': ['GZJ055IA0200S', 'GP062CCAC100S', 'GZD070SA4030S', 'GZD070SAB020S', 'GNJ101IA0030S', 'GZJ101ZA3010S', 'GP062CCAY010S', 'GN116BCNA030S', 'GN140HCNA0C0S', 'GN140HCNA0M0S', 'GN140HCNA0N0S', 'GN140HCNA0R0S', '2HE080IA1010S', '2P101DEZ0020S', 'GP080DZD00B0S', 'GP080DZD00C0S', 'GP101KZD0210S', 'GP104ZZD0220S', 'GP104ZZD0240S', 'GP130ZFZ1020S', 'GP130ZFA0010S', 'GP140ZKA0020S']}}, {'$lookup': {'from': 'deftCodeView', 'as': 'deftCodeList', 'let': {'dfctCode': '$DFCT_CODE'}, 'pipeline': [{'$match': {'$expr': {'$and': [{'$eq': ['$$dfctCode', '$DEFECT_CODE']}]}}}, {'$project': {'DEFECT_CODE': 1}}]}}, {'$unwind': '$deftCodeList'}, {'$group': {'_id': {'PROD_NBR': '$PROD_NBR'}, 'deftQty': {'$sum': '$QTY'}}}, {'$addFields': {'PROD_NBR': '$_id.PROD_NBR', 'deftQty': '$deftQty', 'passQty': 0}}, {'$project': {'_id': 0}}, {'$unionWith': {'coll': 'passHisAndCurrent', 'pipeline': [{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'MAIN_WC': {'$in': ['1300', '1301', '1340', '1370', '1419', '1420', '1510', '1590', '1600']}, 'PROD_NBR': {'$in': ['GZJ055IA0200S', 'GP062CCAC100S', 'GZD070SA4030S', 'GZD070SAB020S', 'GNJ101IA0030S', 'GZJ101ZA3010S', 'GP062CCAY010S', 'GN116BCNA030S', 'GN140HCNA0C0S', 'GN140HCNA0M0S', 'GN140HCNA0N0S', 'GN140HCNA0R0S', '2HE080IA1010S', '2P101DEZ0020S', 'GP080DZD00B0S', 'GP080DZD00C0S', 'GP101KZD0210S', 'GP104ZZD0220S', 'GP104ZZD0240S', 'GP130ZFZ1020S', 'GP130ZFA0010S', 'GP140ZKA0020S']}}}, {'$group': {'_id': {'PROD_NBR': '$PROD_NBR'}, 'passQty': {'$sum': {'$toInt': '$QTY'}}}}, {'$addFields': {'PROD_NBR': '$_id.PROD_NBR', 'passQty': '$passQty', 'deftQty': 0}}, {'$project': {'_id': 0}}]}}, {'$group': {'_id': {'PROD_NBR': '$PROD_NBR'}, 'deftQty': {'$sum': '$deftQty'}, 'passQty': {'$sum': '$passQty'}}}, {'$addFields': {'prodNbr': '$_id.PROD_NBR', 'prodNbrDfctYield': {'$cond': [{'$eq': ['$passQty', 0]}, 0, {'divide': ['$deftQty', '$passQty']}]}}}, {'$sort': {'prodNbr': 1}}, {'$project': {'_id': 0}}]
2021-08-14 13:45:58,706 -[line:96] - INFO: INTKPI __init__
2021-08-14 13:45:58,706 -[line:96] - INFO: INTKPI getData Start
2021-08-14 13:45:58,706 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'APPLICATION': 'ALL', 'KPITYPE': 'EFA', 'ACCT_DATE': '20210801'}
2021-08-14 13:45:58,713 -[line:96] - INFO: Cache Data From Redis
2021-08-14 13:46:17,909 -[line:96] - INFO: INTKPI __init__
2021-08-14 13:46:17,910 -[line:96] - INFO: INTKPI getData Start
2021-08-14 13:46:17,910 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'APPLICATION': 'ALL', 'KPITYPE': 'EFA', 'ACCT_DATE': '20210801'}
2021-08-14 13:46:17,917 -[line:96] - INFO: Cache Data From Redis
2021-08-14 13:47:23,662 -[line:96] - INFO: INTKPI __init__
2021-08-14 13:47:23,666 -[line:96] - INFO: INTKPI getData Start
2021-08-14 13:47:23,666 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'APPLICATION': 'ALL', 'KPITYPE': 'EFA', 'ACCT_DATE': '20210801'}
2021-08-14 13:47:24,230 -[line:96] - INFO: <pymongo.command_cursor.CommandCursor object at 0x000001998057ECC0>
2021-08-14 13:48:25,704 -[line:96] - INFO: INTKPI __init__
2021-08-14 13:48:25,705 -[line:96] - INFO: INTKPI getData Start
2021-08-14 13:48:25,705 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'APPLICATION': 'ALL', 'KPITYPE': 'EFA', 'ACCT_DATE': '20210801'}
2021-08-14 13:48:26,220 -[line:96] - INFO: [{'deftQty': 0, 'passQty': 3, 'prodNbr': '2HE080IA1010S', 'prodNbrDfctYield': {'divide': [0, 3]}}, {'deftQty': 0, 'passQty': 33, 'prodNbr': 'GNJ101IA0030S', 'prodNbrDfctYield': {'divide': [0, 33]}}, {'deftQty': 0, 'passQty': 82328, 'prodNbr': 'GP062CCAC100S', 'prodNbrDfctYield': {'divide': [0, 82328]}}, {'deftQty': 0, 'passQty': 7877, 'prodNbr': 'GP062CCAY010S', 'prodNbrDfctYield': {'divide': [0, 7877]}}, {'deftQty': 0, 'passQty': 12539, 'prodNbr': 'GP080DZD00B0S', 'prodNbrDfctYield': {'divide': [0, 12539]}}, {'deftQty': 0, 'passQty': 270, 'prodNbr': 'GP080DZD00C0S', 'prodNbrDfctYield': {'divide': [0, 270]}}, {'deftQty': 0, 'passQty': 46, 'prodNbr': 'GP104ZZD0220S', 'prodNbrDfctYield': {'divide': [0, 46]}}, {'deftQty': 0, 'passQty': 145, 'prodNbr': 'GP104ZZD0240S', 'prodNbrDfctYield': {'divide': [0, 145]}}, {'deftQty': 0, 'passQty': 4602, 'prodNbr': 'GP130ZFA0010S', 'prodNbrDfctYield': {'divide': [0, 4602]}}, {'deftQty': 0, 'passQty': 244, 'prodNbr': 'GP130ZFZ1020S', 'prodNbrDfctYield': {'divide': [0, 244]}}, {'deftQty': 0, 'passQty': 1, 'prodNbr': 'GP140ZKA0020S', 'prodNbrDfctYield': {'divide': [0, 1]}}, {'deftQty': 0, 'passQty': 9087, 'prodNbr': 'GZD070SA4030S', 'prodNbrDfctYield': {'divide': [0, 9087]}}, {'deftQty': 0, 'passQty': 2, 'prodNbr': 'GZJ101ZA3010S', 'prodNbrDfctYield': {'divide': [0, 2]}}]
2021-08-14 13:48:58,435 -[line:96] - INFO: INTKPI __init__
2021-08-14 13:48:58,436 -[line:96] - INFO: INTKPI getData Start
2021-08-14 13:48:58,436 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'APPLICATION': 'ALL', 'KPITYPE': 'EFA', 'ACCT_DATE': '20210801'}
2021-08-14 13:48:58,954 -[line:96] - INFO: [{'deftQty': 0, 'passQty': 3, 'prodNbr': '2HE080IA1010S', 'prodNbrDfctYield': {'divide': [0, 3]}}, {'deftQty': 0, 'passQty': 33, 'prodNbr': 'GNJ101IA0030S', 'prodNbrDfctYield': {'divide': [0, 33]}}, {'deftQty': 0, 'passQty': 82328, 'prodNbr': 'GP062CCAC100S', 'prodNbrDfctYield': {'divide': [0, 82328]}}, {'deftQty': 0, 'passQty': 7877, 'prodNbr': 'GP062CCAY010S', 'prodNbrDfctYield': {'divide': [0, 7877]}}, {'deftQty': 0, 'passQty': 12539, 'prodNbr': 'GP080DZD00B0S', 'prodNbrDfctYield': {'divide': [0, 12539]}}, {'deftQty': 0, 'passQty': 270, 'prodNbr': 'GP080DZD00C0S', 'prodNbrDfctYield': {'divide': [0, 270]}}, {'deftQty': 0, 'passQty': 46, 'prodNbr': 'GP104ZZD0220S', 'prodNbrDfctYield': {'divide': [0, 46]}}, {'deftQty': 0, 'passQty': 145, 'prodNbr': 'GP104ZZD0240S', 'prodNbrDfctYield': {'divide': [0, 145]}}, {'deftQty': 0, 'passQty': 4602, 'prodNbr': 'GP130ZFA0010S', 'prodNbrDfctYield': {'divide': [0, 4602]}}, {'deftQty': 0, 'passQty': 244, 'prodNbr': 'GP130ZFZ1020S', 'prodNbrDfctYield': {'divide': [0, 244]}}, {'deftQty': 0, 'passQty': 1, 'prodNbr': 'GP140ZKA0020S', 'prodNbrDfctYield': {'divide': [0, 1]}}, {'deftQty': 0, 'passQty': 9087, 'prodNbr': 'GZD070SA4030S', 'prodNbrDfctYield': {'divide': [0, 9087]}}, {'deftQty': 0, 'passQty': 2, 'prodNbr': 'GZJ101ZA3010S', 'prodNbrDfctYield': {'divide': [0, 2]}}]
2021-08-14 13:50:53,316 -[line:96] - INFO: INTKPI __init__
2021-08-14 13:50:53,317 -[line:96] - INFO: INTKPI getData Start
2021-08-14 13:50:53,317 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'APPLICATION': 'ALL', 'KPITYPE': 'EFA', 'ACCT_DATE': '20210801'}
2021-08-14 13:50:53,852 -[line:96] - INFO: [{'deftQty': 0, 'passQty': 3, 'prodNbr': '2HE080IA1010S', 'prodNbrDfctYield': {'divide': [0, 3]}}, {'deftQty': 0, 'passQty': 33, 'prodNbr': 'GNJ101IA0030S', 'prodNbrDfctYield': {'divide': [0, 33]}}, {'deftQty': 0, 'passQty': 82328, 'prodNbr': 'GP062CCAC100S', 'prodNbrDfctYield': {'divide': [0, 82328]}}, {'deftQty': 0, 'passQty': 7877, 'prodNbr': 'GP062CCAY010S', 'prodNbrDfctYield': {'divide': [0, 7877]}}, {'deftQty': 0, 'passQty': 12539, 'prodNbr': 'GP080DZD00B0S', 'prodNbrDfctYield': {'divide': [0, 12539]}}, {'deftQty': 0, 'passQty': 270, 'prodNbr': 'GP080DZD00C0S', 'prodNbrDfctYield': {'divide': [0, 270]}}, {'deftQty': 0, 'passQty': 46, 'prodNbr': 'GP104ZZD0220S', 'prodNbrDfctYield': {'divide': [0, 46]}}, {'deftQty': 0, 'passQty': 145, 'prodNbr': 'GP104ZZD0240S', 'prodNbrDfctYield': {'divide': [0, 145]}}, {'deftQty': 0, 'passQty': 4602, 'prodNbr': 'GP130ZFA0010S', 'prodNbrDfctYield': {'divide': [0, 4602]}}, {'deftQty': 0, 'passQty': 244, 'prodNbr': 'GP130ZFZ1020S', 'prodNbrDfctYield': {'divide': [0, 244]}}, {'deftQty': 0, 'passQty': 1, 'prodNbr': 'GP140ZKA0020S', 'prodNbrDfctYield': {'divide': [0, 1]}}, {'deftQty': 0, 'passQty': 9087, 'prodNbr': 'GZD070SA4030S', 'prodNbrDfctYield': {'divide': [0, 9087]}}, {'deftQty': 0, 'passQty': 2, 'prodNbr': 'GZJ101ZA3010S', 'prodNbrDfctYield': {'divide': [0, 2]}}]
2021-08-14 13:51:35,356 -[line:96] - INFO: INTKPI __init__
2021-08-14 13:51:35,357 -[line:96] - INFO: INTKPI getData Start
2021-08-14 13:51:35,357 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'APPLICATION': 'ALL', 'KPITYPE': 'EFA', 'ACCT_DATE': '20210801'}
2021-08-14 13:51:35,896 -[line:96] - INFO: [{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'MAIN_WC': {'$in': ['1300', '1301', '1340', '1370', '1419', '1420', '1510', '1590', '1600']}, 'PROD_NBR': ['GZJ055IA0200S', 'GP062CCAC100S', 'GZD070SA4030S', 'GZD070SAB020S', 'GNJ101IA0030S', 'GZJ101ZA3010S', 'GP062CCAY010S', 'GN116BCNA030S', 'GN140HCNA0C0S', 'GN140HCNA0M0S', 'GN140HCNA0N0S', 'GN140HCNA0R0S', '2HE080IA1010S', '2P101DEZ0020S', 'GP080DZD00B0S', 'GP080DZD00C0S', 'GP101KZD0210S', 'GP104ZZD0220S', 'GP104ZZD0240S', 'GP130ZFZ1020S', 'GP130ZFA0010S', 'GP140ZKA0020S']}}, {'$lookup': {'from': 'deftCodeView', 'as': 'deftCodeList', 'let': {'dfctCode': '$DFCT_CODE'}, 'pipeline': [{'$match': {'$expr': {'$and': [{'$eq': ['$$dfctCode', '$DEFECT_CODE']}]}}}, {'$project': {'DEFECT_CODE': 1}}]}}, {'$unwind': '$deftCodeList'}, {'$group': {'_id': {'PROD_NBR': '$PROD_NBR'}, 'deftQty': {'$sum': {'$toInt': '$QTY'}}}}, {'$addFields': {'PROD_NBR': '$_id.PROD_NBR', 'deftQty': '$deftQty', 'passQty': 0}}, {'$project': {'_id': 0}}, {'$unionWith': {'coll': 'passHisAndCurrent', 'pipeline': [{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'MAIN_WC': {'$in': ['1300', '1301', '1340', '1370', '1419', '1420', '1510', '1590', '1600']}, 'PROD_NBR': {'$in': ['GZJ055IA0200S', 'GP062CCAC100S', 'GZD070SA4030S', 'GZD070SAB020S', 'GNJ101IA0030S', 'GZJ101ZA3010S', 'GP062CCAY010S', 'GN116BCNA030S', 'GN140HCNA0C0S', 'GN140HCNA0M0S', 'GN140HCNA0N0S', 'GN140HCNA0R0S', '2HE080IA1010S', '2P101DEZ0020S', 'GP080DZD00B0S', 'GP080DZD00C0S', 'GP101KZD0210S', 'GP104ZZD0220S', 'GP104ZZD0240S', 'GP130ZFZ1020S', 'GP130ZFA0010S', 'GP140ZKA0020S']}}}, {'$group': {'_id': {'PROD_NBR': '$PROD_NBR'}, 'passQty': {'$sum': {'$toInt': '$QTY'}}}}, {'$addFields': {'PROD_NBR': '$_id.PROD_NBR', 'passQty': '$passQty', 'deftQty': 0}}, {'$project': {'_id': 0}}]}}, {'$group': {'_id': {'PROD_NBR': '$PROD_NBR'}, 'deftQty': {'$sum': '$deftQty'}, 'passQty': {'$sum': '$passQty'}}}, {'$addFields': {'prodNbr': '$_id.PROD_NBR', 'prodNbrDfctYield': {'$cond': [{'$eq': ['$passQty', 0]}, 0, {'divide': ['$deftQty', '$passQty']}]}}}, {'$sort': {'prodNbr': 1}}, {'$project': {'_id': 0}}]
2021-08-14 13:54:14,930 -[line:96] - INFO: INTKPI __init__
2021-08-14 13:54:14,931 -[line:96] - INFO: INTKPI getData Start
2021-08-14 13:54:14,931 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'APPLICATION': 'ALL', 'KPITYPE': 'EFA', 'ACCT_DATE': '20210801'}
2021-08-14 13:54:15,509 -[line:96] - INFO: [{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'MAIN_WC': {'$in': ['1300', '1301', '1340', '1370', '1419', '1420', '1510', '1590', '1600']}, 'PROD_NBR': {'$in': ['GZJ055IA0200S', 'GP062CCAC100S', 'GZD070SA4030S', 'GZD070SAB020S', 'GNJ101IA0030S', 'GZJ101ZA3010S', 'GP062CCAY010S', 'GN116BCNA030S', 'GN140HCNA0C0S', 'GN140HCNA0M0S', 'GN140HCNA0N0S', 'GN140HCNA0R0S', '2HE080IA1010S', '2P101DEZ0020S', 'GP080DZD00B0S', 'GP080DZD00C0S', 'GP101KZD0210S', 'GP104ZZD0220S', 'GP104ZZD0240S', 'GP130ZFZ1020S', 'GP130ZFA0010S', 'GP140ZKA0020S']}}}, {'$lookup': {'from': 'deftCodeView', 'as': 'deftCodeList', 'let': {'dfctCode': '$DFCT_CODE'}, 'pipeline': [{'$match': {'$expr': {'$and': [{'$eq': ['$$dfctCode', '$DEFECT_CODE']}]}}}, {'$project': {'DEFECT_CODE': 1}}]}}, {'$unwind': '$deftCodeList'}, {'$group': {'_id': {'PROD_NBR': '$PROD_NBR'}, 'deftQty': {'$sum': {'$toInt': '$QTY'}}}}, {'$addFields': {'PROD_NBR': '$_id.PROD_NBR', 'deftQty': '$deftQty', 'passQty': 0}}, {'$project': {'_id': 0}}, {'$unionWith': {'coll': 'passHisAndCurrent', 'pipeline': [{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'MAIN_WC': {'$in': ['1300', '1301', '1340', '1370', '1419', '1420', '1510', '1590', '1600']}, 'PROD_NBR': {'$in': ['GZJ055IA0200S', 'GP062CCAC100S', 'GZD070SA4030S', 'GZD070SAB020S', 'GNJ101IA0030S', 'GZJ101ZA3010S', 'GP062CCAY010S', 'GN116BCNA030S', 'GN140HCNA0C0S', 'GN140HCNA0M0S', 'GN140HCNA0N0S', 'GN140HCNA0R0S', '2HE080IA1010S', '2P101DEZ0020S', 'GP080DZD00B0S', 'GP080DZD00C0S', 'GP101KZD0210S', 'GP104ZZD0220S', 'GP104ZZD0240S', 'GP130ZFZ1020S', 'GP130ZFA0010S', 'GP140ZKA0020S']}}}, {'$group': {'_id': {'PROD_NBR': '$PROD_NBR'}, 'passQty': {'$sum': {'$toInt': '$QTY'}}}}, {'$addFields': {'PROD_NBR': '$_id.PROD_NBR', 'passQty': '$passQty', 'deftQty': 0}}, {'$project': {'_id': 0}}]}}, {'$group': {'_id': {'PROD_NBR': '$PROD_NBR'}, 'deftQty': {'$sum': '$deftQty'}, 'passQty': {'$sum': '$passQty'}}}, {'$addFields': {'prodNbr': '$_id.PROD_NBR', 'prodNbrDfctYield': {'$cond': [{'$eq': ['$passQty', 0]}, 0, {'divide': ['$deftQty', '$passQty']}]}}}, {'$sort': {'prodNbr': 1}}, {'$project': {'_id': 0}}]
2021-08-14 13:56:05,209 -[line:96] - INFO: INTKPI __init__
2021-08-14 13:56:05,209 -[line:96] - INFO: INTKPI getData Start
2021-08-14 13:56:05,210 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'APPLICATION': 'ALL', 'KPITYPE': 'EFA', 'ACCT_DATE': '20210801'}
2021-08-14 13:56:05,773 -[line:96] - INFO: [{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'MAIN_WC': {'$in': ['1300', '1301', '1340', '1370', '1419', '1420', '1510', '1590', '1600']}, 'PROD_NBR': {'$in': ['GZJ055IA0200S', 'GP062CCAC100S', 'GZD070SA4030S', 'GZD070SAB020S', 'GNJ101IA0030S', 'GZJ101ZA3010S', 'GP062CCAY010S', 'GN116BCNA030S', 'GN140HCNA0C0S', 'GN140HCNA0M0S', 'GN140HCNA0N0S', 'GN140HCNA0R0S', '2HE080IA1010S', '2P101DEZ0020S', 'GP080DZD00B0S', 'GP080DZD00C0S', 'GP101KZD0210S', 'GP104ZZD0220S', 'GP104ZZD0240S', 'GP130ZFZ1020S', 'GP130ZFA0010S', 'GP140ZKA0020S']}}}, {'$lookup': {'from': 'deftCodeView', 'as': 'deftCodeList', 'let': {'dfctCode': '$DFCT_CODE'}, 'pipeline': [{'$match': {'$expr': {'$and': [{'$eq': ['$$dfctCode', '$DEFECT_CODE']}]}}}, {'$project': {'DEFECT_CODE': 1}}]}}, {'$unwind': '$deftCodeList'}, {'$group': {'_id': {'PROD_NBR': '$PROD_NBR'}, 'deftQty': {'$sum': {'$toInt': '$QTY'}}}}, {'$addFields': {'PROD_NBR': '$_id.PROD_NBR', 'deftQty': '$deftQty', 'passQty': 0}}, {'$project': {'_id': 0}}, {'$unionWith': {'coll': 'passHisAndCurrent', 'pipeline': [{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'MAIN_WC': {'$in': ['1300', '1301', '1340', '1370', '1419', '1420', '1510', '1590', '1600']}, 'PROD_NBR': {'$in': ['GZJ055IA0200S', 'GP062CCAC100S', 'GZD070SA4030S', 'GZD070SAB020S', 'GNJ101IA0030S', 'GZJ101ZA3010S', 'GP062CCAY010S', 'GN116BCNA030S', 'GN140HCNA0C0S', 'GN140HCNA0M0S', 'GN140HCNA0N0S', 'GN140HCNA0R0S', '2HE080IA1010S', '2P101DEZ0020S', 'GP080DZD00B0S', 'GP080DZD00C0S', 'GP101KZD0210S', 'GP104ZZD0220S', 'GP104ZZD0240S', 'GP130ZFZ1020S', 'GP130ZFA0010S', 'GP140ZKA0020S']}}}, {'$group': {'_id': {'PROD_NBR': '$PROD_NBR'}, 'passQty': {'$sum': {'$toInt': '$QTY'}}}}, {'$addFields': {'PROD_NBR': '$_id.PROD_NBR', 'passQty': '$passQty', 'deftQty': 0}}, {'$project': {'_id': 0}}]}}, {'$group': {'_id': {'PROD_NBR': '$PROD_NBR'}, 'deftQty': {'$sum': '$deftQty'}, 'passQty': {'$sum': '$passQty'}}}, {'$addFields': {'prodNbr': '$_id.PROD_NBR', 'prodNbrDfctYield': {'$cond': [{'$eq': ['$passQty', 0]}, 0, {'$divide': ['$deftQty', '$passQty']}]}}}, {'$sort': {'prodNbr': 1}}, {'$project': {'_id': 0}}]
2021-08-14 14:01:39,114 -[line:96] - INFO: INTKPI __init__
2021-08-14 14:01:39,114 -[line:96] - INFO: INTKPI getData Start
2021-08-14 14:01:39,115 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'APPLICATION': 'ALL', 'KPITYPE': 'EFA', 'ACCT_DATE': '20210801'}
2021-08-14 14:01:39,725 -[line:96] - INFO: [{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'MAIN_WC': {'$in': ['1300', '1301', '1340', '1370', '1419', '1420', '1510', '1590', '1600']}, 'PROD_NBR': {'$in': ['GZJ055IA0200S', 'GP062CCAC100S', 'GZD070SA4030S', 'GZD070SAB020S', 'GNJ101IA0030S', 'GZJ101ZA3010S', 'GP062CCAY010S', 'GN116BCNA030S', 'GN140HCNA0C0S', 'GN140HCNA0M0S', 'GN140HCNA0N0S', 'GN140HCNA0R0S', '2HE080IA1010S', '2P101DEZ0020S', 'GP080DZD00B0S', 'GP080DZD00C0S', 'GP101KZD0210S', 'GP104ZZD0220S', 'GP104ZZD0240S', 'GP130ZFZ1020S', 'GP130ZFA0010S', 'GP140ZKA0020S']}}}, {'$lookup': {'from': 'deftCodeView', 'as': 'deftCodeList', 'let': {'dfctCode': '$DFCT_CODE'}, 'pipeline': [{'$match': {'$expr': {'$and': [{'$eq': ['$$dfctCode', '$DEFECT_CODE']}]}}}, {'$project': {'DEFECT_CODE': 1}}]}}, {'$unwind': '$deftCodeList'}, {'$group': {'_id': {'APPLICATION': '$APPLICATION', 'PROD_NBR': '$PROD_NBR'}, 'deftQty': {'$sum': {'$toInt': '$QTY'}}}}, {'$addFields': {'APPLICATION': '$_id.APPLICATION', 'PROD_NBR': '$_id.PROD_NBR', 'deftQty': '$deftQty', 'passQty': 0}}, {'$project': {'_id': 0}}, {'$unionWith': {'coll': 'passHisAndCurrent', 'pipeline': [{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'MAIN_WC': {'$in': ['1300', '1301', '1340', '1370', '1419', '1420', '1510', '1590', '1600']}, 'PROD_NBR': {'$in': ['GZJ055IA0200S', 'GP062CCAC100S', 'GZD070SA4030S', 'GZD070SAB020S', 'GNJ101IA0030S', 'GZJ101ZA3010S', 'GP062CCAY010S', 'GN116BCNA030S', 'GN140HCNA0C0S', 'GN140HCNA0M0S', 'GN140HCNA0N0S', 'GN140HCNA0R0S', '2HE080IA1010S', '2P101DEZ0020S', 'GP080DZD00B0S', 'GP080DZD00C0S', 'GP101KZD0210S', 'GP104ZZD0220S', 'GP104ZZD0240S', 'GP130ZFZ1020S', 'GP130ZFA0010S', 'GP140ZKA0020S']}}}, {'$group': {'_id': {'PROD_NBR': '$PROD_NBR'}, 'passQty': {'$sum': {'$toInt': '$QTY'}}}}, {'$addFields': {'PROD_NBR': '$_id.PROD_NBR', 'passQty': '$passQty', 'deftQty': 0}}, {'$project': {'_id': 0}}]}}, {'$group': {'_id': {'APPLICATION': '$APPLICATION', 'PROD_NBR': '$PROD_NBR'}, 'deftQty': {'$sum': '$deftQty'}, 'passQty': {'$sum': '$passQty'}}}, {'$addFields': {'APPLICATION': '$_id.APPLICATION', 'PROD_NBR': '$_id.PROD_NBR', 'EFA': {'$cond': [{'$eq': ['$passQty', 0]}, 0, {'$divide': ['$deftQty', '$passQty']}]}}}, {'$project': {'_id': 0}}, {'$sort': {'APPLICATION': 1, 'PROD_NBR': 1}}]
2021-08-14 14:01:39,728 -[line:99] - ERROR: File:[D:\Project\source\dataproviderapi\GetINTKPI.py] , Line:1455 , in _calEFAData : [TypeError] string indices must be integers
2021-08-14 14:03:01,093 -[line:96] - INFO: INTKPI __init__
2021-08-14 14:03:01,093 -[line:96] - INFO: INTKPI getData Start
2021-08-14 14:03:01,094 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'APPLICATION': 'ALL', 'KPITYPE': 'EFA', 'ACCT_DATE': '20210801'}
2021-08-14 14:03:01,659 -[line:96] - INFO: [{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'MAIN_WC': {'$in': ['1300', '1301', '1340', '1370', '1419', '1420', '1510', '1590', '1600']}, 'PROD_NBR': {'$in': ['GZJ055IA0200S', 'GP062CCAC100S', 'GZD070SA4030S', 'GZD070SAB020S', 'GNJ101IA0030S', 'GZJ101ZA3010S', 'GP062CCAY010S', 'GN116BCNA030S', 'GN140HCNA0C0S', 'GN140HCNA0M0S', 'GN140HCNA0N0S', 'GN140HCNA0R0S', '2HE080IA1010S', '2P101DEZ0020S', 'GP080DZD00B0S', 'GP080DZD00C0S', 'GP101KZD0210S', 'GP104ZZD0220S', 'GP104ZZD0240S', 'GP130ZFZ1020S', 'GP130ZFA0010S', 'GP140ZKA0020S']}}}, {'$lookup': {'from': 'deftCodeView', 'as': 'deftCodeList', 'let': {'dfctCode': '$DFCT_CODE'}, 'pipeline': [{'$match': {'$expr': {'$and': [{'$eq': ['$$dfctCode', '$DEFECT_CODE']}]}}}, {'$project': {'DEFECT_CODE': 1}}]}}, {'$unwind': '$deftCodeList'}, {'$group': {'_id': {'APPLICATION': '$APPLICATION', 'PROD_NBR': '$PROD_NBR'}, 'deftQty': {'$sum': {'$toInt': '$QTY'}}}}, {'$addFields': {'APPLICATION': '$_id.APPLICATION', 'PROD_NBR': '$_id.PROD_NBR', 'deftQty': '$deftQty', 'passQty': 0}}, {'$project': {'_id': 0}}, {'$unionWith': {'coll': 'passHisAndCurrent', 'pipeline': [{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'MAIN_WC': {'$in': ['1300', '1301', '1340', '1370', '1419', '1420', '1510', '1590', '1600']}, 'PROD_NBR': {'$in': ['GZJ055IA0200S', 'GP062CCAC100S', 'GZD070SA4030S', 'GZD070SAB020S', 'GNJ101IA0030S', 'GZJ101ZA3010S', 'GP062CCAY010S', 'GN116BCNA030S', 'GN140HCNA0C0S', 'GN140HCNA0M0S', 'GN140HCNA0N0S', 'GN140HCNA0R0S', '2HE080IA1010S', '2P101DEZ0020S', 'GP080DZD00B0S', 'GP080DZD00C0S', 'GP101KZD0210S', 'GP104ZZD0220S', 'GP104ZZD0240S', 'GP130ZFZ1020S', 'GP130ZFA0010S', 'GP140ZKA0020S']}}}, {'$group': {'_id': {'PROD_NBR': '$PROD_NBR'}, 'passQty': {'$sum': {'$toInt': '$QTY'}}}}, {'$addFields': {'PROD_NBR': '$_id.PROD_NBR', 'passQty': '$passQty', 'deftQty': 0}}, {'$project': {'_id': 0}}]}}, {'$group': {'_id': {'APPLICATION': '$APPLICATION', 'PROD_NBR': '$PROD_NBR'}, 'deftQty': {'$sum': '$deftQty'}, 'passQty': {'$sum': '$passQty'}}}, {'$addFields': {'APPLICATION': '$_id.APPLICATION', 'PROD_NBR': '$_id.PROD_NBR', 'EFA': {'$cond': [{'$eq': ['$passQty', 0]}, 0, {'$divide': ['$deftQty', '$passQty']}]}}}, {'$project': {'_id': 0}}, {'$sort': {'APPLICATION': 1, 'PROD_NBR': 1}}]
2021-08-14 14:03:01,661 -[line:96] - INFO: {'efaData': <pymongo.command_cursor.CommandCursor object at 0x0000027A24920D68>}
2021-08-14 14:03:01,661 -[line:96] - INFO: efaData
2021-08-14 14:03:01,662 -[line:99] - ERROR: File:[D:\Project\source\dataproviderapi\GetINTKPI.py] , Line:1457 , in _calEFAData : [TypeError] string indices must be integers
2021-08-14 14:06:27,398 -[line:96] - INFO: INTKPI __init__
2021-08-14 14:06:27,398 -[line:96] - INFO: INTKPI getData Start
2021-08-14 14:06:27,399 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'APPLICATION': 'ALL', 'KPITYPE': 'EFA', 'ACCT_DATE': '20210801'}
2021-08-14 14:06:27,980 -[line:96] - INFO: [{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'MAIN_WC': {'$in': ['1300', '1301', '1340', '1370', '1419', '1420', '1510', '1590', '1600']}, 'PROD_NBR': {'$in': ['GZJ055IA0200S', 'GP062CCAC100S', 'GZD070SA4030S', 'GZD070SAB020S', 'GNJ101IA0030S', 'GZJ101ZA3010S', 'GP062CCAY010S', 'GN116BCNA030S', 'GN140HCNA0C0S', 'GN140HCNA0M0S', 'GN140HCNA0N0S', 'GN140HCNA0R0S', '2HE080IA1010S', '2P101DEZ0020S', 'GP080DZD00B0S', 'GP080DZD00C0S', 'GP101KZD0210S', 'GP104ZZD0220S', 'GP104ZZD0240S', 'GP130ZFZ1020S', 'GP130ZFA0010S', 'GP140ZKA0020S']}}}, {'$lookup': {'from': 'deftCodeView', 'as': 'deftCodeList', 'let': {'dfctCode': '$DFCT_CODE'}, 'pipeline': [{'$match': {'$expr': {'$and': [{'$eq': ['$$dfctCode', '$DEFECT_CODE']}]}}}, {'$project': {'DEFECT_CODE': 1}}]}}, {'$unwind': '$deftCodeList'}, {'$group': {'_id': {'APPLICATION': '$APPLICATION', 'PROD_NBR': '$PROD_NBR'}, 'deftQty': {'$sum': {'$toInt': '$QTY'}}}}, {'$addFields': {'APPLICATION': '$_id.APPLICATION', 'PROD_NBR': '$_id.PROD_NBR', 'deftQty': '$deftQty', 'passQty': 0}}, {'$project': {'_id': 0}}, {'$unionWith': {'coll': 'passHisAndCurrent', 'pipeline': [{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210801', 'MAIN_WC': {'$in': ['1300', '1301', '1340', '1370', '1419', '1420', '1510', '1590', '1600']}, 'PROD_NBR': {'$in': ['GZJ055IA0200S', 'GP062CCAC100S', 'GZD070SA4030S', 'GZD070SAB020S', 'GNJ101IA0030S', 'GZJ101ZA3010S', 'GP062CCAY010S', 'GN116BCNA030S', 'GN140HCNA0C0S', 'GN140HCNA0M0S', 'GN140HCNA0N0S', 'GN140HCNA0R0S', '2HE080IA1010S', '2P101DEZ0020S', 'GP080DZD00B0S', 'GP080DZD00C0S', 'GP101KZD0210S', 'GP104ZZD0220S', 'GP104ZZD0240S', 'GP130ZFZ1020S', 'GP130ZFA0010S', 'GP140ZKA0020S']}}}, {'$group': {'_id': {'PROD_NBR': '$PROD_NBR'}, 'passQty': {'$sum': {'$toInt': '$QTY'}}}}, {'$addFields': {'PROD_NBR': '$_id.PROD_NBR', 'passQty': '$passQty', 'deftQty': 0}}, {'$project': {'_id': 0}}]}}, {'$group': {'_id': {'APPLICATION': '$APPLICATION', 'PROD_NBR': '$PROD_NBR'}, 'deftQty': {'$sum': '$deftQty'}, 'passQty': {'$sum': '$passQty'}}}, {'$addFields': {'APPLICATION': '$_id.APPLICATION', 'PROD_NBR': '$_id.PROD_NBR', 'EFA': {'$cond': [{'$eq': ['$passQty', 0]}, 0, {'$divide': ['$deftQty', '$passQty']}]}}}, {'$project': {'_id': 0}}, {'$sort': {'APPLICATION': 1, 'PROD_NBR': 1}}]
2021-08-14 14:06:27,983 -[line:99] - ERROR: File:[D:\Project\source\dataproviderapi\GetINTKPI.py] , Line:1448 , in _groupEFAData : [TypeError] list indices must be integers or slices, not str
2021-08-14 14:07:21,571 -[line:96] - INFO: INTKPI __init__
2021-08-14 14:07:21,571 -[line:96] - INFO: INTKPI getData Start
2021-08-14 14:07:21,572 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'APPLICATION': 'ALL', 'KPITYPE': 'EFA', 'ACCT_DATE': '20210801'}
2021-08-14 14:07:22,149 -[line:99] - ERROR: File:[D:\Project\source\dataproviderapi\GetINTKPI.py] , Line:1438 , in _groupEFAData : [TypeError] list indices must be integers or slices, not str
2021-08-14 14:07:54,197 -[line:96] - INFO: INTKPI __init__
2021-08-14 14:07:54,197 -[line:96] - INFO: INTKPI getData Start
2021-08-14 14:07:54,198 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'APPLICATION': 'ALL', 'KPITYPE': 'EFA', 'ACCT_DATE': '20210801'}
2021-08-14 14:07:54,791 -[line:96] - INFO: [{'deftQty': 0, 'passQty': 3, 'PROD_NBR': '2HE080IA1010S', 'EFA': 0.0}, {'deftQty': 0, 'passQty': 33, 'PROD_NBR': 'GNJ101IA0030S', 'EFA': 0.0}, {'deftQty': 0, 'passQty': 82328, 'PROD_NBR': 'GP062CCAC100S', 'EFA': 0.0}, {'deftQty': 0, 'passQty': 7877, 'PROD_NBR': 'GP062CCAY010S', 'EFA': 0.0}, {'deftQty': 0, 'passQty': 12539, 'PROD_NBR': 'GP080DZD00B0S', 'EFA': 0.0}, {'deftQty': 0, 'passQty': 270, 'PROD_NBR': 'GP080DZD00C0S', 'EFA': 0.0}, {'deftQty': 0, 'passQty': 46, 'PROD_NBR': 'GP104ZZD0220S', 'EFA': 0.0}, {'deftQty': 0, 'passQty': 145, 'PROD_NBR': 'GP104ZZD0240S', 'EFA': 0.0}, {'deftQty': 0, 'passQty': 4602, 'PROD_NBR': 'GP130ZFA0010S', 'EFA': 0.0}, {'deftQty': 0, 'passQty': 244, 'PROD_NBR': 'GP130ZFZ1020S', 'EFA': 0.0}, {'deftQty': 0, 'passQty': 1, 'PROD_NBR': 'GP140ZKA0020S', 'EFA': 0.0}, {'deftQty': 0, 'passQty': 9087, 'PROD_NBR': 'GZD070SA4030S', 'EFA': 0.0}, {'deftQty': 0, 'passQty': 2, 'PROD_NBR': 'GZJ101ZA3010S', 'EFA': 0.0}, {'deftQty': 2, 'passQty': 0, 'APPLICATION': 'CE', 'PROD_NBR': 'GNJ101IA0030S', 'EFA': 0}, {'deftQty': 1400, 'passQty': 0, 'APPLICATION': 'CE', 'PROD_NBR': 'GP062CCAC100S', 'EFA': 0}, {'deftQty': 102, 'passQty': 0, 'APPLICATION': 'CE', 'PROD_NBR': 'GP062CCAY010S', 'EFA': 0}, {'deftQty': 40, 'passQty': 0, 'APPLICATION': 'CE', 'PROD_NBR': 'GZD070SA4030S', 'EFA': 0}, {'deftQty': 4, 'passQty': 0, 'APPLICATION': 'CE', 'PROD_NBR': 'GZJ101ZA3010S', 'EFA': 0}, {'deftQty': 12, 'passQty': 0, 'APPLICATION': 'TABLET', 'PROD_NBR': '2HE080IA1010S', 'EFA': 0}, {'deftQty': 168, 'passQty': 0, 'APPLICATION': 'TABLET', 'PROD_NBR': 'GP080DZD00B0S', 'EFA': 0}, {'deftQty': 4, 'passQty': 0, 'APPLICATION': 'TABLET', 'PROD_NBR': 'GP080DZD00C0S', 'EFA': 0}, {'deftQty': 2, 'passQty': 0, 'APPLICATION': 'TABLET', 'PROD_NBR': 'GP104ZZD0240S', 'EFA': 0}, {'deftQty': 70, 'passQty': 0, 'APPLICATION': 'TABLET', 'PROD_NBR': 'GP130ZFA0010S', 'EFA': 0}, {'deftQty': 12, 'passQty': 0, 'APPLICATION': 'TABLET', 'PROD_NBR': 'GP130ZFZ1020S', 'EFA': 0}]
2021-08-14 14:07:54,797 -[line:96] - INFO: {'deftQty': 0, 'passQty': 3, 'PROD_NBR': '2HE080IA1010S', 'EFA': 0.0}
2021-08-14 14:07:54,797 -[line:99] - ERROR: File:[D:\Project\source\dataproviderapi\GetINTKPI.py] , Line:1454 , in _calEFAData : [KeyError] APPLICATION
2021-08-14 14:10:41,068 -[line:96] - INFO: INTKPI __init__
2021-08-14 14:10:41,069 -[line:96] - INFO: INTKPI getData Start
2021-08-14 14:10:41,069 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'APPLICATION': 'ALL', 'KPITYPE': 'EFA', 'ACCT_DATE': '20210801'}
2021-08-14 14:10:41,644 -[line:96] - INFO: [{'deftQty': 2, 'passQty': 33, 'APPLICATION': 'CE', 'PROD_NBR': 'GNJ101IA0030S', 'EFA': 0.06060606060606061}, {'deftQty': 1400, 'passQty': 82328, 'APPLICATION': 'CE', 'PROD_NBR': 'GP062CCAC100S', 'EFA': 0.017005150131182586}, {'deftQty': 102, 'passQty': 7877, 'APPLICATION': 'CE', 'PROD_NBR': 'GP062CCAY010S', 'EFA': 0.012949092294020565}, {'deftQty': 40, 'passQty': 9087, 'APPLICATION': 'CE', 'PROD_NBR': 'GZD070SA4030S', 'EFA': 0.004401892813909981}, {'deftQty': 4, 'passQty': 2, 'APPLICATION': 'CE', 'PROD_NBR': 'GZJ101ZA3010S', 'EFA': 2.0}, {'deftQty': 12, 'passQty': 3, 'APPLICATION': 'TABLET', 'PROD_NBR': '2HE080IA1010S', 'EFA': 4.0}, {'deftQty': 168, 'passQty': 12539, 'APPLICATION': 'TABLET', 'PROD_NBR': 'GP080DZD00B0S', 'EFA': 0.013398197623414945}, {'deftQty': 4, 'passQty': 270, 'APPLICATION': 'TABLET', 'PROD_NBR': 'GP080DZD00C0S', 'EFA': 0.014814814814814815}, {'deftQty': 0, 'passQty': 46, 'APPLICATION': 'TABLET', 'PROD_NBR': 'GP104ZZD0220S', 'EFA': 0.0}, {'deftQty': 2, 'passQty': 145, 'APPLICATION': 'TABLET', 'PROD_NBR': 'GP104ZZD0240S', 'EFA': 0.013793103448275862}, {'deftQty': 70, 'passQty': 4602, 'APPLICATION': 'TABLET', 'PROD_NBR': 'GP130ZFA0010S', 'EFA': 0.015210777922642329}, {'deftQty': 12, 'passQty': 244, 'APPLICATION': 'TABLET', 'PROD_NBR': 'GP130ZFZ1020S', 'EFA': 0.04918032786885246}, {'deftQty': 0, 'passQty': 1, 'APPLICATION': 'TABLET', 'PROD_NBR': 'GP140ZKA0020S', 'EFA': 0.0}]
2021-08-14 14:10:41,646 -[line:96] - INFO: {'deftQty': 2, 'passQty': 33, 'APPLICATION': 'CE', 'PROD_NBR': 'GNJ101IA0030S', 'EFA': 0.06060606060606061}
2021-08-14 14:10:41,646 -[line:96] - INFO: {'deftQty': 1400, 'passQty': 82328, 'APPLICATION': 'CE', 'PROD_NBR': 'GP062CCAC100S', 'EFA': 0.017005150131182586}
2021-08-14 14:10:41,647 -[line:96] - INFO: {'deftQty': 102, 'passQty': 7877, 'APPLICATION': 'CE', 'PROD_NBR': 'GP062CCAY010S', 'EFA': 0.012949092294020565}
2021-08-14 14:10:41,647 -[line:96] - INFO: {'deftQty': 40, 'passQty': 9087, 'APPLICATION': 'CE', 'PROD_NBR': 'GZD070SA4030S', 'EFA': 0.004401892813909981}
2021-08-14 14:10:41,648 -[line:96] - INFO: {'deftQty': 4, 'passQty': 2, 'APPLICATION': 'CE', 'PROD_NBR': 'GZJ101ZA3010S', 'EFA': 2.0}
2021-08-14 14:10:41,648 -[line:96] - INFO: {'deftQty': 12, 'passQty': 3, 'APPLICATION': 'TABLET', 'PROD_NBR': '2HE080IA1010S', 'EFA': 4.0}
2021-08-14 14:10:41,648 -[line:96] - INFO: {'deftQty': 168, 'passQty': 12539, 'APPLICATION': 'TABLET', 'PROD_NBR': 'GP080DZD00B0S', 'EFA': 0.013398197623414945}
2021-08-14 14:10:41,649 -[line:96] - INFO: {'deftQty': 4, 'passQty': 270, 'APPLICATION': 'TABLET', 'PROD_NBR': 'GP080DZD00C0S', 'EFA': 0.014814814814814815}
2021-08-14 14:10:41,649 -[line:96] - INFO: {'deftQty': 0, 'passQty': 46, 'APPLICATION': 'TABLET', 'PROD_NBR': 'GP104ZZD0220S', 'EFA': 0.0}
2021-08-14 14:10:41,649 -[line:96] - INFO: {'deftQty': 2, 'passQty': 145, 'APPLICATION': 'TABLET', 'PROD_NBR': 'GP104ZZD0240S', 'EFA': 0.013793103448275862}
2021-08-14 14:10:41,649 -[line:96] - INFO: {'deftQty': 70, 'passQty': 4602, 'APPLICATION': 'TABLET', 'PROD_NBR': 'GP130ZFA0010S', 'EFA': 0.015210777922642329}
2021-08-14 14:10:41,650 -[line:96] - INFO: {'deftQty': 12, 'passQty': 244, 'APPLICATION': 'TABLET', 'PROD_NBR': 'GP130ZFZ1020S', 'EFA': 0.04918032786885246}
2021-08-14 14:10:41,650 -[line:96] - INFO: {'deftQty': 0, 'passQty': 1, 'APPLICATION': 'TABLET', 'PROD_NBR': 'GP140ZKA0020S', 'EFA': 0.0}
2021-08-14 14:10:52,407 -[line:96] - INFO: INTKPI __init__
2021-08-14 14:10:52,407 -[line:96] - INFO: INTKPI getData Start
2021-08-14 14:10:52,408 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'APPLICATION': 'CE', 'KPITYPE': 'EFA', 'ACCT_DATE': '20210801'}
2021-08-14 14:10:52,967 -[line:96] - INFO: [{'deftQty': 2, 'passQty': 33, 'APPLICATION': 'CE', 'PROD_NBR': 'GNJ101IA0030S', 'EFA': 0.06060606060606061}, {'deftQty': 1400, 'passQty': 82328, 'APPLICATION': 'CE', 'PROD_NBR': 'GP062CCAC100S', 'EFA': 0.017005150131182586}, {'deftQty': 102, 'passQty': 7877, 'APPLICATION': 'CE', 'PROD_NBR': 'GP062CCAY010S', 'EFA': 0.012949092294020565}, {'deftQty': 40, 'passQty': 9087, 'APPLICATION': 'CE', 'PROD_NBR': 'GZD070SA4030S', 'EFA': 0.004401892813909981}, {'deftQty': 4, 'passQty': 2, 'APPLICATION': 'CE', 'PROD_NBR': 'GZJ101ZA3010S', 'EFA': 2.0}]
2021-08-14 14:10:52,968 -[line:96] - INFO: {'deftQty': 2, 'passQty': 33, 'APPLICATION': 'CE', 'PROD_NBR': 'GNJ101IA0030S', 'EFA': 0.06060606060606061}
2021-08-14 14:10:52,968 -[line:96] - INFO: {'deftQty': 1400, 'passQty': 82328, 'APPLICATION': 'CE', 'PROD_NBR': 'GP062CCAC100S', 'EFA': 0.017005150131182586}
2021-08-14 14:10:52,969 -[line:96] - INFO: {'deftQty': 102, 'passQty': 7877, 'APPLICATION': 'CE', 'PROD_NBR': 'GP062CCAY010S', 'EFA': 0.012949092294020565}
2021-08-14 14:10:52,969 -[line:96] - INFO: {'deftQty': 40, 'passQty': 9087, 'APPLICATION': 'CE', 'PROD_NBR': 'GZD070SA4030S', 'EFA': 0.004401892813909981}
2021-08-14 14:10:52,970 -[line:96] - INFO: {'deftQty': 4, 'passQty': 2, 'APPLICATION': 'CE', 'PROD_NBR': 'GZJ101ZA3010S', 'EFA': 2.0}
2021-08-14 14:11:18,122 -[line:96] - INFO: INTKPI __init__
2021-08-14 14:11:18,122 -[line:96] - INFO: INTKPI getData Start
2021-08-14 14:11:18,123 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'APPLICATION': 'CE', 'KPITYPE': 'EFA', 'ACCT_DATE': '20210811'}
2021-08-14 14:11:18,719 -[line:96] - INFO: [{'deftQty': 840, 'passQty': 101224, 'APPLICATION': 'CE', 'PROD_NBR': 'GP062CCAC100S', 'EFA': 0.008298427250454437}, {'deftQty': 2, 'passQty': 3, 'APPLICATION': 'CE', 'PROD_NBR': 'GP062CCAY010S', 'EFA': 0.6666666666666666}, {'deftQty': 20, 'passQty': 1298, 'APPLICATION': 'CE', 'PROD_NBR': 'GZD070SA4030S', 'EFA': 0.015408320493066256}, {'deftQty': 0, 'passQty': 287, 'APPLICATION': 'CE', 'PROD_NBR': 'GZD070SAB020S', 'EFA': 0.0}, {'deftQty': 230, 'passQty': 46654, 'APPLICATION': 'CE', 'PROD_NBR': 'GZJ055IA0200S', 'EFA': 0.0049299095468770095}, {'deftQty': 0, 'passQty': 21, 'APPLICATION': 'CE', 'PROD_NBR': 'GZJ101ZA3010S', 'EFA': 0.0}]
2021-08-14 14:11:18,720 -[line:96] - INFO: {'deftQty': 840, 'passQty': 101224, 'APPLICATION': 'CE', 'PROD_NBR': 'GP062CCAC100S', 'EFA': 0.008298427250454437}
2021-08-14 14:11:18,720 -[line:96] - INFO: {'deftQty': 2, 'passQty': 3, 'APPLICATION': 'CE', 'PROD_NBR': 'GP062CCAY010S', 'EFA': 0.6666666666666666}
2021-08-14 14:11:18,721 -[line:96] - INFO: {'deftQty': 20, 'passQty': 1298, 'APPLICATION': 'CE', 'PROD_NBR': 'GZD070SA4030S', 'EFA': 0.015408320493066256}
2021-08-14 14:11:18,721 -[line:96] - INFO: {'deftQty': 0, 'passQty': 287, 'APPLICATION': 'CE', 'PROD_NBR': 'GZD070SAB020S', 'EFA': 0.0}
2021-08-14 14:11:18,721 -[line:96] - INFO: {'deftQty': 230, 'passQty': 46654, 'APPLICATION': 'CE', 'PROD_NBR': 'GZJ055IA0200S', 'EFA': 0.0049299095468770095}
2021-08-14 14:11:18,722 -[line:96] - INFO: {'deftQty': 0, 'passQty': 21, 'APPLICATION': 'CE', 'PROD_NBR': 'GZJ101ZA3010S', 'EFA': 0.0}
2021-08-14 14:29:26,503 -[line:96] - INFO: INTKPI __init__
2021-08-14 14:29:26,504 -[line:96] - INFO: INTKPI getData Start
2021-08-14 14:29:26,504 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'APPLICATION': 'CE', 'KPITYPE': 'EFA', 'ACCT_DATE': '20210811'}
2021-08-14 14:29:26,510 -[line:96] - INFO: [{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210811', 'MAIN_WC': {'$in': ['1300', '1301', '1340', '1370', '1419', '1420', '1510', '1590', '1600']}, 'PROD_NBR': {'$in': ['GZJ055IA0200S', 'GP062CCAC100S', 'GZD070SA4030S', 'GZD070SAB020S', 'GNJ101IA0030S', 'GZJ101ZA3010S', 'GP062CCAY010S', 'GN116BCNA030S', 'GN140HCNA0C0S', 'GN140HCNA0M0S', 'GN140HCNA0N0S', 'GN140HCNA0R0S', '2HE080IA1010S', '2P101DEZ0020S', 'GP080DZD00B0S', 'GP080DZD00C0S', 'GP101KZD0210S', 'GP104ZZD0220S', 'GP104ZZD0240S', 'GP130ZFZ1020S', 'GP130ZFA0010S', 'GP140ZKA0020S']}, 'APPLICATION': 'CE'}}, {'$lookup': {'from': 'deftCodeView', 'as': 'deftCodeList', 'let': {'dfctCode': '$DFCT_CODE'}, 'pipeline': [{'$match': {'$expr': {'$and': [{'$eq': ['$$dfctCode', '$DEFECT_CODE']}]}}}, {'$project': {'DEFECT_CODE': 1}}]}}, {'$unwind': '$deftCodeList'}, {'$group': {'_id': {'APPLICATION': '$APPLICATION', 'PROD_NBR': '$PROD_NBR'}, 'deftQty': {'$sum': {'$toInt': '$QTY'}}}}, {'$addFields': {'APPLICATION': '$_id.APPLICATION', 'PROD_NBR': '$_id.PROD_NBR', 'deftQty': '$deftQty', 'passQty': 0}}, {'$project': {'_id': 0}}, {'$unionWith': {'coll': 'passHisAndCurrent', 'pipeline': [{'$match': {'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'ACCT_DATE': '20210811', 'MAIN_WC': {'$in': ['1300', '1301', '1340', '1370', '1419', '1420', '1510', '1590', '1600']}, 'PROD_NBR': {'$in': ['GZJ055IA0200S', 'GP062CCAC100S', 'GZD070SA4030S', 'GZD070SAB020S', 'GNJ101IA0030S', 'GZJ101ZA3010S', 'GP062CCAY010S', 'GN116BCNA030S', 'GN140HCNA0C0S', 'GN140HCNA0M0S', 'GN140HCNA0N0S', 'GN140HCNA0R0S', '2HE080IA1010S', '2P101DEZ0020S', 'GP080DZD00B0S', 'GP080DZD00C0S', 'GP101KZD0210S', 'GP104ZZD0220S', 'GP104ZZD0240S', 'GP130ZFZ1020S', 'GP130ZFA0010S', 'GP140ZKA0020S']}, 'APPLICATION': 'CE'}}, {'$group': {'_id': {'APPLICATION': '$APPLICATION', 'PROD_NBR': '$PROD_NBR'}, 'passQty': {'$sum': {'$toInt': '$QTY'}}}}, {'$addFields': {'APPLICATION': '$_id.APPLICATION', 'PROD_NBR': '$_id.PROD_NBR', 'passQty': '$passQty', 'deftQty': 0}}, {'$project': {'_id': 0}}]}}, {'$group': {'_id': {'APPLICATION': '$APPLICATION', 'PROD_NBR': '$PROD_NBR'}, 'deftQty': {'$sum': '$deftQty'}, 'passQty': {'$sum': '$passQty'}}}, {'$addFields': {'APPLICATION': '$_id.APPLICATION', 'PROD_NBR': '$_id.PROD_NBR', 'EFA': {'$cond': [{'$eq': ['$passQty', 0]}, 0, {'$divide': ['$deftQty', '$passQty']}]}}}, {'$project': {'_id': 0}}, {'$sort': {'APPLICATION': 1, 'PROD_NBR': 1}}]
2021-08-14 14:29:27,053 -[line:96] - INFO: [{'deftQty': 840, 'passQty': 101224, 'APPLICATION': 'CE', 'PROD_NBR': 'GP062CCAC100S', 'EFA': 0.008298427250454437}, {'deftQty': 2, 'passQty': 3, 'APPLICATION': 'CE', 'PROD_NBR': 'GP062CCAY010S', 'EFA': 0.6666666666666666}, {'deftQty': 20, 'passQty': 1298, 'APPLICATION': 'CE', 'PROD_NBR': 'GZD070SA4030S', 'EFA': 0.015408320493066256}, {'deftQty': 0, 'passQty': 287, 'APPLICATION': 'CE', 'PROD_NBR': 'GZD070SAB020S', 'EFA': 0.0}, {'deftQty': 230, 'passQty': 46654, 'APPLICATION': 'CE', 'PROD_NBR': 'GZJ055IA0200S', 'EFA': 0.0049299095468770095}, {'deftQty': 0, 'passQty': 21, 'APPLICATION': 'CE', 'PROD_NBR': 'GZJ101ZA3010S', 'EFA': 0.0}]
2021-08-14 14:29:27,055 -[line:96] - INFO: {'deftQty': 840, 'passQty': 101224, 'APPLICATION': 'CE', 'PROD_NBR': 'GP062CCAC100S', 'EFA': 0.008298427250454437}
2021-08-14 14:29:27,055 -[line:96] - INFO: {'deftQty': 2, 'passQty': 3, 'APPLICATION': 'CE', 'PROD_NBR': 'GP062CCAY010S', 'EFA': 0.6666666666666666}
2021-08-14 14:29:27,056 -[line:96] - INFO: {'deftQty': 20, 'passQty': 1298, 'APPLICATION': 'CE', 'PROD_NBR': 'GZD070SA4030S', 'EFA': 0.015408320493066256}
2021-08-14 14:29:27,056 -[line:96] - INFO: {'deftQty': 0, 'passQty': 287, 'APPLICATION': 'CE', 'PROD_NBR': 'GZD070SAB020S', 'EFA': 0.0}
2021-08-14 14:29:27,056 -[line:96] - INFO: {'deftQty': 230, 'passQty': 46654, 'APPLICATION': 'CE', 'PROD_NBR': 'GZJ055IA0200S', 'EFA': 0.0049299095468770095}
2021-08-14 14:29:27,057 -[line:96] - INFO: {'deftQty': 0, 'passQty': 21, 'APPLICATION': 'CE', 'PROD_NBR': 'GZJ101ZA3010S', 'EFA': 0.0}
2021-08-14 15:03:57,105 -[line:96] - INFO: INTKPI __init__
2021-08-14 15:03:57,106 -[line:96] - INFO: INTKPI getData Start
2021-08-14 15:03:57,106 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'APPLICATION': 'CE', 'KPITYPE': 'FPYLV2PIE', 'ACCT_DATE': '20210801', 'PROD_NBR': 'GP062CCAC100S'}
2021-08-14 15:04:28,828 -[line:96] - INFO: INTKPI __init__
2021-08-14 15:04:28,829 -[line:96] - INFO: INTKPI getData Start
2021-08-14 15:04:28,829 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'APPLICATION': 'CE', 'KPITYPE': 'FPYLV2PIE', 'ACCT_DATE': '20210801', 'PROD_NBR': 'GP062CCAC100S'}
2021-08-14 15:09:12,685 -[line:96] - INFO: INTKPI __init__
2021-08-14 15:09:12,686 -[line:96] - INFO: INTKPI getData Start
2021-08-14 15:09:12,686 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'APPLICATION': 'CE', 'KPITYPE': 'FPYLV2PIE', 'ACCT_DATE': '20210801', 'PROD_NBR': 'GP062CCAC100S'}
2021-08-14 15:11:53,754 -[line:96] - INFO: INTKPI __init__
2021-08-14 15:11:53,754 -[line:96] - INFO: INTKPI getData Start
2021-08-14 15:11:53,755 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'APPLICATION': 'CE', 'KPITYPE': 'FPYLV2PIE', 'ACCT_DATE': '20210801', 'PROD_NBR': 'GP062CCAC100S'}
2021-08-14 15:12:01,466 -[line:96] - INFO: INTKPI __init__
2021-08-14 15:12:01,467 -[line:96] - INFO: INTKPI getData Start
2021-08-14 15:12:01,467 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'APPLICATION': 'CE', 'KPITYPE': 'FPYLV2PIE', 'ACCT_DATE': '20210801'}
2021-08-14 15:12:01,468 -[line:99] - ERROR: File:[D:\Project\source\dataproviderapi\GetINTKPI.py] , Line:181 , in getData : [KeyError] PROD_NBR
2021-08-14 15:37:33,792 -[line:96] - INFO: INTKPI __init__
2021-08-14 15:37:33,793 -[line:96] - INFO: INTKPI getData Start
2021-08-14 15:37:33,793 -[line:96] - INFO: Input Json:{'COMPANY_CODE': 'INX', 'SITE': 'TN', 'FACTORY_ID': 'J001', 'APPLICATION': 'CE', 'KPITYPE': 'FPYLV2PIE', 'ACCT_DATE': '20210801'}
